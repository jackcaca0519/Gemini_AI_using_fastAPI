/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/vue-advanced-chat@2.1.0/dist/vue-advanced-chat.umd.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["vue-advanced-chat"]={})}(this,(function(e){"use strict";const t=()=>{},n=Object.assign,o=Object.prototype.hasOwnProperty,s=(e,t)=>o.call(e,t),a=Array.isArray,r=e=>"[object Map]"===u(e),i=e=>"symbol"==typeof e,l=e=>null!==e&&"object"==typeof e,c=Object.prototype.toString,u=e=>c.call(e),d=e=>u(e).slice(8,-1),m=e=>(e=>"string"==typeof e)(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,f=(e,t)=>!Object.is(e,t),p=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})};let h;class g{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&h&&(this.parent=h,this.index=(h.scopes||(h.scopes=[])).push(this)-1)}run(e){if(this.active){const t=h;try{return h=this,e()}finally{h=t}}}on(){h=this}off(){h=this.parent}stop(e){if(this.active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}const _=e=>{const t=new Set(e);return t.w=0,t.n=0,t},v=e=>(e.w&w)>0,b=e=>(e.n&w)>0,x=new WeakMap;let y=0,w=1;const k=30;let S;const M=Symbol(""),A=Symbol("");class R{constructor(e,t=null,n){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,function(e,t=h){t&&t.active&&t.effects.push(e)}(this,n)}run(){if(!this.active)return this.fn();let e=S,t=T;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=S,S=this,T=!0,w=1<<++y,y<=k?(({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=w})(this):E(this),this.fn()}finally{y<=k&&(e=>{const{deps:t}=e;if(t.length){let n=0;for(let o=0;o<t.length;o++){const s=t[o];v(s)&&!b(s)?s.delete(e):t[n++]=s,s.w&=~w,s.n&=~w}t.length=n}})(this),w=1<<--y,S=this.parent,T=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){S===this?this.deferStop=!0:this.active&&(E(this),this.onStop&&this.onStop(),this.active=!1)}}function E(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let T=!0;const B=[];function I(){B.push(T),T=!1}function C(){const e=B.pop();T=void 0===e||e}function j(e,t,n){if(T&&S){let t=x.get(e);t||x.set(e,t=new Map);let o=t.get(n);o||t.set(n,o=_()),O(o)}}function O(e,t){let n=!1;y<=k?b(e)||(e.n|=w,n=!v(e)):n=!e.has(S),n&&(e.add(S),S.deps.push(e))}function F(e,t,n,o,s,i){const l=x.get(e);if(!l)return;let c=[];if("clear"===t)c=[...l.values()];else if("length"===n&&a(e))l.forEach(((e,t)=>{("length"===t||t>=o)&&c.push(e)}));else switch(void 0!==n&&c.push(l.get(n)),t){case"add":a(e)?m(n)&&c.push(l.get("length")):(c.push(l.get(M)),r(e)&&c.push(l.get(A)));break;case"delete":a(e)||(c.push(l.get(M)),r(e)&&c.push(l.get(A)));break;case"set":r(e)&&c.push(l.get(M))}if(1===c.length)c[0]&&L(c[0]);else{const e=[];for(const t of c)t&&e.push(...t);L(_(e))}}function L(e,t){const n=a(e)?e:[...e];for(const e of n)e.computed&&P(e);for(const e of n)e.computed||P(e)}function P(e,t){(e!==S||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const D=function(e,t){const n=Object.create(null),o=e.split(",");for(let e=0;e<o.length;e++)n[o[e]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}("__proto__,__v_isRef,__isVue"),H=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(i)),N=q(),$=q(!1,!0),z=q(!0),V=function(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=Ee(this);for(let e=0,t=this.length;e<t;e++)j(n,0,e+"");const o=n[t](...e);return-1===o||!1===o?n[t](...e.map(Ee)):o}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){I();const n=Ee(this)[t].apply(this,e);return C(),n}})),e}();function q(e=!1,t=!1){return function(n,o,r){if("__v_isReactive"===o)return!e;if("__v_isReadonly"===o)return e;if("__v_isShallow"===o)return t;if("__v_raw"===o&&r===(e?t?xe:be:t?ve:_e).get(n))return n;const c=a(n);if(!e&&c&&s(V,o))return Reflect.get(V,o,r);const u=Reflect.get(n,o,r);return(i(o)?H.has(o):D(o))||(e||j(n,0,o),t)?u:Ce(u)?c&&m(o)?u:u.value:l(u)?e?we(u):ye(u):u}}const U=Y(),X=Y(!0);function Y(e=!1){return function(t,n,o,r){let i=t[n];if(Me(i)&&Ce(i)&&!Ce(o))return!1;if(!e&&!Me(o)&&(Ae(o)||(o=Ee(o),i=Ee(i)),!a(t)&&Ce(i)&&!Ce(o)))return i.value=o,!0;const l=a(t)&&m(n)?Number(n)<t.length:s(t,n),c=Reflect.set(t,n,o,r);return t===Ee(r)&&(l?f(o,i)&&F(t,"set",n,o):F(t,"add",n,o)),c}}const G={get:N,set:U,deleteProperty:function(e,t){const n=s(e,t);e[t];const o=Reflect.deleteProperty(e,t);return o&&n&&F(e,"delete",t,void 0),o},has:function(e,t){const n=Reflect.has(e,t);return(!i(t)||!H.has(t))&&j(e,0,t),n},ownKeys:function(e){return j(e,0,a(e)?"length":M),Reflect.ownKeys(e)}},K={get:z,set:(e,t)=>!0,deleteProperty:(e,t)=>!0},Z=n({},G,{get:$,set:X}),W=e=>e,Q=e=>Reflect.getPrototypeOf(e);function J(e,t,n=!1,o=!1){const s=Ee(e=e.__v_raw),a=Ee(t);n||(t!==a&&j(s,0,t),j(s,0,a));const{has:r}=Q(s),i=o?W:n?Ie:Be;return r.call(s,t)?i(e.get(t)):r.call(s,a)?i(e.get(a)):void(e!==s&&e.get(t))}function ee(e,t=!1){const n=this.__v_raw,o=Ee(n),s=Ee(e);return t||(e!==s&&j(o,0,e),j(o,0,s)),e===s?n.has(e):n.has(e)||n.has(s)}function te(e,t=!1){return e=e.__v_raw,!t&&j(Ee(e),0,M),Reflect.get(e,"size",e)}function ne(e){e=Ee(e);const t=Ee(this);return Q(t).has.call(t,e)||(t.add(e),F(t,"add",e,e)),this}function oe(e,t){t=Ee(t);const n=Ee(this),{has:o,get:s}=Q(n);let a=o.call(n,e);a||(e=Ee(e),a=o.call(n,e));const r=s.call(n,e);return n.set(e,t),a?f(t,r)&&F(n,"set",e,t):F(n,"add",e,t),this}function se(e){const t=Ee(this),{has:n,get:o}=Q(t);let s=n.call(t,e);s||(e=Ee(e),s=n.call(t,e)),o&&o.call(t,e);const a=t.delete(e);return s&&F(t,"delete",e,void 0),a}function ae(){const e=Ee(this),t=0!==e.size,n=e.clear();return t&&F(e,"clear",void 0,void 0),n}function re(e,t){return function(n,o){const s=this,a=s.__v_raw,r=Ee(a),i=t?W:e?Ie:Be;return!e&&j(r,0,M),a.forEach(((e,t)=>n.call(o,i(e),i(t),s)))}}function ie(e,t,n){return function(...o){const s=this.__v_raw,a=Ee(s),i=r(a),l="entries"===e||e===Symbol.iterator&&i,c="keys"===e&&i,u=s[e](...o),d=n?W:t?Ie:Be;return!t&&j(a,0,c?A:M),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:l?[d(e[0]),d(e[1])]:d(e),done:t}},[Symbol.iterator](){return this}}}}function le(e){return function(...t){return"delete"!==e&&this}}const[ce,ue,de,me]=function(){const e={get(e){return J(this,e)},get size(){return te(this)},has:ee,add:ne,set:oe,delete:se,clear:ae,forEach:re(!1,!1)},t={get(e){return J(this,e,!1,!0)},get size(){return te(this)},has:ee,add:ne,set:oe,delete:se,clear:ae,forEach:re(!1,!0)},n={get(e){return J(this,e,!0)},get size(){return te(this,!0)},has(e){return ee.call(this,e,!0)},add:le("add"),set:le("set"),delete:le("delete"),clear:le("clear"),forEach:re(!0,!1)},o={get(e){return J(this,e,!0,!0)},get size(){return te(this,!0)},has(e){return ee.call(this,e,!0)},add:le("add"),set:le("set"),delete:le("delete"),clear:le("clear"),forEach:re(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((s=>{e[s]=ie(s,!1,!1),n[s]=ie(s,!0,!1),t[s]=ie(s,!1,!0),o[s]=ie(s,!0,!0)})),[e,n,t,o]}();function fe(e,t){const n=t?e?me:de:e?ue:ce;return(t,o,a)=>"__v_isReactive"===o?!e:"__v_isReadonly"===o?e:"__v_raw"===o?t:Reflect.get(s(n,o)&&o in t?n:t,o,a)}const pe={get:fe(!1,!1)},he={get:fe(!1,!0)},ge={get:fe(!0,!1)},_e=new WeakMap,ve=new WeakMap,be=new WeakMap,xe=new WeakMap;function ye(e){return Me(e)?e:ke(e,!1,G,pe,_e)}function we(e){return ke(e,!0,K,ge,be)}function ke(e,t,n,o,s){if(!l(e)||e.__v_raw&&(!t||!e.__v_isReactive))return e;const a=s.get(e);if(a)return a;const r=function(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(d(e))}(e);if(0===r)return e;const i=new Proxy(e,2===r?o:n);return s.set(e,i),i}function Se(e){return Me(e)?Se(e.__v_raw):!(!e||!e.__v_isReactive)}function Me(e){return!(!e||!e.__v_isReadonly)}function Ae(e){return!(!e||!e.__v_isShallow)}function Re(e){return Se(e)||Me(e)}function Ee(e){const t=e&&e.__v_raw;return t?Ee(t):e}function Te(e){return p(e,"__v_skip",!0),e}const Be=e=>l(e)?ye(e):e,Ie=e=>l(e)?we(e):e;function Ce(e){return!(!e||!0!==e.__v_isRef)}const je={get:(e,t,n)=>function(e){return Ce(e)?e.value:e}(Reflect.get(e,t,n)),set:(e,t,n,o)=>{const s=e[t];return Ce(s)&&!Ce(n)?(s.value=n,!0):Reflect.set(e,t,n,o)}};function Oe(e){return Se(e)?e:new Proxy(e,je)}class Fe{constructor(e,t,n,o){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new R(e,(()=>{var e;this._dirty||(this._dirty=!0,(e=Ee(e=this)).dep&&L(e.dep))})),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=n}get value(){const e=Ee(this);return t=e,T&&S&&O((t=Ee(t)).dep||(t.dep=_())),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value;var t}set value(e){this._setter(e)}}function Le(e){if(tt(e)){const t={};for(let n=0;n<e.length;n++){const o=e[n],s=at(o)?He(o):Le(o);if(s)for(const e in s)t[e]=s[e]}return t}return at(e)||rt(e)?e:void 0}const Pe=/;(?![^(]*\))/g,De=/:(.+)/;function He(e){const t={};return e.split(Pe).forEach((e=>{if(e){const n=e.split(De);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function Ne(e){let t="";if(at(e))t=e;else if(tt(e))for(let n=0;n<e.length;n++){const o=Ne(e[n]);o&&(t+=o+" ")}else if(rt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function $e(e){if(!e)return null;let{class:t,style:n}=e;return t&&!at(t)&&(e.class=Ne(t)),n&&(e.style=Le(n)),e}const ze=e=>at(e)?e:null==e?"":tt(e)||rt(e)&&(e.toString===lt||!st(e.toString))?JSON.stringify(e,Ve,2):String(e),Ve=(e,t)=>t&&t.__v_isRef?Ve(e,t.value):nt(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n])=>(e[`${t} =>`]=n,e)),{})}:ot(t)?{[`Set(${t.size})`]:[...t.values()]}:!rt(t)||tt(t)||ut(t)?t:String(t),qe={},Ue=[],Xe=()=>{},Ye=()=>!1,Ge=/^on[^a-z]/,Ke=e=>Ge.test(e),Ze=e=>e.startsWith("onUpdate:"),We=Object.assign,Qe=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Je=Object.prototype.hasOwnProperty,et=(e,t)=>Je.call(e,t),tt=Array.isArray,nt=e=>"[object Map]"===ct(e),ot=e=>"[object Set]"===ct(e),st=e=>"function"==typeof e,at=e=>"string"==typeof e,rt=e=>null!==e&&"object"==typeof e,it=e=>rt(e)&&st(e.then)&&st(e.catch),lt=Object.prototype.toString,ct=e=>lt.call(e),ut=e=>"[object Object]"===ct(e),dt=function(e,t){const n=Object.create(null),o=e.split(",");for(let e=0;e<o.length;e++)n[o[e]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),mt=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},ft=/-(\w)/g,pt=mt((e=>e.replace(ft,((e,t)=>t?t.toUpperCase():"")))),ht=/\B([A-Z])/g,gt=mt((e=>e.replace(ht,"-$1").toLowerCase())),_t=mt((e=>e.charAt(0).toUpperCase()+e.slice(1))),vt=mt((e=>e?`on${_t(e)}`:"")),bt=(e,t)=>!Object.is(e,t),xt=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},yt=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},wt=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let kt;const St=()=>kt||(kt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});function Mt(e,t,n,o){let s;try{s=o?e(...o):e()}catch(e){Rt(e,t,n)}return s}function At(e,t,n,o){if(st(e)){const s=Mt(e,t,n,o);return s&&it(s)&&s.catch((e=>{Rt(e,t,n)})),s}const s=[];for(let a=0;a<e.length;a++)s.push(At(e[a],t,n,o));return s}function Rt(e,t,n,o=!0){t&&t.vnode;if(t){let o=t.parent;const s=t.proxy,a=n;for(;o;){const t=o.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,s,a))return;o=o.parent}const r=t.appContext.config.errorHandler;if(r)return void Mt(r,null,10,[e,s,a])}!function(e,t,n,o=!0){console.error(e)}(e,0,0,o)}let Et=!1,Tt=!1;const Bt=[];let It=0;const Ct=[];let jt=null,Ot=0;const Ft=[];let Lt=null,Pt=0;const Dt=Promise.resolve();let Ht=null,Nt=null;function $t(e){const t=Ht||Dt;return e?t.then(this?e.bind(this):e):t}function zt(e){(!Bt.length||!Bt.includes(e,Et&&e.allowRecurse?It+1:It))&&e!==Nt&&(null==e.id?Bt.push(e):Bt.splice(function(e){let t=It+1,n=Bt.length;for(;t<n;){const o=t+n>>>1;Yt(Bt[o])<e?t=o+1:n=o}return t}(e.id),0,e),Vt())}function Vt(){!Et&&!Tt&&(Tt=!0,Ht=Dt.then(Gt))}function qt(e,t,n,o){tt(e)?n.push(...e):(!t||!t.includes(e,e.allowRecurse?o+1:o))&&n.push(e),Vt()}function Ut(e,t=null){if(Ct.length){for(Nt=t,jt=[...new Set(Ct)],Ct.length=0,Ot=0;Ot<jt.length;Ot++)jt[Ot]();jt=null,Ot=0,Nt=null,Ut(e,t)}}function Xt(e){if(Ut(),Ft.length){const e=[...new Set(Ft)];if(Ft.length=0,Lt)return void Lt.push(...e);for(Lt=e,Lt.sort(((e,t)=>Yt(e)-Yt(t))),Pt=0;Pt<Lt.length;Pt++)Lt[Pt]();Lt=null,Pt=0}}const Yt=e=>null==e.id?1/0:e.id;function Gt(e){Tt=!1,Et=!0,Ut(e),Bt.sort(((e,t)=>Yt(e)-Yt(t)));try{for(It=0;It<Bt.length;It++){const e=Bt[It];e&&!1!==e.active&&Mt(e,null,14)}}finally{It=0,Bt.length=0,Xt(),Et=!1,Ht=null,(Bt.length||Ct.length||Ft.length)&&Gt(e)}}function Kt(e,t,...n){if(e.isUnmounted)return;const o=e.vnode.props||qe;let s=n;const a=t.startsWith("update:"),r=a&&t.slice(7);if(r&&r in o){const e=`${"modelValue"===r?"model":r}Modifiers`,{number:t,trim:a}=o[e]||qe;a&&(s=n.map((e=>e.trim()))),t&&(s=n.map(wt))}let i,l=o[i=vt(t)]||o[i=vt(pt(t))];!l&&a&&(l=o[i=vt(gt(t))]),l&&At(l,e,6,s);const c=o[i+"Once"];if(c){if(e.emitted){if(e.emitted[i])return}else e.emitted={};e.emitted[i]=!0,At(c,e,6,s)}}function Zt(e,t,n=!1){const o=t.emitsCache,s=o.get(e);if(void 0!==s)return s;const a=e.emits;let r={},i=!1;if(!st(e)){const o=e=>{const n=Zt(e,t,!0);n&&(i=!0,We(r,n))};!n&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return a||i?(tt(a)?a.forEach((e=>r[e]=null)):We(r,a),o.set(e,r),r):(o.set(e,null),null)}function Wt(e,t){return!(!e||!Ke(t))&&(t=t.slice(2).replace(/Once$/,""),et(e,t[0].toLowerCase()+t.slice(1))||et(e,gt(t))||et(e,t))}let Qt=null,Jt=null;function en(e){const t=Qt;return Qt=e,Jt=e&&e.type.__scopeId||null,t}function tn(e,t=Qt,n){if(!t||e._n)return e;const o=(...n)=>{o._d&&Yo(-1);const s=en(t),a=e(...n);return en(s),o._d&&Yo(1),a};return o._n=!0,o._c=!0,o._d=!0,o}function nn(e){const{type:t,vnode:n,proxy:o,withProxy:s,props:a,propsOptions:[r],slots:i,attrs:l,emit:c,render:u,renderCache:d,data:m,setupState:f,ctx:p,inheritAttrs:h}=e;let g,_;const v=en(e);try{if(4&n.shapeFlag){const e=s||o;g=ls(u.call(e,e,d,a,f,m,p)),_=l}else{const e=t;g=ls(e.length>1?e(a,{attrs:l,slots:i,emit:c}):e(a,null)),_=t.props?l:on(l)}}catch(t){Vo.length=0,Rt(t,e,1),g=os($o)}let b=g;if(_&&!1!==h){const e=Object.keys(_),{shapeFlag:t}=b;e.length&&7&t&&(r&&e.some(Ze)&&(_=sn(_,r)),b=as(b,_))}return n.dirs&&(b=as(b),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&(b.transition=n.transition),g=b,en(v),g}const on=e=>{let t;for(const n in e)("class"===n||"style"===n||Ke(n))&&((t||(t={}))[n]=e[n]);return t},sn=(e,t)=>{const n={};for(const o in e)(!Ze(o)||!(o.slice(9)in t))&&(n[o]=e[o]);return n};function an(e,t,n){const o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let s=0;s<o.length;s++){const a=o[s];if(t[a]!==e[a]&&!Wt(n,a))return!0}return!1}function rn(e,t,n=!1){const o=hs||Qt;if(o){const s=null==o.parent?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides;if(s&&e in s)return s[e];if(arguments.length>1)return n&&st(t)?t.call(o.proxy):t}}const ln={};function cn(e,t,n){return un(e,t,n)}function un(e,t,{immediate:n,deep:o,flush:s,onTrack:a,onTrigger:r}=qe){const i=hs;let l,c=!1,u=!1;if(Ce(e)?(l=()=>e.value,c=Ae(e)):Se(e)?(l=()=>e,o=!0):tt(e)?(u=!0,c=e.some((e=>Se(e)||Ae(e))),l=()=>e.map((e=>Ce(e)?e.value:Se(e)?fn(e):st(e)?Mt(e,i,2):void 0))):l=st(e)?t?()=>Mt(e,i,2):()=>{if(!i||!i.isUnmounted)return d&&d(),At(e,i,3,[m])}:Xe,t&&o){const e=l;l=()=>fn(e())}let d,m=e=>{d=g.onStop=()=>{Mt(e,i,4)}};if(ys)return m=Xe,t?n&&At(t,i,3,[l(),u?[]:void 0,m]):l(),Xe;let f=u?[]:ln;const p=()=>{if(g.active)if(t){const e=g.run();(o||c||(u?e.some(((e,t)=>bt(e,f[t]))):bt(e,f)))&&(d&&d(),At(t,i,3,[e,f===ln?void 0:f,m]),f=e)}else g.run()};let h;p.allowRecurse=!!t,h="sync"===s?p:"post"===s?()=>Fo(p,i&&i.suspense):()=>function(e){qt(e,jt,Ct,Ot)}(p);const g=new R(l,h);return t?n?p():f=g.run():"post"===s?Fo(g.run.bind(g),i&&i.suspense):g.run(),()=>{g.stop(),i&&i.scope&&Qe(i.scope.effects,g)}}function dn(e,t,n){const o=this.proxy,s=at(e)?e.includes(".")?mn(o,e):()=>o[e]:e.bind(o,o);let a;st(t)?a=t:(a=t.handler,n=t);const r=hs;_s(this);const i=un(s,a.bind(o),n);return r?_s(r):vs(),i}function mn(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function fn(e,t){if(!rt(e)||e.__v_skip||(t=t||new Set).has(e))return e;if(t.add(e),Ce(e))fn(e.value,t);else if(tt(e))for(let n=0;n<e.length;n++)fn(e[n],t);else if(ot(e)||nt(e))e.forEach((e=>{fn(e,t)}));else if(ut(e))for(const n in e)fn(e[n],t);return e}function pn(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Cn((()=>{e.isMounted=!0})),Fn((()=>{e.isUnmounting=!0})),e}const hn=[Function,Array],gn={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:hn,onEnter:hn,onAfterEnter:hn,onEnterCancelled:hn,onBeforeLeave:hn,onLeave:hn,onAfterLeave:hn,onLeaveCancelled:hn,onBeforeAppear:hn,onAppear:hn,onAfterAppear:hn,onAppearCancelled:hn},setup(e,{slots:t}){const n=gs(),o=pn();let s;return()=>{const a=t.default&&wn(t.default(),!0);if(!a||!a.length)return;let r=a[0];if(a.length>1)for(const e of a)if(e.type!==$o){r=e;break}const i=Ee(e),{mode:l}=i;if(o.isLeaving)return bn(r);const c=xn(r);if(!c)return bn(r);const u=vn(c,i,o,n);yn(c,u);const d=n.subTree,m=d&&xn(d);let f=!1;const{getTransitionKey:p}=c.type;if(p){const e=p();void 0===s?s=e:e!==s&&(s=e,f=!0)}if(m&&m.type!==$o&&(!Qo(c,m)||f)){const e=vn(m,i,o,n);if(yn(m,e),"out-in"===l)return o.isLeaving=!0,e.afterLeave=()=>{o.isLeaving=!1,n.update()},bn(r);"in-out"===l&&c.type!==$o&&(e.delayLeave=(e,t,n)=>{_n(o,m)[String(m.key)]=m,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=n})}return r}}};function _n(e,t){const{leavingVNodes:n}=e;let o=n.get(t.type);return o||(o=Object.create(null),n.set(t.type,o)),o}function vn(e,t,n,o){const{appear:s,mode:a,persisted:r=!1,onBeforeEnter:i,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:d,onLeave:m,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:h,onAppear:g,onAfterAppear:_,onAppearCancelled:v}=t,b=String(e.key),x=_n(n,e),y=(e,t)=>{e&&At(e,o,9,t)},w=(e,t)=>{const n=t[1];y(e,t),tt(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},k={mode:a,persisted:r,beforeEnter(t){let o=i;if(!n.isMounted){if(!s)return;o=h||i}t._leaveCb&&t._leaveCb(!0);const a=x[b];a&&Qo(e,a)&&a.el._leaveCb&&a.el._leaveCb(),y(o,[t])},enter(e){let t=l,o=c,a=u;if(!n.isMounted){if(!s)return;t=g||l,o=_||c,a=v||u}let r=!1;const i=e._enterCb=t=>{r||(r=!0,y(t?a:o,[e]),k.delayedLeave&&k.delayedLeave(),e._enterCb=void 0)};t?w(t,[e,i]):i()},leave(t,o){const s=String(e.key);if(t._enterCb&&t._enterCb(!0),n.isUnmounting)return o();y(d,[t]);let a=!1;const r=t._leaveCb=n=>{a||(a=!0,o(),y(n?p:f,[t]),t._leaveCb=void 0,x[s]===e&&delete x[s])};x[s]=e,m?w(m,[t,r]):r()},clone:e=>vn(e,t,n,o)};return k}function bn(e){if(Sn(e))return(e=as(e)).children=null,e}function xn(e){return Sn(e)?e.children?e.children[0]:void 0:e}function yn(e,t){6&e.shapeFlag&&e.component?yn(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function wn(e,t=!1,n){let o=[],s=0;for(let a=0;a<e.length;a++){let r=e[a];const i=null==n?r.key:String(n)+String(null!=r.key?r.key:a);r.type===Ho?(128&r.patchFlag&&s++,o=o.concat(wn(r.children,t,i))):(t||r.type!==$o)&&o.push(null!=i?as(r,{key:i}):r)}if(s>1)for(let e=0;e<o.length;e++)o[e].patchFlag=-2;return o}const kn=e=>!!e.type.__asyncLoader,Sn=e=>e.type.__isKeepAlive;function Mn(e,t){Rn(e,"a",t)}function An(e,t){Rn(e,"da",t)}function Rn(e,t,n=hs){const o=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(Tn(t,o,n),n){let e=n.parent;for(;e&&e.parent;)Sn(e.parent.vnode)&&En(o,t,n,e),e=e.parent}}function En(e,t,n,o){const s=Tn(t,e,o,!0);Ln((()=>{Qe(o[t],s)}),n)}function Tn(e,t,n=hs,o=!1){if(n){const s=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...o)=>{if(n.isUnmounted)return;I(),_s(n);const s=At(t,n,e,o);return vs(),C(),s});return o?s.unshift(a):s.push(a),a}}const Bn=e=>(t,n=hs)=>(!ys||"sp"===e)&&Tn(e,t,n),In=Bn("bm"),Cn=Bn("m"),jn=Bn("bu"),On=Bn("u"),Fn=Bn("bum"),Ln=Bn("um"),Pn=Bn("sp"),Dn=Bn("rtg"),Hn=Bn("rtc");function Nn(e,t=hs){Tn("ec",e,t)}function $n(e,t){const n=Qt;if(null===n)return e;const o=Ss(n)||n.proxy,s=e.dirs||(e.dirs=[]);for(let e=0;e<t.length;e++){let[n,a,r,i=qe]=t[e];st(n)&&(n={mounted:n,updated:n}),n.deep&&fn(a),s.push({dir:n,instance:o,value:a,oldValue:void 0,arg:r,modifiers:i})}return e}function zn(e,t,n,o){const s=e.dirs,a=t&&t.dirs;for(let r=0;r<s.length;r++){const i=s[r];a&&(i.oldValue=a[r].value);let l=i.dir[o];l&&(I(),At(l,n,8,[e.el,i,e,t]),C())}}const Vn="components",qn="directives";function Un(e,t){return Kn(Vn,e,!0,t)||e}const Xn=Symbol();function Yn(e){return at(e)?Kn(Vn,e,!1)||e:e||Xn}function Gn(e){return Kn(qn,e)}function Kn(e,t,n=!0,o=!1){const s=Qt||hs;if(s){const n=s.type;if(e===Vn){const e=function(e,t=!0){return st(e)?e.displayName||e.name:e.name||t&&e.__name}(n,!1);if(e&&(e===t||e===pt(t)||e===_t(pt(t))))return n}const a=Zn(s[e]||n[e],t)||Zn(s.appContext[e],t);return!a&&o?n:a}}function Zn(e,t){return e&&(e[t]||e[pt(t)]||e[_t(pt(t))])}function Wn(e,t,n,o){let s;const a=n&&n[o];if(tt(e)||at(e)){s=new Array(e.length);for(let n=0,o=e.length;n<o;n++)s[n]=t(e[n],n,void 0,a&&a[n])}else if("number"==typeof e){s=new Array(e);for(let n=0;n<e;n++)s[n]=t(n+1,n,void 0,a&&a[n])}else if(rt(e))if(e[Symbol.iterator])s=Array.from(e,((e,n)=>t(e,n,void 0,a&&a[n])));else{const n=Object.keys(e);s=new Array(n.length);for(let o=0,r=n.length;o<r;o++){const r=n[o];s[o]=t(e[r],r,o,a&&a[o])}}else s=[];return n&&(n[o]=s),s}function Qn(e,t){for(let n=0;n<t.length;n++){const o=t[n];if(tt(o))for(let t=0;t<o.length;t++)e[o[t].name]=o[t].fn;else o&&(e[o.name]=o.fn)}return e}function Jn(e,t,n={},o,s){if(Qt.isCE||Qt.parent&&kn(Qt.parent)&&Qt.parent.isCE)return os("slot","default"===t?null:{name:t},o&&o());let a=e[t];a&&a._c&&(a._d=!1),Uo();const r=a&&eo(a(n)),i=Zo(Ho,{key:n.key||`_${t}`},r||(o?o():[]),r&&1===e._?64:-2);return!s&&i.scopeId&&(i.slotScopeIds=[i.scopeId+"-s"]),a&&a._c&&(a._d=!0),i}function eo(e){return e.some((e=>!Wo(e)||!(e.type===$o||e.type===Ho&&!eo(e.children))))?e:null}const to=e=>e?bs(e)?Ss(e)||e.proxy:to(e.parent):null,no=We(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>to(e.parent),$root:e=>to(e.root),$emit:e=>e.emit,$options:e=>lo(e),$forceUpdate:e=>e.f||(e.f=()=>zt(e.update)),$nextTick:e=>e.n||(e.n=$t.bind(e.proxy)),$watch:e=>dn.bind(e)}),oo={get({_:e},t){const{ctx:n,setupState:o,data:s,props:a,accessCache:r,type:i,appContext:l}=e;let c;if("$"!==t[0]){const i=r[t];if(void 0!==i)switch(i){case 1:return o[t];case 2:return s[t];case 4:return n[t];case 3:return a[t]}else{if(o!==qe&&et(o,t))return r[t]=1,o[t];if(s!==qe&&et(s,t))return r[t]=2,s[t];if((c=e.propsOptions[0])&&et(c,t))return r[t]=3,a[t];if(n!==qe&&et(n,t))return r[t]=4,n[t];so&&(r[t]=0)}}const u=no[t];let d,m;return u?("$attrs"===t&&j(e,0,t),u(e)):(d=i.__cssModules)&&(d=d[t])?d:n!==qe&&et(n,t)?(r[t]=4,n[t]):(m=l.config.globalProperties,et(m,t)?m[t]:void 0)},set({_:e},t,n){const{data:o,setupState:s,ctx:a}=e;return s!==qe&&et(s,t)?(s[t]=n,!0):o!==qe&&et(o,t)?(o[t]=n,!0):!(et(e.props,t)||"$"===t[0]&&t.slice(1)in e)&&(a[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:o,appContext:s,propsOptions:a}},r){let i;return!!n[r]||e!==qe&&et(e,r)||t!==qe&&et(t,r)||(i=a[0])&&et(i,r)||et(o,r)||et(no,r)||et(s.config.globalProperties,r)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:et(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let so=!0;function ao(e){const t=lo(e),n=e.proxy,o=e.ctx;so=!1,t.beforeCreate&&ro(t.beforeCreate,e,"bc");const{data:s,computed:a,methods:r,watch:i,provide:l,inject:c,created:u,beforeMount:d,mounted:m,beforeUpdate:f,updated:p,activated:h,deactivated:g,beforeDestroy:_,beforeUnmount:v,destroyed:b,unmounted:x,render:y,renderTracked:w,renderTriggered:k,errorCaptured:S,serverPrefetch:M,expose:A,inheritAttrs:R,components:E,directives:T,filters:B}=t;if(c&&function(e,t,n=Xe,o=!1){tt(e)&&(e=fo(e));for(const n in e){const s=e[n];let a;a=rt(s)?"default"in s?rn(s.from||n,s.default,!0):rn(s.from||n):rn(s),Ce(a)&&o?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e}):t[n]=a}}(c,o,null,e.appContext.config.unwrapInjectedRef),r)for(const e in r){const t=r[e];st(t)&&(o[e]=t.bind(n))}if(s){const t=s.call(n,n);rt(t)&&(e.data=ye(t))}if(so=!0,a)for(const e in a){const t=a[e],s=st(t)?t.bind(n,n):st(t.get)?t.get.bind(n,n):Xe,r=!st(t)&&st(t.set)?t.set.bind(n):Xe,i=Ms({get:s,set:r});Object.defineProperty(o,e,{enumerable:!0,configurable:!0,get:()=>i.value,set:e=>i.value=e})}if(i)for(const e in i)io(i[e],o,n,e);if(l){const e=st(l)?l.call(n):l;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(hs){let n=hs.provides;const o=hs.parent&&hs.parent.provides;o===n&&(n=hs.provides=Object.create(o)),n[e]=t}}(t,e[t])}))}function I(e,t){tt(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(u&&ro(u,e,"c"),I(In,d),I(Cn,m),I(jn,f),I(On,p),I(Mn,h),I(An,g),I(Nn,S),I(Hn,w),I(Dn,k),I(Fn,v),I(Ln,x),I(Pn,M),tt(A))if(A.length){const t=e.exposed||(e.exposed={});A.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});y&&e.render===Xe&&(e.render=y),null!=R&&(e.inheritAttrs=R),E&&(e.components=E),T&&(e.directives=T)}function ro(e,t,n){At(tt(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function io(e,t,n,o){const s=o.includes(".")?mn(n,o):()=>n[o];if(at(e)){const n=t[e];st(n)&&cn(s,n)}else if(st(e))cn(s,e.bind(n));else if(rt(e))if(tt(e))e.forEach((e=>io(e,t,n,o)));else{const o=st(e.handler)?e.handler.bind(n):t[e.handler];st(o)&&cn(s,o,e)}}function lo(e){const t=e.type,{mixins:n,extends:o}=t,{mixins:s,optionsCache:a,config:{optionMergeStrategies:r}}=e.appContext,i=a.get(t);let l;return i?l=i:s.length||n||o?(l={},s.length&&s.forEach((e=>co(l,e,r,!0))),co(l,t,r)):l=t,a.set(t,l),l}function co(e,t,n,o=!1){const{mixins:s,extends:a}=t;a&&co(e,a,n,!0),s&&s.forEach((t=>co(e,t,n,!0)));for(const s in t)if(!o||"expose"!==s){const o=uo[s]||n&&n[s];e[s]=o?o(e[s],t[s]):t[s]}return e}const uo={data:mo,props:ho,emits:ho,methods:ho,computed:ho,beforeCreate:po,created:po,beforeMount:po,mounted:po,beforeUpdate:po,updated:po,beforeDestroy:po,beforeUnmount:po,destroyed:po,unmounted:po,activated:po,deactivated:po,errorCaptured:po,serverPrefetch:po,components:ho,directives:ho,watch:function(e,t){if(!e)return t;if(!t)return e;const n=We(Object.create(null),e);for(const o in t)n[o]=po(e[o],t[o]);return n},provide:mo,inject:function(e,t){return ho(fo(e),fo(t))}};function mo(e,t){return t?e?function(){return We(st(e)?e.call(this,this):e,st(t)?t.call(this,this):t)}:t:e}function fo(e){if(tt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function po(e,t){return e?[...new Set([].concat(e,t))]:t}function ho(e,t){return e?We(We(Object.create(null),e),t):t}function go(e,t,n,o=!1){const s={},a={};yt(a,Jo,1),e.propsDefaults=Object.create(null),_o(e,t,s,a);for(const t in e.propsOptions[0])t in s||(s[t]=void 0);n?e.props=o?s:function(e){return ke(e,!1,Z,he,ve)}(s):e.type.props?e.props=s:e.props=a,e.attrs=a}function _o(e,t,n,o){const[s,a]=e.propsOptions;let r,i=!1;if(t)for(let l in t){if(dt(l))continue;const c=t[l];let u;s&&et(s,u=pt(l))?a&&a.includes(u)?(r||(r={}))[u]=c:n[u]=c:Wt(e.emitsOptions,l)||(!(l in o)||c!==o[l])&&(o[l]=c,i=!0)}if(a){const t=Ee(n),o=r||qe;for(let r=0;r<a.length;r++){const i=a[r];n[i]=vo(s,t,i,o[i],e,!et(o,i))}}return i}function vo(e,t,n,o,s,a){const r=e[n];if(null!=r){const e=et(r,"default");if(e&&void 0===o){const e=r.default;if(r.type!==Function&&st(e)){const{propsDefaults:a}=s;n in a?o=a[n]:(_s(s),o=a[n]=e.call(null,t),vs())}else o=e}r[0]&&(a&&!e?o=!1:r[1]&&(""===o||o===gt(n))&&(o=!0))}return o}function bo(e,t,n=!1){const o=t.propsCache,s=o.get(e);if(s)return s;const a=e.props,r={},i=[];let l=!1;if(!st(e)){const o=e=>{l=!0;const[n,o]=bo(e,t,!0);We(r,n),o&&i.push(...o)};!n&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}if(!a&&!l)return o.set(e,Ue),Ue;if(tt(a))for(let e=0;e<a.length;e++){const t=pt(a[e]);xo(t)&&(r[t]=qe)}else if(a)for(const e in a){const t=pt(e);if(xo(t)){const n=a[e],o=r[t]=tt(n)||st(n)?{type:n}:n;if(o){const e=ko(Boolean,o.type),n=ko(String,o.type);o[0]=e>-1,o[1]=n<0||e<n,(e>-1||et(o,"default"))&&i.push(t)}}}const c=[r,i];return o.set(e,c),c}function xo(e){return"$"!==e[0]}function yo(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function wo(e,t){return yo(e)===yo(t)}function ko(e,t){return tt(t)?t.findIndex((t=>wo(t,e))):st(t)&&wo(t,e)?0:-1}const So=e=>"_"===e[0]||"$stable"===e,Mo=e=>tt(e)?e.map(ls):[ls(e)],Ao=(e,t,n)=>{if(t._n)return t;const o=tn(((...e)=>Mo(t(...e))),n);return o._c=!1,o},Ro=(e,t,n)=>{const o=e._ctx;for(const n in e){if(So(n))continue;const s=e[n];if(st(s))t[n]=Ao(0,s,o);else if(null!=s){const e=Mo(s);t[n]=()=>e}}},Eo=(e,t)=>{const n=Mo(t);e.slots.default=()=>n},To=(e,t)=>{if(32&e.vnode.shapeFlag){const n=t._;n?(e.slots=Ee(t),yt(t,"_",n)):Ro(t,e.slots={})}else e.slots={},t&&Eo(e,t);yt(e.slots,Jo,1)},Bo=(e,t,n)=>{const{vnode:o,slots:s}=e;let a=!0,r=qe;if(32&o.shapeFlag){const e=t._;e?n&&1===e?a=!1:(We(s,t),!n&&1===e&&delete s._):(a=!t.$stable,Ro(t,s)),r=t}else t&&(Eo(e,t),r={default:1});if(a)for(const e in s)!So(e)&&!(e in r)&&delete s[e]};function Io(){return{app:null,config:{isNativeTag:Ye,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Co=0;function jo(e,t){return function(n,o=null){st(n)||(n=Object.assign({},n)),null!=o&&!rt(o)&&(o=null);const s=Io(),a=new Set;let r=!1;const i=s.app={_uid:Co++,_component:n,_props:o,_container:null,_context:s,_instance:null,version:As,get config(){return s.config},set config(e){},use:(e,...t)=>(a.has(e)||(e&&st(e.install)?(a.add(e),e.install(i,...t)):st(e)&&(a.add(e),e(i,...t))),i),mixin:e=>(s.mixins.includes(e)||s.mixins.push(e),i),component:(e,t)=>t?(s.components[e]=t,i):s.components[e],directive:(e,t)=>t?(s.directives[e]=t,i):s.directives[e],mount(a,l,c){if(!r){const u=os(n,o);return u.appContext=s,l&&t?t(u,a):e(u,a,c),r=!0,i._container=a,a.__vue_app__=i,Ss(u.component)||u.component.proxy}},unmount(){r&&(e(null,i._container),delete i._container.__vue_app__)},provide:(e,t)=>(s.provides[e]=t,i)};return i}}function Oo(e,t,n,o,s=!1){if(tt(e))return void e.forEach(((e,a)=>Oo(e,t&&(tt(t)?t[a]:t),n,o,s)));if(kn(o)&&!s)return;const a=4&o.shapeFlag?Ss(o.component)||o.component.proxy:o.el,r=s?null:a,{i:i,r:l}=e,c=t&&t.r,u=i.refs===qe?i.refs={}:i.refs,d=i.setupState;if(null!=c&&c!==l&&(at(c)?(u[c]=null,et(d,c)&&(d[c]=null)):Ce(c)&&(c.value=null)),st(l))Mt(l,i,12,[r,u]);else{const t=at(l),o=Ce(l);if(t||o){const i=()=>{if(e.f){const n=t?u[l]:l.value;s?tt(n)&&Qe(n,a):tt(n)?n.includes(a)||n.push(a):t?(u[l]=[a],et(d,l)&&(d[l]=u[l])):(l.value=[a],e.k&&(u[e.k]=l.value))}else t?(u[l]=r,et(d,l)&&(d[l]=r)):o&&(l.value=r,e.k&&(u[e.k]=r))};r?(i.id=-1,Fo(i,n)):i()}}}const Fo=function(e,t){t&&t.pendingBranch?tt(e)?t.effects.push(...e):t.effects.push(e):function(e){qt(e,Lt,Ft,Pt)}(e)};function Lo(e){return function(e,t){St().__VUE__=!0;const{insert:n,remove:o,patchProp:s,createElement:a,createText:r,createComment:i,setText:l,setElementText:c,parentNode:u,nextSibling:d,setScopeId:m=Xe,cloneNode:f,insertStaticContent:p}=e,h=(e,t,n,o=null,s=null,a=null,r=!1,i=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!Qo(e,t)&&(o=K(e),q(e,s,a,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:u,shapeFlag:d}=t;switch(c){case No:_(e,t,n,o);break;case $o:v(e,t,n,o);break;case zo:null==e&&b(t,n,o,r);break;case Ho:B(e,t,n,o,s,a,r,i,l);break;default:1&d?w(e,t,n,o,s,a,r,i,l):6&d?O(e,t,n,o,s,a,r,i,l):(64&d||128&d)&&c.process(e,t,n,o,s,a,r,i,l,W)}null!=u&&s&&Oo(u,e&&e.ref,a,t||e,!t)},_=(e,t,o,s)=>{if(null==e)n(t.el=r(t.children),o,s);else{const n=t.el=e.el;t.children!==e.children&&l(n,t.children)}},v=(e,t,o,s)=>{null==e?n(t.el=i(t.children||""),o,s):t.el=e.el},b=(e,t,n,o)=>{[e.el,e.anchor]=p(e.children,t,n,o,e.el,e.anchor)},x=({el:e,anchor:t},o,s)=>{let a;for(;e&&e!==t;)a=d(e),n(e,o,s),e=a;n(t,o,s)},y=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=d(e),o(e),e=n;o(t)},w=(e,t,n,o,s,a,r,i,l)=>{r=r||"svg"===t.type,null==e?k(t,n,o,s,a,r,i,l):A(e,t,s,a,r,i,l)},k=(e,t,o,r,i,l,u,d)=>{let m,p;const{type:h,props:g,shapeFlag:_,transition:v,patchFlag:b,dirs:x}=e;if(e.el&&void 0!==f&&-1===b)m=e.el=f(e.el);else{if(m=e.el=a(e.type,l,g&&g.is,g),8&_?c(m,e.children):16&_&&M(e.children,m,null,r,i,l&&"foreignObject"!==h,u,d),x&&zn(e,null,r,"created"),g){for(const t in g)"value"!==t&&!dt(t)&&s(m,t,null,g[t],l,e.children,r,i,G);"value"in g&&s(m,"value",null,g.value),(p=g.onVnodeBeforeMount)&&ms(p,r,e)}S(m,e,e.scopeId,u,r)}x&&zn(e,null,r,"beforeMount");const y=(!i||i&&!i.pendingBranch)&&v&&!v.persisted;y&&v.beforeEnter(m),n(m,t,o),((p=g&&g.onVnodeMounted)||y||x)&&Fo((()=>{p&&ms(p,r,e),y&&v.enter(m),x&&zn(e,null,r,"mounted")}),i)},S=(e,t,n,o,s)=>{if(n&&m(e,n),o)for(let t=0;t<o.length;t++)m(e,o[t]);if(s){if(t===s.subTree){const t=s.vnode;S(e,t,t.scopeId,t.slotScopeIds,s.parent)}}},M=(e,t,n,o,s,a,r,i,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=i?cs(e[c]):ls(e[c]);h(null,l,t,n,o,s,a,r,i)}},A=(e,t,n,o,a,r,i)=>{const l=t.el=e.el;let{patchFlag:u,dynamicChildren:d,dirs:m}=t;u|=16&e.patchFlag;const f=e.props||qe,p=t.props||qe;let h;n&&Po(n,!1),(h=p.onVnodeBeforeUpdate)&&ms(h,n,t,e),m&&zn(t,e,n,"beforeUpdate"),n&&Po(n,!0);const g=a&&"foreignObject"!==t.type;if(d?E(e.dynamicChildren,d,l,n,o,g,r):i||N(e,t,l,null,n,o,g,r,!1),u>0){if(16&u)T(l,t,f,p,n,o,a);else if(2&u&&f.class!==p.class&&s(l,"class",null,p.class,a),4&u&&s(l,"style",f.style,p.style,a),8&u){const r=t.dynamicProps;for(let t=0;t<r.length;t++){const i=r[t],c=f[i],u=p[i];(u!==c||"value"===i)&&s(l,i,c,u,a,e.children,n,o,G)}}1&u&&e.children!==t.children&&c(l,t.children)}else!i&&null==d&&T(l,t,f,p,n,o,a);((h=p.onVnodeUpdated)||m)&&Fo((()=>{h&&ms(h,n,t,e),m&&zn(t,e,n,"updated")}),o)},E=(e,t,n,o,s,a,r)=>{for(let i=0;i<t.length;i++){const l=e[i],c=t[i],d=l.el&&(l.type===Ho||!Qo(l,c)||70&l.shapeFlag)?u(l.el):n;h(l,c,d,null,o,s,a,r,!0)}},T=(e,t,n,o,a,r,i)=>{if(n!==o){for(const l in o){if(dt(l))continue;const c=o[l],u=n[l];c!==u&&"value"!==l&&s(e,l,u,c,i,t.children,a,r,G)}if(n!==qe)for(const l in n)!dt(l)&&!(l in o)&&s(e,l,n[l],null,i,t.children,a,r,G);"value"in o&&s(e,"value",n.value,o.value)}},B=(e,t,o,s,a,i,l,c,u)=>{const d=t.el=e?e.el:r(""),m=t.anchor=e?e.anchor:r("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:h}=t;h&&(c=c?c.concat(h):h),null==e?(n(d,o,s),n(m,o,s),M(t.children,o,m,a,i,l,c,u)):f>0&&64&f&&p&&e.dynamicChildren?(E(e.dynamicChildren,p,o,a,i,l,c),(null!=t.key||a&&t===a.subTree)&&Do(e,t,!0)):N(e,t,o,m,a,i,l,c,u)},O=(e,t,n,o,s,a,r,i,l)=>{t.slotScopeIds=i,null==e?512&t.shapeFlag?s.ctx.activate(t,n,o,r,l):L(t,n,o,s,a,r,l):P(e,t,l)},L=(e,t,n,o,s,a,r)=>{const i=e.component=function(e,t,n){const o=e.type,s=(t?t.appContext:e.appContext)||fs,a={uid:ps++,vnode:e,type:o,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new g(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:bo(o,s),emitsOptions:Zt(o,s),emit:null,emitted:null,propsDefaults:qe,inheritAttrs:o.inheritAttrs,ctx:qe,data:qe,props:qe,attrs:qe,slots:qe,refs:qe,setupState:qe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=Kt.bind(null,a),e.ce&&e.ce(a),a}(e,o,s);if(Sn(e)&&(i.ctx.renderer=W),function(e,t=!1){ys=t;const{props:n,children:o}=e.vnode,s=bs(e);go(e,n,s,t),To(e,o);const a=s?function(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=Te(new Proxy(e.ctx,oo));const{setup:o}=n;if(o){const n=e.setupContext=o.length>1?function(e){const t=t=>{e.exposed=t||{}};let n;return{get attrs(){return n||(n=function(e){return new Proxy(e.attrs,{get:(t,n)=>(j(e,0,"$attrs"),t[n])})}(e))},slots:e.slots,emit:e.emit,expose:t}}(e):null;_s(e),I();const s=Mt(o,e,0,[e.props,n]);if(C(),vs(),it(s)){if(s.then(vs,vs),t)return s.then((n=>{ws(e,n,t)})).catch((t=>{Rt(t,e,0)}));e.asyncDep=s}else ws(e,s,t)}else ks(e,t)}(e,t):void 0;ys=!1}(i),i.asyncDep){if(s&&s.registerDep(i,D),!e.el){const e=i.subTree=os($o);v(null,e,t,n)}}else D(i,e,t,n,s,a,r)},P=(e,t,n)=>{const o=t.component=e.component;if(function(e,t,n){const{props:o,children:s,component:a}=e,{props:r,children:i,patchFlag:l}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!s&&!i||i&&i.$stable)||o!==r&&(o?!r||an(o,r,c):!!r);if(1024&l)return!0;if(16&l)return o?an(o,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(r[n]!==o[n]&&!Wt(c,n))return!0}}return!1}(e,t,n)){if(o.asyncDep&&!o.asyncResolved)return void H(o,t,n);o.next=t,function(e){const t=Bt.indexOf(e);t>It&&Bt.splice(t,1)}(o.update),o.update()}else t.el=e.el,o.vnode=t},D=(e,t,n,o,s,a,r)=>{const i=()=>{if(e.isMounted){let t,{next:n,bu:o,u:i,parent:l,vnode:c}=e,d=n;Po(e,!1),n?(n.el=c.el,H(e,n,r)):n=c,o&&xt(o),(t=n.props&&n.props.onVnodeBeforeUpdate)&&ms(t,l,n,c),Po(e,!0);const m=nn(e),f=e.subTree;e.subTree=m,h(f,m,u(f.el),K(f),e,s,a),n.el=m.el,null===d&&function({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}(e,m.el),i&&Fo(i,s),(t=n.props&&n.props.onVnodeUpdated)&&Fo((()=>ms(t,l,n,c)),s)}else{let r;const{el:i,props:l}=t,{bm:c,m:u,parent:d}=e,m=kn(t);if(Po(e,!1),c&&xt(c),!m&&(r=l&&l.onVnodeBeforeMount)&&ms(r,d,t),Po(e,!0),i&&J){const n=()=>{e.subTree=nn(e),J(i,e.subTree,e,s,null)};m?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{const r=e.subTree=nn(e);h(null,r,n,o,e,s,a),t.el=r.el}if(u&&Fo(u,s),!m&&(r=l&&l.onVnodeMounted)){const e=t;Fo((()=>ms(r,d,e)),s)}(256&t.shapeFlag||d&&kn(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&Fo(e.a,s),e.isMounted=!0,t=n=o=null}},l=e.effect=new R(i,(()=>zt(c)),e.scope),c=e.update=()=>l.run();c.id=e.uid,Po(e,!0),c()},H=(e,t,n)=>{t.component=e;const o=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,o){const{props:s,attrs:a,vnode:{patchFlag:r}}=e,i=Ee(s),[l]=e.propsOptions;let c=!1;if(!(o||r>0)||16&r){let o;_o(e,t,s,a)&&(c=!0);for(const a in i)(!t||!et(t,a)&&((o=gt(a))===a||!et(t,o)))&&(l?n&&(void 0!==n[a]||void 0!==n[o])&&(s[a]=vo(l,i,a,void 0,e,!0)):delete s[a]);if(a!==i)for(const e in a)(!t||!et(t,e))&&(delete a[e],c=!0)}else if(8&r){const n=e.vnode.dynamicProps;for(let o=0;o<n.length;o++){let r=n[o];if(Wt(e.emitsOptions,r))continue;const u=t[r];if(l)if(et(a,r))u!==a[r]&&(a[r]=u,c=!0);else{const t=pt(r);s[t]=vo(l,i,t,u,e,!1)}else u!==a[r]&&(a[r]=u,c=!0)}}c&&F(e,"set","$attrs")}(e,t.props,o,n),Bo(e,t.children,n),I(),Ut(void 0,e.update),C()},N=(e,t,n,o,s,a,r,i,l=!1)=>{const u=e&&e.children,d=e?e.shapeFlag:0,m=t.children,{patchFlag:f,shapeFlag:p}=t;if(f>0){if(128&f)return void z(u,m,n,o,s,a,r,i,l);if(256&f)return void $(u,m,n,o,s,a,r,i,l)}8&p?(16&d&&G(u,s,a),m!==u&&c(n,m)):16&d?16&p?z(u,m,n,o,s,a,r,i,l):G(u,s,a,!0):(8&d&&c(n,""),16&p&&M(m,n,o,s,a,r,i,l))},$=(e,t,n,o,s,a,r,i,l)=>{t=t||Ue;const c=(e=e||Ue).length,u=t.length,d=Math.min(c,u);let m;for(m=0;m<d;m++){const o=t[m]=l?cs(t[m]):ls(t[m]);h(e[m],o,n,null,s,a,r,i,l)}c>u?G(e,s,a,!0,!1,d):M(t,n,o,s,a,r,i,l,d)},z=(e,t,n,o,s,a,r,i,l)=>{let c=0;const u=t.length;let d=e.length-1,m=u-1;for(;c<=d&&c<=m;){const o=e[c],u=t[c]=l?cs(t[c]):ls(t[c]);if(!Qo(o,u))break;h(o,u,n,null,s,a,r,i,l),c++}for(;c<=d&&c<=m;){const o=e[d],c=t[m]=l?cs(t[m]):ls(t[m]);if(!Qo(o,c))break;h(o,c,n,null,s,a,r,i,l),d--,m--}if(c>d){if(c<=m){const e=m+1,d=e<u?t[e].el:o;for(;c<=m;)h(null,t[c]=l?cs(t[c]):ls(t[c]),n,d,s,a,r,i,l),c++}}else if(c>m)for(;c<=d;)q(e[c],s,a,!0),c++;else{const f=c,p=c,g=new Map;for(c=p;c<=m;c++){const e=t[c]=l?cs(t[c]):ls(t[c]);null!=e.key&&g.set(e.key,c)}let _,v=0;const b=m-p+1;let x=!1,y=0;const w=new Array(b);for(c=0;c<b;c++)w[c]=0;for(c=f;c<=d;c++){const o=e[c];if(v>=b){q(o,s,a,!0);continue}let u;if(null!=o.key)u=g.get(o.key);else for(_=p;_<=m;_++)if(0===w[_-p]&&Qo(o,t[_])){u=_;break}void 0===u?q(o,s,a,!0):(w[u-p]=c+1,u>=y?y=u:x=!0,h(o,t[u],n,null,s,a,r,i,l),v++)}const k=x?function(e){const t=e.slice(),n=[0];let o,s,a,r,i;const l=e.length;for(o=0;o<l;o++){const l=e[o];if(0!==l){if(s=n[n.length-1],e[s]<l){t[o]=s,n.push(o);continue}for(a=0,r=n.length-1;a<r;)i=a+r>>1,e[n[i]]<l?a=i+1:r=i;l<e[n[a]]&&(a>0&&(t[o]=n[a-1]),n[a]=o)}}for(a=n.length,r=n[a-1];a-- >0;)n[a]=r,r=t[r];return n}(w):Ue;for(_=k.length-1,c=b-1;c>=0;c--){const e=p+c,d=t[e],m=e+1<u?t[e+1].el:o;0===w[c]?h(null,d,n,m,s,a,r,i,l):x&&(_<0||c!==k[_]?V(d,n,m,2):_--)}}},V=(e,t,o,s,a=null)=>{const{el:r,type:i,transition:l,children:c,shapeFlag:u}=e;if(6&u)V(e.component.subTree,t,o,s);else if(128&u)e.suspense.move(t,o,s);else if(64&u)i.move(e,t,o,W);else if(i!==Ho)if(i!==zo)if(2!==s&&1&u&&l)if(0===s)l.beforeEnter(r),n(r,t,o),Fo((()=>l.enter(r)),a);else{const{leave:e,delayLeave:s,afterLeave:a}=l,i=()=>n(r,t,o),c=()=>{e(r,(()=>{i(),a&&a()}))};s?s(r,i,c):c()}else n(r,t,o);else x(e,t,o);else{n(r,t,o);for(let e=0;e<c.length;e++)V(c[e],t,o,s);n(e.anchor,t,o)}},q=(e,t,n,o=!1,s=!1)=>{const{type:a,props:r,ref:i,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:d,dirs:m}=e;if(null!=i&&Oo(i,null,n,e,!0),256&u)return void t.ctx.deactivate(e);const f=1&u&&m,p=!kn(e);let h;if(p&&(h=r&&r.onVnodeBeforeUnmount)&&ms(h,t,e),6&u)Y(e.component,n,o);else{if(128&u)return void e.suspense.unmount(n,o);f&&zn(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,s,W,o):c&&(a!==Ho||d>0&&64&d)?G(c,t,n,!1,!0):(a===Ho&&384&d||!s&&16&u)&&G(l,t,n),o&&U(e)}(p&&(h=r&&r.onVnodeUnmounted)||f)&&Fo((()=>{h&&ms(h,t,e),f&&zn(e,null,t,"unmounted")}),n)},U=e=>{const{type:t,el:n,anchor:s,transition:a}=e;if(t===Ho)return void X(n,s);if(t===zo)return void y(e);const r=()=>{o(n),a&&!a.persisted&&a.afterLeave&&a.afterLeave()};if(1&e.shapeFlag&&a&&!a.persisted){const{leave:t,delayLeave:o}=a,s=()=>t(n,r);o?o(e.el,r,s):s()}else r()},X=(e,t)=>{let n;for(;e!==t;)n=d(e),o(e),e=n;o(t)},Y=(e,t,n)=>{const{bum:o,scope:s,update:a,subTree:r,um:i}=e;o&&xt(o),s.stop(),a&&(a.active=!1,q(r,e,t,n)),i&&Fo(i,t),Fo((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},G=(e,t,n,o=!1,s=!1,a=0)=>{for(let r=a;r<e.length;r++)q(e[r],t,n,o,s)},K=e=>6&e.shapeFlag?K(e.component.subTree):128&e.shapeFlag?e.suspense.next():d(e.anchor||e.el),Z=(e,t,n)=>{null==e?t._vnode&&q(t._vnode,null,null,!0):h(t._vnode||null,e,t,null,null,null,n),Xt(),t._vnode=e},W={p:h,um:q,m:V,r:U,mt:L,mc:M,pc:N,pbc:E,n:K,o:e};let Q,J;return t&&([Q,J]=t(W)),{render:Z,hydrate:Q,createApp:jo(Z,Q)}}(e)}function Po({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function Do(e,t,n=!1){const o=e.children,s=t.children;if(tt(o)&&tt(s))for(let e=0;e<o.length;e++){const t=o[e];let a=s[e];1&a.shapeFlag&&!a.dynamicChildren&&((a.patchFlag<=0||32===a.patchFlag)&&(a=s[e]=cs(s[e]),a.el=t.el),n||Do(t,a))}}const Ho=Symbol(void 0),No=Symbol(void 0),$o=Symbol(void 0),zo=Symbol(void 0),Vo=[];let qo=null;function Uo(e=!1){Vo.push(qo=e?null:[])}let Xo=1;function Yo(e){Xo+=e}function Go(e){return e.dynamicChildren=Xo>0?qo||Ue:null,Vo.pop(),qo=Vo[Vo.length-1]||null,Xo>0&&qo&&qo.push(e),e}function Ko(e,t,n,o,s,a){return Go(ns(e,t,n,o,s,a,!0))}function Zo(e,t,n,o,s){return Go(os(e,t,n,o,s,!0))}function Wo(e){return!!e&&!0===e.__v_isVNode}function Qo(e,t){return e.type===t.type&&e.key===t.key}const Jo="__vInternal",es=({key:e})=>null!=e?e:null,ts=({ref:e,ref_key:t,ref_for:n})=>null!=e?at(e)||Ce(e)||st(e)?{i:Qt,r:e,k:t,f:!!n}:e:null;function ns(e,t=null,n=null,o=0,s=null,a=(e===Ho?0:1),r=!1,i=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&es(t),ref:t&&ts(t),scopeId:Jt,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null};return i?(us(l,n),128&a&&e.normalize(l)):n&&(l.shapeFlag|=at(n)?8:16),Xo>0&&!r&&qo&&(l.patchFlag>0||6&a)&&32!==l.patchFlag&&qo.push(l),l}const os=function(e,t=null,n=null,o=0,s=null,a=!1){if((!e||e===Xn)&&(e=$o),Wo(e)){const o=as(e,t,!0);return n&&us(o,n),Xo>0&&!a&&qo&&(6&o.shapeFlag?qo[qo.indexOf(e)]=o:qo.push(o)),o.patchFlag|=-2,o}if(function(e){return st(e)&&"__vccOpts"in e}(e)&&(e=e.__vccOpts),t){t=ss(t);let{class:e,style:n}=t;e&&!at(e)&&(t.class=Ne(e)),rt(n)&&(Re(n)&&!tt(n)&&(n=We({},n)),t.style=Le(n))}const r=at(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:rt(e)?4:st(e)?2:0;return ns(e,t,n,o,s,r,a,!0)};function ss(e){return e?Re(e)||Jo in e?We({},e):e:null}function as(e,t,n=!1){const{props:o,ref:s,patchFlag:a,children:r}=e,i=t?ds(o||{},t):o;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:i,key:i&&es(i),ref:t&&t.ref?n&&s?tt(s)?s.concat(ts(t)):[s,ts(t)]:ts(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:r,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ho?-1===a?16:16|a:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&as(e.ssContent),ssFallback:e.ssFallback&&as(e.ssFallback),el:e.el,anchor:e.anchor}}function rs(e=" ",t=0){return os(No,null,e,t)}function is(e="",t=!1){return t?(Uo(),Zo($o,null,e)):os($o,null,e)}function ls(e){return null==e||"boolean"==typeof e?os($o):tt(e)?os(Ho,null,e.slice()):"object"==typeof e?cs(e):os(No,null,String(e))}function cs(e){return null===e.el||e.memo?e:as(e)}function us(e,t){let n=0;const{shapeFlag:o}=e;if(null==t)t=null;else if(tt(t))n=16;else if("object"==typeof t){if(65&o){const n=t.default;return void(n&&(n._c&&(n._d=!1),us(e,n()),n._c&&(n._d=!0)))}{n=32;const o=t._;o||Jo in t?3===o&&Qt&&(1===Qt.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Qt}}else st(t)?(t={default:t,_ctx:Qt},n=32):(t=String(t),64&o?(n=16,t=[rs(t)]):n=8);e.children=t,e.shapeFlag|=n}function ds(...e){const t={};for(let n=0;n<e.length;n++){const o=e[n];for(const e in o)if("class"===e)t.class!==o.class&&(t.class=Ne([t.class,o.class]));else if("style"===e)t.style=Le([t.style,o.style]);else if(Ke(e)){const n=t[e],s=o[e];s&&n!==s&&(!tt(n)||!n.includes(s))&&(t[e]=n?[].concat(n,s):s)}else""!==e&&(t[e]=o[e])}return t}function ms(e,t,n,o=null){At(e,t,7,[n,o])}const fs=Io();let ps=0;let hs=null;const gs=()=>hs||Qt,_s=e=>{hs=e,e.scope.on()},vs=()=>{hs&&hs.scope.off(),hs=null};function bs(e){return 4&e.vnode.shapeFlag}let xs,ys=!1;function ws(e,t,n){st(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:rt(t)&&(e.setupState=Oe(t)),ks(e,n)}function ks(e,t,n){const o=e.type;if(!e.render){if(!t&&xs&&!o.render){const t=o.template;if(t){const{isCustomElement:n,compilerOptions:s}=e.appContext.config,{delimiters:a,compilerOptions:r}=o,i=We(We({isCustomElement:n,delimiters:a},s),r);o.render=xs(t,i)}}e.render=o.render||Xe}_s(e),I(),ao(e),C(),vs()}function Ss(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Oe(Te(e.exposed)),{get:(t,n)=>n in t?t[n]:n in no?no[n](e):void 0}))}const Ms=(e,n)=>function(e,n,o=!1){let s,a;const r=(e=>"function"==typeof e)(e);return r?(s=e,a=t):(s=e.get,a=e.set),new Fe(s,a,r||!a,o)}(e,0,ys);const As="3.2.37";const Rs=function(e,t){const n=Object.create(null),o=e.split(",");for(let e=0;e<o.length;e++)n[o[e]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Es(e){return!!e||""===e}const Ts=/^on[^a-z]/,Bs=Object.assign,Is=Array.isArray,Cs=e=>"string"==typeof e,js=e=>null!==e&&"object"==typeof e,Os=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Fs=/-(\w)/g,Ls=Os((e=>e.replace(Fs,((e,t)=>t?t.toUpperCase():"")))),Ps=/\B([A-Z])/g,Ds=Os((e=>e.replace(Ps,"-$1").toLowerCase())),Hs=Os((e=>e.charAt(0).toUpperCase()+e.slice(1))),Ns=e=>{const t=parseFloat(e);return isNaN(t)?e:t},$s="undefined"!=typeof document?document:null,zs=$s&&$s.createElement("template"),Vs={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,o)=>{const s=t?$s.createElementNS("http://www.w3.org/2000/svg",e):$s.createElement(e,n?{is:n}:void 0);return"select"===e&&o&&null!=o.multiple&&s.setAttribute("multiple",o.multiple),s},createText:e=>$s.createTextNode(e),createComment:e=>$s.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>$s.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,o,s,a){const r=n?n.previousSibling:t.lastChild;if(s&&(s===a||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),s!==a&&(s=s.nextSibling););else{zs.innerHTML=o?`<svg>${e}</svg>`:e;const s=zs.content;if(o){const e=s.firstChild;for(;e.firstChild;)s.appendChild(e.firstChild);s.removeChild(e)}t.insertBefore(s,n)}return[r?r.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};const qs=/\s*!important$/;function Us(e,t,n){if(Is(n))n.forEach((n=>Us(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const o=function(e,t){const n=Ys[t];if(n)return n;let o=pt(t);if("filter"!==o&&o in e)return Ys[t]=o;o=Hs(o);for(let n=0;n<Xs.length;n++){const s=Xs[n]+o;if(s in e)return Ys[t]=s}return t}(e,t);qs.test(n)?e.setProperty(Ds(o),n.replace(qs,""),"important"):e[o]=n}}const Xs=["Webkit","Moz","ms"],Ys={};const Gs="http://www.w3.org/1999/xlink";const[Ks,Zs]=(()=>{let e=Date.now,t=!1;if("undefined"!=typeof window){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let Ws=0;const Qs=Promise.resolve(),Js=()=>{Ws=0},ea=()=>Ws||(Qs.then(Js),Ws=Ks());function ta(e,t,n,o,s=null){const a=e._vei||(e._vei={}),r=a[t];if(o&&r)r.value=o;else{const[n,i]=function(e){let t;if(na.test(e)){let n;for(t={};n=e.match(na);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Ds(e.slice(2)),t]}(t);if(o){const r=a[t]=function(e,t){const n=e=>{const o=e.timeStamp||Ks();(Zs||o>=n.attached-1)&&At(function(e,t){if(Is(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=ea(),n}(o,s);!function(e,t,n,o){e.addEventListener(t,n,o)}(e,n,r,i)}else r&&(function(e,t,n,o){e.removeEventListener(t,n,o)}(e,n,r,i),a[t]=void 0)}}const na=/(?:Once|Passive|Capture)$/;const oa=/^on[a-z]/;const sa="undefined"!=typeof HTMLElement?HTMLElement:class{};class aa extends sa{constructor(e,t={},n){super(),this._def=e,this._props=t,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&n?n(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,$t((()=>{this._connected||(Ha(null,this.shadowRoot),this._instance=null)}))}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let e=0;e<this.attributes.length;e++)this._setAttr(this.attributes[e].name);new MutationObserver((e=>{for(const t of e)this._setAttr(t.attributeName)})).observe(this,{attributes:!0});const e=e=>{const{props:t,styles:n}=e,o=!Is(t),s=t?o?Object.keys(t):t:[];let a;if(o)for(const e in this._props){const n=t[e];(n===Number||n&&n.type===Number)&&(this._props[e]=Ns(this._props[e]),(a||(a=Object.create(null)))[e]=!0)}this._numberProps=a;for(const e of Object.keys(this))"_"!==e[0]&&this._setProp(e,this[e],!0,!1);for(const e of s.map(Ls))Object.defineProperty(this,e,{get(){return this._getProp(e)},set(t){this._setProp(e,t)}});this._applyStyles(n),this._update()},t=this._def.__asyncLoader;t?t().then(e):e(this._def)}_setAttr(e){let t=this.getAttribute(e);this._numberProps&&this._numberProps[e]&&(t=Ns(t)),this._setProp(Ls(e),t,!1)}_getProp(e){return this._props[e]}_setProp(e,t,n=!0,o=!0){t!==this._props[e]&&(this._props[e]=t,o&&this._instance&&this._update(),n&&(!0===t?this.setAttribute(Ds(e),""):"string"==typeof t||"number"==typeof t?this.setAttribute(Ds(e),t+""):t||this.removeAttribute(Ds(e))))}_update(){Ha(this._createVNode(),this.shadowRoot)}_createVNode(){const e=os(this._def,Bs({},this._props));return this._instance||(e.ce=e=>{this._instance=e,e.isCE=!0,e.emit=(e,...t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t}))};let t=this;for(;t=t&&(t.parentNode||t.host);)if(t instanceof aa){e.parent=t._instance;break}}),e}_applyStyles(e){e&&e.forEach((e=>{const t=document.createElement("style");t.textContent=e,this.shadowRoot.appendChild(t)}))}}const ra="transition",ia="animation",la=(e,{slots:t})=>function(e,t,n){const o=arguments.length;return 2===o?rt(t)&&!tt(t)?Wo(t)?os(e,null,[t]):os(e,t):os(e,null,t):(o>3?n=Array.prototype.slice.call(arguments,2):3===o&&Wo(n)&&(n=[n]),os(e,t,n))}(gn,fa(e),t);la.displayName="Transition";const ca={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ua=la.props=Bs({},gn.props,ca),da=(e,t=[])=>{Is(e)?e.forEach((e=>e(...t))):e&&e(...t)},ma=e=>!!e&&(Is(e)?e.some((e=>e.length>1)):e.length>1);function fa(e){const t={};for(const n in e)n in ca||(t[n]=e[n]);if(!1===e.css)return t;const{name:n="v",type:o,duration:s,enterFromClass:a=`${n}-enter-from`,enterActiveClass:r=`${n}-enter-active`,enterToClass:i=`${n}-enter-to`,appearFromClass:l=a,appearActiveClass:c=r,appearToClass:u=i,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:m=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=e,p=function(e){if(null==e)return null;if(js(e))return[pa(e.enter),pa(e.leave)];{const t=pa(e);return[t,t]}}(s),h=p&&p[0],g=p&&p[1],{onBeforeEnter:_,onEnter:v,onEnterCancelled:b,onLeave:x,onLeaveCancelled:y,onBeforeAppear:w=_,onAppear:k=v,onAppearCancelled:S=b}=t,M=(e,t,n)=>{ga(e,t?u:i),ga(e,t?c:r),n&&n()},A=(e,t)=>{e._isLeaving=!1,ga(e,d),ga(e,f),ga(e,m),t&&t()},R=e=>(t,n)=>{const s=e?k:v,r=()=>M(t,e,n);da(s,[t,r]),_a((()=>{ga(t,e?l:a),ha(t,e?u:i),ma(s)||ba(t,o,h,r)}))};return Bs(t,{onBeforeEnter(e){da(_,[e]),ha(e,a),ha(e,r)},onBeforeAppear(e){da(w,[e]),ha(e,l),ha(e,c)},onEnter:R(!1),onAppear:R(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>A(e,t);ha(e,d),ka(),ha(e,m),_a((()=>{!e._isLeaving||(ga(e,d),ha(e,f),ma(x)||ba(e,o,g,n))})),da(x,[e,n])},onEnterCancelled(e){M(e,!1),da(b,[e])},onAppearCancelled(e){M(e,!0),da(S,[e])},onLeaveCancelled(e){A(e),da(y,[e])}})}function pa(e){return Ns(e)}function ha(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e._vtc||(e._vtc=new Set)).add(t)}function ga(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function _a(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let va=0;function ba(e,t,n,o){const s=e._endId=++va,a=()=>{s===e._endId&&o()};if(n)return setTimeout(a,n);const{type:r,timeout:i,propCount:l}=xa(e,t);if(!r)return o();const c=r+"end";let u=0;const d=()=>{e.removeEventListener(c,m),a()},m=t=>{t.target===e&&++u>=l&&d()};setTimeout((()=>{u<l&&d()}),i+1),e.addEventListener(c,m)}function xa(e,t){const n=window.getComputedStyle(e),o=e=>(n[e]||"").split(", "),s=o(ra+"Delay"),a=o(ra+"Duration"),r=ya(s,a),i=o(ia+"Delay"),l=o(ia+"Duration"),c=ya(i,l);let u=null,d=0,m=0;t===ra?r>0&&(u=ra,d=r,m=a.length):t===ia?c>0&&(u=ia,d=c,m=l.length):(d=Math.max(r,c),u=d>0?r>c?ra:ia:null,m=u?u===ra?a.length:l.length:0);return{type:u,timeout:d,propCount:m,hasTransform:u===ra&&/\b(transform|all)(,|$)/.test(n[ra+"Property"])}}function ya(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map(((t,n)=>wa(t)+wa(e[n]))))}function wa(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function ka(){return document.body.offsetHeight}const Sa=new WeakMap,Ma=new WeakMap,Aa={name:"TransitionGroup",props:Bs({},ua,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=gs(),o=pn();let s,a;return On((()=>{if(!s.length)return;const t=e.moveClass||`${e.name||"v"}-move`;if(!function(e,t,n){const o=e.cloneNode();e._vtc&&e._vtc.forEach((e=>{e.split(/\s+/).forEach((e=>e&&o.classList.remove(e)))})),n.split(/\s+/).forEach((e=>e&&o.classList.add(e))),o.style.display="none";const s=1===t.nodeType?t:t.parentNode;s.appendChild(o);const{hasTransform:a}=xa(o);return s.removeChild(o),a}(s[0].el,n.vnode.el,t))return;s.forEach(Ra),s.forEach(Ea);const o=s.filter(Ta);ka(),o.forEach((e=>{const n=e.el,o=n.style;ha(n,t),o.transform=o.webkitTransform=o.transitionDuration="";const s=n._moveCb=e=>{e&&e.target!==n||(!e||/transform$/.test(e.propertyName))&&(n.removeEventListener("transitionend",s),n._moveCb=null,ga(n,t))};n.addEventListener("transitionend",s)}))})),()=>{const r=Ee(e),i=fa(r);let l=r.tag||Ho;s=a,a=t.default?wn(t.default()):[];for(let e=0;e<a.length;e++){const t=a[e];null!=t.key&&yn(t,vn(t,i,o,n))}if(s)for(let e=0;e<s.length;e++){const t=s[e];yn(t,vn(t,i,o,n)),Sa.set(t,t.el.getBoundingClientRect())}return os(l,null,a)}}};function Ra(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Ea(e){Ma.set(e,e.el.getBoundingClientRect())}function Ta(e){const t=Sa.get(e),n=Ma.get(e),o=t.left-n.left,s=t.top-n.top;if(o||s){const t=e.el.style;return t.transform=t.webkitTransform=`translate(${o}px,${s}px)`,t.transitionDuration="0s",e}}const Ba=["ctrl","shift","alt","meta"],Ia={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>Ba.some((n=>e[`${n}Key`]&&!t.includes(n)))},Ca=(e,t)=>(n,...o)=>{for(let e=0;e<t.length;e++){const o=Ia[t[e]];if(o&&o(n,t))return}return e(n,...o)},ja={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Oa=(e,t)=>n=>{if(!("key"in n))return;const o=Ds(n.key);return t.some((e=>e===o||ja[e]===o))?e(n):void 0},Fa={beforeMount(e,{value:t},{transition:n}){e._vod="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):La(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:o}){!t!=!n&&(o?t?(o.beforeEnter(e),La(e,!0),o.enter(e)):o.leave(e,(()=>{La(e,!1)})):La(e,t))},beforeUnmount(e,{value:t}){La(e,t)}};function La(e,t){e.style.display=t?e._vod:"none"}const Pa=Bs({patchProp:(e,t,n,o,s=!1,a,r,i,l)=>{"class"===t?function(e,t,n){const o=e._vtc;o&&(t=(t?[t,...o]:[...o]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,o,s):"style"===t?function(e,t,n){const o=e.style,s=Cs(n);if(n&&!s){for(const e in n)Us(o,e,n[e]);if(t&&!Cs(t))for(const e in t)null==n[e]&&Us(o,e,"")}else{const a=o.display;s?t!==n&&(o.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(o.display=a)}}(e,n,o):(e=>Ts.test(e))(t)?(e=>e.startsWith("onUpdate:"))(t)||ta(e,t,0,o,r):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,o){return o?!!("innerHTML"===t||"textContent"===t||t in e&&oa.test(t)&&(e=>"function"==typeof e)(n)):!("spellcheck"===t||"draggable"===t||"translate"===t||"form"===t||"list"===t&&"INPUT"===e.tagName||"type"===t&&"TEXTAREA"===e.tagName||oa.test(t)&&Cs(n))&&t in e}(e,t,o,s))?function(e,t,n,o,s,a,r){if("innerHTML"===t||"textContent"===t)return o&&r(o,s,a),void(e[t]=null==n?"":n);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=n;const o=null==n?"":n;return(e.value!==o||"OPTION"===e.tagName)&&(e.value=o),void(null==n&&e.removeAttribute(t))}let i=!1;if(""===n||null==n){const o=typeof e[t];"boolean"===o?n=Es(n):null==n&&"string"===o?(n="",i=!0):"number"===o&&(n=0,i=!0)}try{e[t]=n}catch{}i&&e.removeAttribute(t)}(e,t,o,a,r,i,l):("true-value"===t?e._trueValue=o:"false-value"===t&&(e._falseValue=o),function(e,t,n,o,s){if(o&&t.startsWith("xlink:"))null==n?e.removeAttributeNS(Gs,t.slice(6,t.length)):e.setAttributeNS(Gs,t,n);else{const o=Rs(t);null==n||o&&!Es(n)?e.removeAttribute(t):e.setAttribute(t,o?"":n)}}(e,t,o,s))}},Vs);let Da;const Ha=(...e)=>{(Da||(Da=Lo(Pa))).render(...e)};var Na=(e,t)=>{const n=e.__vccOpts||e;for(const[e,o]of t)n[e]=o;return n};const $a={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},za=ns("div",{id:"vac-circle"},null,-1),Va=ns("div",{id:"vac-circle"},null,-1),qa=ns("div",{id:"vac-circle"},null,-1),Ua=ns("div",{id:"vac-circle"},null,-1),Xa=ns("div",{id:"vac-circle"},null,-1),Ya=ns("div",{id:"vac-circle"},null,-1);var Ga=Na($a,[["render",function(e,t,n,o,s,a){return Uo(),Zo(la,{name:"vac-fade-spinner",appear:""},{default:tn((()=>[n.show?(Uo(),Ko("div",{key:0,class:Ne(["vac-loader-wrapper",{"vac-container-center":!n.infinite,"vac-container-top":n.infinite}])},["rooms"===n.type?Jn(e.$slots,"spinner-icon-rooms",{key:0},(()=>[za])):is("",!0),"infinite-rooms"===n.type?Jn(e.$slots,"spinner-icon-infinite-rooms",{key:1},(()=>[Va])):is("",!0),"message-file"===n.type?Jn(e.$slots,"spinner-icon-message-file_"+n.messageId,{key:2},(()=>[qa])):is("",!0),"room-file"===n.type?Jn(e.$slots,"spinner-icon-room-file",{key:3},(()=>[Ua])):is("",!0),"messages"===n.type?Jn(e.$slots,"spinner-icon-messages",{key:4},(()=>[Xa])):is("",!0),"infinite-messages"===n.type?Jn(e.$slots,"spinner-icon-infinite-messages",{key:5},(()=>[Ya])):is("",!0)],2)):is("",!0)])),_:3})}]]);const Ka=["viewBox"],Za=["id","d"],Wa=["id","d"];var Qa=Na({name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data:()=>({svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}),computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return"large"===e.size?512:"medium"===e.size?48:24}}},[["render",function(e,t,n,o,s,a){return Uo(),Ko("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${a.size} ${a.size}`},[ns("path",{id:a.svgId,d:s.svgItem[n.name].path},null,8,Za),s.svgItem[n.name].path2?(Uo(),Ko("path",{key:0,id:a.svgId,d:s.svgItem[n.name].path2},null,8,Wa)):is("",!0)],8,Ka)}]]);const Ja={name:"RoomsSearch",components:{SvgIcon:Qa},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},er={key:0,class:"vac-icon-search"},tr=["placeholder"];var nr=Na(Ja,[["render",function(e,t,n,o,s,a){const r=Un("svg-icon");return Uo(),Ko("div",{class:Ne({"vac-box-search":a.showSearchBar,"vac-box-empty":!a.showSearchBar})},[n.showSearch?(Uo(),Ko(Ho,{key:0},[!n.loadingRooms&&n.rooms.length?(Uo(),Ko("div",er,[Jn(e.$slots,"search-icon",{},(()=>[os(r,{name:"search"})]))])):is("",!0),!n.loadingRooms&&n.rooms.length?(Uo(),Ko("input",{key:1,type:"search",placeholder:n.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=t=>e.$emit("search-room",t))},null,40,tr)):is("",!0)],64)):is("",!0),n.showAddRoom?(Uo(),Ko("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=t=>e.$emit("add-room"))},[Jn(e.$slots,"add-icon",{},(()=>[os(r,{name:"add"})]))])):is("",!0)],2)}]]);const or=document.createElement("i");function sr(e){const t="&"+e+";";or.innerHTML=t;const n=or.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&n!==t&&n}function ar(e,t,n,o){const s=e.length;let a,r=0;if(t=t<0?-t>s?0:s+t:t>s?s:t,n=n>0?n:0,o.length<1e4)a=Array.from(o),a.unshift(t,n),e.splice(...a);else for(n&&e.splice(t,n);r<o.length;)a=o.slice(r,r+1e4),a.unshift(t,0),e.splice(...a),r+=1e4,t+=1e4}function rr(e,t){return e.length>0?(ar(e,e.length,0,t),e):t}const ir={}.hasOwnProperty;function lr(e){const t={};let n=-1;for(;++n<e.length;)cr(t,e[n]);return t}function cr(e,t){let n;for(n in t){const o=(ir.call(e,n)?e[n]:void 0)||(e[n]={}),s=t[n];let a;if(s)for(a in s){ir.call(o,a)||(o[a]=[]);const e=s[a];ur(o[a],Array.isArray(e)?e:e?[e]:[])}}}function ur(e,t){let n=-1;const o=[];for(;++n<t.length;)("after"===t[n].add?e:o).push(t[n]);ar(e,0,0,o)}function dr(e){const t={};let n=-1;for(;++n<e.length;)mr(t,e[n]);return t}function mr(e,t){let n;for(n in t){const o=(ir.call(e,n)?e[n]:void 0)||(e[n]={}),s=t[n];let a;if(s)for(a in s)o[a]=s[a]}}const fr={'"':"quot","&":"amp","<":"lt",">":"gt"};function pr(e){return e.replace(/["&<>]/g,(function(e){return"&"+fr[e]+";"}))}function hr(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const gr=Er(/[A-Za-z]/),_r=Er(/[\dA-Za-z]/),vr=Er(/[#-'*+\--9=?A-Z^-~]/);function br(e){return null!==e&&(e<32||127===e)}const xr=Er(/\d/),yr=Er(/[\dA-Fa-f]/),wr=Er(/[!-/:-@[-`{-~]/);function kr(e){return null!==e&&e<-2}function Sr(e){return null!==e&&(e<0||32===e)}function Mr(e){return-2===e||-1===e||32===e}const Ar=Er(/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/),Rr=Er(/\s/);function Er(e){return function(t){return null!==t&&e.test(String.fromCharCode(t))}}function Tr(e,t){const n=pr(function(e){const t=[];let n=-1,o=0,s=0;for(;++n<e.length;){const a=e.charCodeAt(n);let r="";if(37===a&&_r(e.charCodeAt(n+1))&&_r(e.charCodeAt(n+2)))s=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(r=String.fromCharCode(a));else if(a>55295&&a<57344){const t=e.charCodeAt(n+1);a<56320&&t>56319&&t<57344?(r=String.fromCharCode(a,t),s=1):r=""}else r=String.fromCharCode(a);r&&(t.push(e.slice(o,n),encodeURIComponent(r)),o=n+s+1,r=""),s&&(n+=s,s=0)}return t.join("")+e.slice(o)}(e||""));if(!t)return n;const o=n.indexOf(":"),s=n.indexOf("?"),a=n.indexOf("#"),r=n.indexOf("/");return o<0||r>-1&&o>r||s>-1&&o>s||a>-1&&o>a||t.test(n.slice(0,o))?n:""}const Br={}.hasOwnProperty,Ir=/^(https?|ircs?|mailto|xmpp)$/i,Cr=/^https?$/i;function jr(e){const t=e||{};let n=!0;const o={},s=[[]],a=[],r=[],i=dr([{enter:{blockQuote:function(){r.push(!1),b(),g("<blockquote>")},codeFenced:function(){b(),g("<pre><code"),m("fencesCount",0)},codeFencedFenceInfo:p,codeFencedFenceMeta:p,codeIndented:function(){b(),g("<pre><code>")},codeText:function(){m("inCodeText",!0),g("<code>")},content:function(){m("slurpAllLineEndings",!0)},definition:function(){p(),a.push({})},definitionDestinationString:function(){p(),m("ignoreEncode",!0)},definitionLabelString:p,definitionTitleString:p,emphasis:function(){g("<em>")},htmlFlow:function(){b(),R()},htmlText:R,image:function(){a.push({image:!0}),n=void 0},label:p,link:function(){a.push({})},listItemMarker:function(){f("expectFirstItem")?g(">"):y(),b(),g("<li>"),m("expectFirstItem"),m("lastWasTag")},listItemValue:function(e){if(f("expectFirstItem")){const t=Number.parseInt(this.sliceSerialize(e),10);1!==t&&g(' start="'+x(String(t))+'"')}},listOrdered:function(e){r.push(!e._loose),b(),g("<ol"),m("expectFirstItem",!0)},listUnordered:function(e){r.push(!e._loose),b(),g("<ul"),m("expectFirstItem",!0)},paragraph:function(){r[r.length-1]||(b(),g("<p>")),m("slurpAllLineEndings")},reference:p,resource:function(){p(),a[a.length-1].destination=""},resourceDestinationString:function(){p(),m("ignoreEncode",!0)},resourceTitleString:p,setextHeading:function(){p(),m("slurpAllLineEndings")},strong:function(){g("<strong>")}},exit:{atxHeading:function(){g("</h"+f("headingRank")+">"),m("headingRank")},atxHeadingSequence:function(e){f("headingRank")||(m("headingRank",this.sliceSerialize(e).length),b(),g("<h"+f("headingRank")+">"))},autolinkEmail:function(e){const t=this.sliceSerialize(e);g('<a href="'+Tr("mailto:"+t)+'">'),_(x(t)),g("</a>")},autolinkProtocol:function(e){const n=this.sliceSerialize(e);g('<a href="'+Tr(n,t.allowDangerousProtocol?void 0:Ir)+'">'),_(x(n)),g("</a>")},blockQuote:function(){r.pop(),b(),g("</blockquote>"),m("slurpAllLineEndings")},characterEscapeValue:S,characterReferenceMarkerHexadecimal:E,characterReferenceMarkerNumeric:E,characterReferenceValue:function(e){let t=this.sliceSerialize(e);t=f("characterReferenceType")?function(e,t){const n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535==(65535&n)||65534==(65535&n)||n>1114111?"":String.fromCharCode(n)}(t,"characterReferenceMarkerNumeric"===f("characterReferenceType")?10:16):sr(t),_(x(t)),m("characterReferenceType")},codeFenced:w,codeFencedFence:function(){const e=f("fencesCount")||0;e||(g(">"),m("slurpOneLineEnding",!0)),m("fencesCount",e+1)},codeFencedFenceInfo:function(){g(' class="language-'+h()+'"')},codeFencedFenceMeta:h,codeFlowValue:function(e){_(x(this.sliceSerialize(e))),m("flowCodeSeenData",!0)},codeIndented:w,codeText:function(){m("inCodeText"),g("</code>")},codeTextData:S,data:S,definition:function(){const e=hr(a[a.length-1].labelId);h(),Br.call(o,e)||(o[e]=a[a.length-1]),a.pop()},definitionDestinationString:function(){a[a.length-1].destination=h(),m("ignoreEncode")},definitionLabelString:function(e){h(),a[a.length-1].labelId=this.sliceSerialize(e)},definitionTitleString:function(){a[a.length-1].title=h()},emphasis:function(){g("</em>")},hardBreakEscape:M,hardBreakTrailing:M,htmlFlow:A,htmlFlowData:S,htmlText:A,htmlTextData:S,image:k,label:function(){a[a.length-1].label=h()},labelText:function(e){a[a.length-1].labelId=this.sliceSerialize(e)},lineEnding:function(e){if(!f("slurpAllLineEndings")){if(f("slurpOneLineEnding"))return void m("slurpOneLineEnding");if(f("inCodeText"))return void _(" ");_(x(this.sliceSerialize(e)))}},link:k,listOrdered:function(){y(),r.pop(),v(),g("</ol>")},listUnordered:function(){y(),r.pop(),v(),g("</ul>")},paragraph:function(){r[r.length-1]?m("slurpAllLineEndings",!0):g("</p>")},reference:h,referenceString:function(e){a[a.length-1].referenceId=this.sliceSerialize(e)},resource:h,resourceDestinationString:function(){a[a.length-1].destination=h(),m("ignoreEncode")},resourceTitleString:function(){a[a.length-1].title=h()},setextHeading:function(){const e=h();b(),g("<h"+f("headingRank")+">"),_(e),g("</h"+f("headingRank")+">"),m("slurpAllLineEndings"),m("headingRank")},setextHeadingLineSequence:function(e){m("headingRank",61===this.sliceSerialize(e).charCodeAt(0)?1:2)},setextHeadingText:function(){m("slurpAllLineEndings",!0)},strong:function(){g("</strong>")},thematicBreak:function(){b(),g("<hr />")}}}].concat(t.htmlExtensions||[])),l={tightStack:r,definitions:o},c={lineEndingIfNeeded:b,options:t,encode:x,raw:_,tag:g,buffer:p,resume:h,setData:m,getData:f};let u=t.defaultLineEnding;return function(e){let t=-1,n=0;const o=[];let a=[],r=[];for(;++t<e.length;)!u&&("lineEnding"===e[t][1].type||"lineEndingBlank"===e[t][1].type)&&(u=e[t][2].sliceSerialize(e[t][1])),("listOrdered"===e[t][1].type||"listUnordered"===e[t][1].type)&&("enter"===e[t][0]?o.push(t):d(e.slice(o.pop(),t))),"definition"===e[t][1].type&&("enter"===e[t][0]?(r=rr(r,e.slice(n,t)),n=t):(a=rr(a,e.slice(n,t+1)),n=t+1));a=rr(a,r),a=rr(a,e.slice(n)),t=-1;const l=a;for(i.enter.null&&i.enter.null.call(c);++t<e.length;){const e=i[l[t][0]],n=l[t][1].type,o=e[n];Br.call(e,n)&&o&&o.call(Object.assign({sliceSerialize:l[t][2].sliceSerialize},c),l[t][1])}return i.exit.null&&i.exit.null.call(c),s[0].join("")};function d(e){const t=e.length;let n,o=0,s=0,a=!1;for(;++o<t;){const t=e[o];if(t[1]._container)n=void 0,"enter"===t[0]?s++:s--;else switch(t[1].type){case"listItemPrefix":"exit"===t[0]&&(n=!0);break;case"linePrefix":break;case"lineEndingBlank":"enter"===t[0]&&!s&&(n?n=void 0:a=!0);break;default:n=void 0}}e[0][1]._loose=a}function m(e,t){l[e]=t}function f(e){return l[e]}function p(){s.push([])}function h(){return s.pop().join("")}function g(e){!n||(m("lastWasTag",!0),s[s.length-1].push(e))}function _(e){m("lastWasTag"),s[s.length-1].push(e)}function v(){_(u||"\n")}function b(){const e=s[s.length-1],t=e[e.length-1],n=t?t.charCodeAt(t.length-1):null;10===n||13===n||null===n||v()}function x(e){return f("ignoreEncode")?e:pr(e)}function y(){f("lastWasTag")&&!f("slurpAllLineEndings")&&b(),g("</li>"),m("slurpAllLineEndings")}function w(){const e=f("fencesCount");void 0!==e&&e<2&&l.tightStack.length>0&&!f("lastWasTag")&&v(),f("flowCodeSeenData")&&b(),g("</code></pre>"),void 0!==e&&e<2&&b(),m("flowCodeSeenData"),m("fencesCount"),m("slurpOneLineEnding")}function k(){let e=a.length-1;const s=a[e],r=s.referenceId||s.labelId,i=void 0===s.destination?o[hr(r)]:s;for(n=!0;e--;)if(a[e].image){n=void 0;break}s.image?(g('<img src="'+Tr(i.destination,t.allowDangerousProtocol?void 0:Cr)+'" alt="'),_(s.label),g('"')):g('<a href="'+Tr(i.destination,t.allowDangerousProtocol?void 0:Ir)+'"'),g(i.title?' title="'+i.title+'"':""),s.image?g(" />"):(g(">"),_(s.label),g("</a>")),a.pop()}function S(e){_(x(this.sliceSerialize(e)))}function M(){g("<br />")}function A(){m("ignoreEncode")}function R(){t.allowDangerousHtml&&m("ignoreEncode",!0)}function E(e){m("characterReferenceType",e.type)}}function Or(e,t,n,o){const s=o?o-1:Number.POSITIVE_INFINITY;let a=0;return function(o){return Mr(o)?(e.enter(n),r(o)):t(o)};function r(o){return Mr(o)&&a++<s?(e.consume(o),r):(e.exit(n),t(o))}}const Fr={tokenize:function(e){const t=e.attempt(this.parser.constructs.contentInitial,(function(n){if(null===n)return void e.consume(n);return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Or(e,t,"linePrefix")}),(function(t){return e.enter("paragraph"),o(t)}));let n;return t;function o(t){const o=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=o),n=o,s(t)}function s(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):kr(t)?(e.consume(t),e.exit("chunkText"),o):(e.consume(t),s)}}};const Lr={tokenize:function(e){const t=this,n=[];let o,s,a,r=0;return i;function i(o){if(r<n.length){const s=n[r];return t.containerState=s[1],e.attempt(s[0].continuation,l,c)(o)}return c(o)}function l(e){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,o&&v();const n=t.events.length;let s,a=n;for(;a--;)if("exit"===t.events[a][0]&&"chunkFlow"===t.events[a][1].type){s=t.events[a][1].end;break}_(r);let i=n;for(;i<t.events.length;)t.events[i][1].end=Object.assign({},s),i++;return ar(t.events,a+1,0,t.events.slice(n)),t.events.length=i,c(e)}return i(e)}function c(s){if(r===n.length){if(!o)return m(s);if(o.currentConstruct&&o.currentConstruct.concrete)return p(s);t.interrupt=Boolean(o.currentConstruct&&!o._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Pr,u,d)(s)}function u(e){return o&&v(),_(r),m(e)}function d(e){return t.parser.lazy[t.now().line]=r!==n.length,a=t.now().offset,p(e)}function m(n){return t.containerState={},e.attempt(Pr,f,p)(n)}function f(e){return r++,n.push([t.currentConstruct,t.containerState]),m(e)}function p(n){return null===n?(o&&v(),_(0),void e.consume(n)):(o=o||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:s,_tokenizer:o}),h(n))}function h(n){return null===n?(g(e.exit("chunkFlow"),!0),_(0),void e.consume(n)):kr(n)?(e.consume(n),g(e.exit("chunkFlow")),r=0,t.interrupt=void 0,i):(e.consume(n),h)}function g(e,n){const i=t.sliceStream(e);if(n&&i.push(null),e.previous=s,s&&(s.next=e),s=e,o.defineSkip(e.start),o.write(i),t.parser.lazy[e.start.line]){let e=o.events.length;for(;e--;)if(o.events[e][1].start.offset<a&&(!o.events[e][1].end||o.events[e][1].end.offset>a))return;const n=t.events.length;let s,i,l=n;for(;l--;)if("exit"===t.events[l][0]&&"chunkFlow"===t.events[l][1].type){if(s){i=t.events[l][1].end;break}s=!0}for(_(r),e=n;e<t.events.length;)t.events[e][1].end=Object.assign({},i),e++;ar(t.events,l+1,0,t.events.slice(n)),t.events.length=e}}function _(o){let s=n.length;for(;s-- >o;){const o=n[s];t.containerState=o[1],o[0].exit.call(t,e)}n.length=o}function v(){o.write([null]),s=void 0,o=void 0,t.containerState._closeFlow=void 0}}},Pr={tokenize:function(e,t,n){return Or(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};function Dr(e){return null===e||Sr(e)||Rr(e)?1:Ar(e)?2:void 0}function Hr(e,t,n){const o=[];let s=-1;for(;++s<e.length;){const a=e[s].resolveAll;a&&!o.includes(a)&&(t=a(t,n),o.push(a))}return t}const Nr={name:"attention",tokenize:function(e,t){const n=this.parser.constructs.attentionMarkers.null,o=this.previous,s=Dr(o);let a;return function(t){return a=t,e.enter("attentionSequence"),r(t)};function r(i){if(i===a)return e.consume(i),r;const l=e.exit("attentionSequence"),c=Dr(i),u=!c||2===c&&s||n.includes(i),d=!s||2===s&&c||n.includes(o);return l._open=Boolean(42===a?u:u&&(s||!d)),l._close=Boolean(42===a?d:d&&(c||!u)),t(i)}},resolveAll:function(e,t){let n,o,s,a,r,i,l,c,u=-1;for(;++u<e.length;)if("enter"===e[u][0]&&"attentionSequence"===e[u][1].type&&e[u][1]._close)for(n=u;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[u][1]).charCodeAt(0)){if((e[n][1]._close||e[u][1]._open)&&(e[u][1].end.offset-e[u][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[u][1].end.offset-e[u][1].start.offset)%3))continue;i=e[n][1].end.offset-e[n][1].start.offset>1&&e[u][1].end.offset-e[u][1].start.offset>1?2:1;const d=Object.assign({},e[n][1].end),m=Object.assign({},e[u][1].start);$r(d,-i),$r(m,i),a={type:i>1?"strongSequence":"emphasisSequence",start:d,end:Object.assign({},e[n][1].end)},r={type:i>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[u][1].start),end:m},s={type:i>1?"strongText":"emphasisText",start:Object.assign({},e[n][1].end),end:Object.assign({},e[u][1].start)},o={type:i>1?"strong":"emphasis",start:Object.assign({},a.start),end:Object.assign({},r.end)},e[n][1].end=Object.assign({},a.start),e[u][1].start=Object.assign({},r.end),l=[],e[n][1].end.offset-e[n][1].start.offset&&(l=rr(l,[["enter",e[n][1],t],["exit",e[n][1],t]])),l=rr(l,[["enter",o,t],["enter",a,t],["exit",a,t],["enter",s,t]]),l=rr(l,Hr(t.parser.constructs.insideSpan.null,e.slice(n+1,u),t)),l=rr(l,[["exit",s,t],["enter",r,t],["exit",r,t],["exit",o,t]]),e[u][1].end.offset-e[u][1].start.offset?(c=2,l=rr(l,[["enter",e[u][1],t],["exit",e[u][1],t]])):c=0,ar(e,n-1,u-n+3,l),u=n+l.length-c-2;break}for(u=-1;++u<e.length;)"attentionSequence"===e[u][1].type&&(e[u][1].type="data");return e}};function $r(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const zr={name:"autolink",tokenize:function(e,t,n){let o=0;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s};function s(t){return gr(t)?(e.consume(t),a):l(t)}function a(e){return 43===e||45===e||46===e||_r(e)?(o=1,r(e)):l(e)}function r(t){return 58===t?(e.consume(t),o=0,i):(43===t||45===t||46===t||_r(t))&&o++<32?(e.consume(t),r):(o=0,l(t))}function i(o){return 62===o?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(o),e.exit("autolinkMarker"),e.exit("autolink"),t):null===o||32===o||60===o||br(o)?n(o):(e.consume(o),i)}function l(t){return 64===t?(e.consume(t),c):vr(t)?(e.consume(t),l):n(t)}function c(e){return _r(e)?u(e):n(e)}function u(n){return 46===n?(e.consume(n),o=0,c):62===n?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t):d(n)}function d(t){if((45===t||_r(t))&&o++<63){const n=45===t?d:u;return e.consume(t),n}return n(t)}}};const Vr={tokenize:function(e,t,n){return function(t){return Mr(t)?Or(e,o,"linePrefix")(t):o(t)};function o(e){return null===e||kr(e)?t(e):n(e)}},partial:!0};const qr={name:"blockQuote",tokenize:function(e,t,n){const o=this;return function(t){if(62===t){const n=o.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),s}return n(t)};function s(n){return Mr(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}},continuation:{tokenize:function(e,t,n){const o=this;return function(t){return Mr(t)?Or(e,s,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):s(t)};function s(o){return e.attempt(qr,t,n)(o)}}},exit:function(e){e.exit("blockQuote")}};const Ur={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),o};function o(o){return wr(o)?(e.enter("characterEscapeValue"),e.consume(o),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(o)}}};const Xr={name:"characterReference",tokenize:function(e,t,n){const o=this;let s,a,r=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),i};function i(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),l):(e.enter("characterReferenceValue"),s=31,a=_r,c(t))}function l(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,a=yr,c):(e.enter("characterReferenceValue"),s=7,a=xr,c(t))}function c(i){if(59===i&&r){const s=e.exit("characterReferenceValue");return a!==_r||sr(o.sliceSerialize(s))?(e.enter("characterReferenceMarker"),e.consume(i),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(i)}return a(i)&&r++<s?(e.consume(i),c):n(i)}}};const Yr={tokenize:function(e,t,n){const o=this;return function(t){return null===t?n(t):(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s)};function s(e){return o.parser.lazy[o.now().line]?n(e):t(e)}},partial:!0},Gr={name:"codeFenced",tokenize:function(e,t,n){const o=this,s={tokenize:function(e,t,n){let s=0;return r;function r(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l}function l(t){return e.enter("codeFencedFence"),Mr(t)?Or(e,c,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):c(t)}function c(t){return t===a?(e.enter("codeFencedFenceSequence"),u(t)):n(t)}function u(t){return t===a?(s++,e.consume(t),u):s>=i?(e.exit("codeFencedFenceSequence"),Mr(t)?Or(e,d,"whitespace")(t):d(t)):n(t)}function d(o){return null===o||kr(o)?(e.exit("codeFencedFence"),t(o)):n(o)}},partial:!0};let a,r=0,i=0;return function(t){return function(t){const n=o.events[o.events.length-1];return r=n&&"linePrefix"===n[1].type?n[2].sliceSerialize(n[1],!0).length:0,a=t,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),l(t)}(t)};function l(t){return t===a?(i++,e.consume(t),l):i<3?n(t):(e.exit("codeFencedFenceSequence"),Mr(t)?Or(e,c,"whitespace")(t):c(t))}function c(n){return null===n||kr(n)?(e.exit("codeFencedFence"),o.interrupt?t(n):e.check(Yr,f,v)(n)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),u(n))}function u(t){return null===t||kr(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),c(t)):Mr(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Or(e,d,"whitespace")(t)):96===t&&t===a?n(t):(e.consume(t),u)}function d(t){return null===t||kr(t)?c(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),m(t))}function m(t){return null===t||kr(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),c(t)):96===t&&t===a?n(t):(e.consume(t),m)}function f(t){return e.attempt(s,v,p)(t)}function p(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),h}function h(t){return r>0&&Mr(t)?Or(e,g,"linePrefix",r+1)(t):g(t)}function g(t){return null===t||kr(t)?e.check(Yr,f,v)(t):(e.enter("codeFlowValue"),_(t))}function _(t){return null===t||kr(t)?(e.exit("codeFlowValue"),g(t)):(e.consume(t),_)}function v(n){return e.exit("codeFenced"),t(n)}},concrete:!0};const Kr={name:"codeIndented",tokenize:function(e,t,n){const o=this;return function(t){return e.enter("codeIndented"),Or(e,s,"linePrefix",5)(t)};function s(e){const t=o.events[o.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?a(e):n(e)}function a(t){return null===t?i(t):kr(t)?e.attempt(Zr,a,i)(t):(e.enter("codeFlowValue"),r(t))}function r(t){return null===t||kr(t)?(e.exit("codeFlowValue"),a(t)):(e.consume(t),r)}function i(n){return e.exit("codeIndented"),t(n)}}},Zr={tokenize:function(e,t,n){const o=this;return s;function s(t){return o.parser.lazy[o.now().line]?n(t):kr(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s):Or(e,a,"linePrefix",5)(t)}function a(e){const a=o.events[o.events.length-1];return a&&"linePrefix"===a[1].type&&a[2].sliceSerialize(a[1],!0).length>=4?t(e):kr(e)?s(e):n(e)}},partial:!0};const Wr={name:"codeText",tokenize:function(e,t,n){let o,s,a=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),r(t)};function r(t){return 96===t?(e.consume(t),a++,r):(e.exit("codeTextSequence"),i(t))}function i(t){return null===t?n(t):32===t?(e.enter("space"),e.consume(t),e.exit("space"),i):96===t?(s=e.enter("codeTextSequence"),o=0,c(t)):kr(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i):(e.enter("codeTextData"),l(t))}function l(t){return null===t||32===t||96===t||kr(t)?(e.exit("codeTextData"),i(t)):(e.consume(t),l)}function c(n){return 96===n?(e.consume(n),o++,c):o===a?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(s.type="codeTextData",l(n))}},resolve:function(e){let t,n,o=e.length-4,s=3;if(!("lineEnding"!==e[s][1].type&&"space"!==e[s][1].type||"lineEnding"!==e[o][1].type&&"space"!==e[o][1].type))for(t=s;++t<o;)if("codeTextData"===e[t][1].type){e[s][1].type="codeTextPadding",e[o][1].type="codeTextPadding",s+=2,o-=2;break}for(t=s-1,o++;++t<=o;)void 0===n?t!==o&&"lineEnding"!==e[t][1].type&&(n=t):(t===o||"lineEnding"===e[t][1].type)&&(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),o-=t-n-2,t=n+2),n=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};function Qr(e){const t={};let n,o,s,a,r,i,l,c=-1;for(;++c<e.length;){for(;c in t;)c=t[c];if(n=e[c],c&&"chunkFlow"===n[1].type&&"listItemPrefix"===e[c-1][1].type&&(i=n[1]._tokenizer.events,s=0,s<i.length&&"lineEndingBlank"===i[s][1].type&&(s+=2),s<i.length&&"content"===i[s][1].type))for(;++s<i.length&&"content"!==i[s][1].type;)"chunkText"===i[s][1].type&&(i[s][1]._isInFirstContentOfListItem=!0,s++);if("enter"===n[0])n[1].contentType&&(Object.assign(t,Jr(e,c)),c=t[c],l=!0);else if(n[1]._container){for(s=c,o=void 0;s--&&(a=e[s],"lineEnding"===a[1].type||"lineEndingBlank"===a[1].type);)"enter"===a[0]&&(o&&(e[o][1].type="lineEndingBlank"),a[1].type="lineEnding",o=s);o&&(n[1].end=Object.assign({},e[o][1].start),r=e.slice(o,c),r.unshift(n),ar(e,o,c-o+1,r))}}return!l}function Jr(e,t){const n=e[t][1],o=e[t][2];let s=t-1;const a=[],r=n._tokenizer||o.parser[n.contentType](n.start),i=r.events,l=[],c={};let u,d,m=-1,f=n,p=0,h=0;const g=[h];for(;f;){for(;e[++s][1]!==f;);a.push(s),f._tokenizer||(u=o.sliceStream(f),f.next||u.push(null),d&&r.defineSkip(f.start),f._isInFirstContentOfListItem&&(r._gfmTasklistFirstContentOfListItem=!0),r.write(u),f._isInFirstContentOfListItem&&(r._gfmTasklistFirstContentOfListItem=void 0)),d=f,f=f.next}for(f=n;++m<i.length;)"exit"===i[m][0]&&"enter"===i[m-1][0]&&i[m][1].type===i[m-1][1].type&&i[m][1].start.line!==i[m][1].end.line&&(h=m+1,g.push(h),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(r.events=[],f?(f._tokenizer=void 0,f.previous=void 0):g.pop(),m=g.length;m--;){const t=i.slice(g[m],g[m+1]),n=a.pop();l.unshift([n,n+t.length-1]),ar(e,n,2,t)}for(m=-1;++m<l.length;)c[p+l[m][0]]=p+l[m][1],p+=l[m][1]-l[m][0]-1;return c}const ei={tokenize:function(e,t){let n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),o(t)};function o(t){return null===t?s(t):kr(t)?e.check(ti,a,s)(t):(e.consume(t),o)}function s(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function a(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,o}},resolve:function(e){return Qr(e),e}},ti={tokenize:function(e,t,n){const o=this;return function(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Or(e,s,"linePrefix")};function s(s){if(null===s||kr(s))return n(s);const a=o.events[o.events.length-1];return!o.parser.constructs.disable.null.includes("codeIndented")&&a&&"linePrefix"===a[1].type&&a[2].sliceSerialize(a[1],!0).length>=4?t(s):e.interrupt(o.parser.constructs.flow,n,t)(s)}},partial:!0};function ni(e,t,n,o,s,a,r,i,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return function(t){return 60===t?(e.enter(o),e.enter(s),e.enter(a),e.consume(t),e.exit(a),d):null===t||32===t||41===t||br(t)?n(t):(e.enter(o),e.enter(r),e.enter(i),e.enter("chunkString",{contentType:"string"}),p(t))};function d(n){return 62===n?(e.enter(a),e.consume(n),e.exit(a),e.exit(s),e.exit(o),t):(e.enter(i),e.enter("chunkString",{contentType:"string"}),m(n))}function m(t){return 62===t?(e.exit("chunkString"),e.exit(i),d(t)):null===t||60===t||kr(t)?n(t):(e.consume(t),92===t?f:m)}function f(t){return 60===t||62===t||92===t?(e.consume(t),m):m(t)}function p(s){return u||null!==s&&41!==s&&!Sr(s)?u<c&&40===s?(e.consume(s),u++,p):41===s?(e.consume(s),u--,p):null===s||32===s||40===s||br(s)?n(s):(e.consume(s),92===s?h:p):(e.exit("chunkString"),e.exit(i),e.exit(r),e.exit(o),t(s))}function h(t){return 40===t||41===t||92===t?(e.consume(t),p):p(t)}}function oi(e,t,n,o,s,a){const r=this;let i,l=0;return function(t){return e.enter(o),e.enter(s),e.consume(t),e.exit(s),e.enter(a),c};function c(d){return l>999||null===d||91===d||93===d&&!i||94===d&&!l&&"_hiddenFootnoteSupport"in r.parser.constructs?n(d):93===d?(e.exit(a),e.enter(s),e.consume(d),e.exit(s),e.exit(o),t):kr(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),u(d))}function u(t){return null===t||91===t||93===t||kr(t)||l++>999?(e.exit("chunkString"),c(t)):(e.consume(t),i||(i=!Mr(t)),92===t?d:u)}function d(t){return 91===t||92===t||93===t?(e.consume(t),l++,u):u(t)}}function si(e,t,n,o,s,a){let r;return function(t){return 34===t||39===t||40===t?(e.enter(o),e.enter(s),e.consume(t),e.exit(s),r=40===t?41:t,i):n(t)};function i(n){return n===r?(e.enter(s),e.consume(n),e.exit(s),e.exit(o),t):(e.enter(a),l(n))}function l(t){return t===r?(e.exit(a),i(r)):null===t?n(t):kr(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Or(e,l,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(t))}function c(t){return t===r||null===t||kr(t)?(e.exit("chunkString"),l(t)):(e.consume(t),92===t?u:c)}function u(t){return t===r||92===t?(e.consume(t),c):c(t)}}function ai(e,t){let n;return function o(s){return kr(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n=!0,o):Mr(s)?Or(e,o,n?"linePrefix":"lineSuffix")(s):t(s)}}const ri={name:"definition",tokenize:function(e,t,n){const o=this;let s;return function(t){return e.enter("definition"),function(t){return oi.call(o,e,a,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)}(t)};function a(t){return s=hr(o.sliceSerialize(o.events[o.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),r):n(t)}function r(t){return Sr(t)?ai(e,i)(t):i(t)}function i(t){return ni(e,l,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(t)}function l(t){return e.attempt(ii,c,c)(t)}function c(t){return Mr(t)?Or(e,u,"whitespace")(t):u(t)}function u(a){return null===a||kr(a)?(e.exit("definition"),o.parser.defined.push(s),t(a)):n(a)}}},ii={tokenize:function(e,t,n){return function(t){return Sr(t)?ai(e,o)(t):n(t)};function o(t){return si(e,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t)}function s(t){return Mr(t)?Or(e,a,"whitespace")(t):a(t)}function a(e){return null===e||kr(e)?t(e):n(e)}},partial:!0};const li={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.consume(t),o};function o(o){return kr(o)?(e.exit("hardBreakEscape"),t(o)):n(o)}}};const ci={name:"headingAtx",tokenize:function(e,t,n){let o=0;return function(t){return e.enter("atxHeading"),function(t){return e.enter("atxHeadingSequence"),s(t)}(t)};function s(t){return 35===t&&o++<6?(e.consume(t),s):null===t||Sr(t)?(e.exit("atxHeadingSequence"),a(t)):n(t)}function a(n){return 35===n?(e.enter("atxHeadingSequence"),r(n)):null===n||kr(n)?(e.exit("atxHeading"),t(n)):Mr(n)?Or(e,a,"whitespace")(n):(e.enter("atxHeadingText"),i(n))}function r(t){return 35===t?(e.consume(t),r):(e.exit("atxHeadingSequence"),a(t))}function i(t){return null===t||35===t||Sr(t)?(e.exit("atxHeadingText"),a(t)):(e.consume(t),i)}},resolve:function(e,t){let n,o,s=e.length-2,a=3;return"whitespace"===e[a][1].type&&(a+=2),s-2>a&&"whitespace"===e[s][1].type&&(s-=2),"atxHeadingSequence"===e[s][1].type&&(a===s-1||s-4>a&&"whitespace"===e[s-2][1].type)&&(s-=a+1===s?2:4),s>a&&(n={type:"atxHeadingText",start:e[a][1].start,end:e[s][1].end},o={type:"chunkText",start:e[a][1].start,end:e[s][1].end,contentType:"text"},ar(e,a,s-a+1,[["enter",n,t],["enter",o,t],["exit",o,t],["exit",n,t]])),e}};const ui=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],di=["pre","script","style","textarea"],mi={name:"htmlFlow",tokenize:function(e,t,n){const o=this;let s,a,r,i,l;return function(t){return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),c}(t)};function c(i){return 33===i?(e.consume(i),u):47===i?(e.consume(i),a=!0,f):63===i?(e.consume(i),s=3,o.interrupt?t:O):gr(i)?(e.consume(i),r=String.fromCharCode(i),p):n(i)}function u(a){return 45===a?(e.consume(a),s=2,d):91===a?(e.consume(a),s=5,i=0,m):gr(a)?(e.consume(a),s=4,o.interrupt?t:O):n(a)}function d(s){return 45===s?(e.consume(s),o.interrupt?t:O):n(s)}function m(s){const a="CDATA[";return s===a.charCodeAt(i++)?(e.consume(s),6===i?o.interrupt?t:A:m):n(s)}function f(t){return gr(t)?(e.consume(t),r=String.fromCharCode(t),p):n(t)}function p(i){if(null===i||47===i||62===i||Sr(i)){const l=47===i,c=r.toLowerCase();return l||a||!di.includes(c)?ui.includes(r.toLowerCase())?(s=6,l?(e.consume(i),h):o.interrupt?t(i):A(i)):(s=7,o.interrupt&&!o.parser.lazy[o.now().line]?n(i):a?g(i):_(i)):(s=1,o.interrupt?t(i):A(i))}return 45===i||_r(i)?(e.consume(i),r+=String.fromCharCode(i),p):n(i)}function h(s){return 62===s?(e.consume(s),o.interrupt?t:A):n(s)}function g(t){return Mr(t)?(e.consume(t),g):S(t)}function _(t){return 47===t?(e.consume(t),S):58===t||95===t||gr(t)?(e.consume(t),v):Mr(t)?(e.consume(t),_):S(t)}function v(t){return 45===t||46===t||58===t||95===t||_r(t)?(e.consume(t),v):b(t)}function b(t){return 61===t?(e.consume(t),x):Mr(t)?(e.consume(t),b):_(t)}function x(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,y):Mr(t)?(e.consume(t),x):w(t)}function y(t){return t===l?(e.consume(t),l=null,k):null===t||kr(t)?n(t):(e.consume(t),y)}function w(t){return null===t||34===t||39===t||47===t||60===t||61===t||62===t||96===t||Sr(t)?b(t):(e.consume(t),w)}function k(e){return 47===e||62===e||Mr(e)?_(e):n(e)}function S(t){return 62===t?(e.consume(t),M):n(t)}function M(t){return null===t||kr(t)?A(t):Mr(t)?(e.consume(t),M):n(t)}function A(t){return 45===t&&2===s?(e.consume(t),B):60===t&&1===s?(e.consume(t),I):62===t&&4===s?(e.consume(t),F):63===t&&3===s?(e.consume(t),O):93===t&&5===s?(e.consume(t),j):!kr(t)||6!==s&&7!==s?null===t||kr(t)?(e.exit("htmlFlowData"),R(t)):(e.consume(t),A):(e.exit("htmlFlowData"),e.check(fi,L,R)(t))}function R(t){return e.check(pi,E,L)(t)}function E(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),T}function T(t){return null===t||kr(t)?R(t):(e.enter("htmlFlowData"),A(t))}function B(t){return 45===t?(e.consume(t),O):A(t)}function I(t){return 47===t?(e.consume(t),r="",C):A(t)}function C(t){if(62===t){const n=r.toLowerCase();return di.includes(n)?(e.consume(t),F):A(t)}return gr(t)&&r.length<8?(e.consume(t),r+=String.fromCharCode(t),C):A(t)}function j(t){return 93===t?(e.consume(t),O):A(t)}function O(t){return 62===t?(e.consume(t),F):45===t&&2===s?(e.consume(t),O):A(t)}function F(t){return null===t||kr(t)?(e.exit("htmlFlowData"),L(t)):(e.consume(t),F)}function L(n){return e.exit("htmlFlow"),t(n)}},resolveTo:function(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},concrete:!0},fi={tokenize:function(e,t,n){return function(o){return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),e.attempt(Vr,t,n)}},partial:!0},pi={tokenize:function(e,t,n){const o=this;return function(t){return kr(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s):n(t)};function s(e){return o.parser.lazy[o.now().line]?n(e):t(e)}},partial:!0};const hi={name:"htmlText",tokenize:function(e,t,n){const o=this;let s,a,r;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),i};function i(t){return 33===t?(e.consume(t),l):47===t?(e.consume(t),x):63===t?(e.consume(t),v):gr(t)?(e.consume(t),k):n(t)}function l(t){return 45===t?(e.consume(t),c):91===t?(e.consume(t),a=0,f):gr(t)?(e.consume(t),_):n(t)}function c(t){return 45===t?(e.consume(t),m):n(t)}function u(t){return null===t?n(t):45===t?(e.consume(t),d):kr(t)?(r=u,C(t)):(e.consume(t),u)}function d(t){return 45===t?(e.consume(t),m):u(t)}function m(e){return 62===e?I(e):45===e?d(e):u(e)}function f(t){const o="CDATA[";return t===o.charCodeAt(a++)?(e.consume(t),6===a?p:f):n(t)}function p(t){return null===t?n(t):93===t?(e.consume(t),h):kr(t)?(r=p,C(t)):(e.consume(t),p)}function h(t){return 93===t?(e.consume(t),g):p(t)}function g(t){return 62===t?I(t):93===t?(e.consume(t),g):p(t)}function _(t){return null===t||62===t?I(t):kr(t)?(r=_,C(t)):(e.consume(t),_)}function v(t){return null===t?n(t):63===t?(e.consume(t),b):kr(t)?(r=v,C(t)):(e.consume(t),v)}function b(e){return 62===e?I(e):v(e)}function x(t){return gr(t)?(e.consume(t),y):n(t)}function y(t){return 45===t||_r(t)?(e.consume(t),y):w(t)}function w(t){return kr(t)?(r=w,C(t)):Mr(t)?(e.consume(t),w):I(t)}function k(t){return 45===t||_r(t)?(e.consume(t),k):47===t||62===t||Sr(t)?S(t):n(t)}function S(t){return 47===t?(e.consume(t),I):58===t||95===t||gr(t)?(e.consume(t),M):kr(t)?(r=S,C(t)):Mr(t)?(e.consume(t),S):I(t)}function M(t){return 45===t||46===t||58===t||95===t||_r(t)?(e.consume(t),M):A(t)}function A(t){return 61===t?(e.consume(t),R):kr(t)?(r=A,C(t)):Mr(t)?(e.consume(t),A):S(t)}function R(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),s=t,E):kr(t)?(r=R,C(t)):Mr(t)?(e.consume(t),R):(e.consume(t),T)}function E(t){return t===s?(e.consume(t),s=void 0,B):null===t?n(t):kr(t)?(r=E,C(t)):(e.consume(t),E)}function T(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):47===t||62===t||Sr(t)?S(t):(e.consume(t),T)}function B(e){return 47===e||62===e||Sr(e)?S(e):n(e)}function I(o){return 62===o?(e.consume(o),e.exit("htmlTextData"),e.exit("htmlText"),t):n(o)}function C(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),j}function j(t){return Mr(t)?Or(e,O,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):O(t)}function O(t){return e.enter("htmlTextData"),r(t)}}};const gi={name:"labelEnd",tokenize:function(e,t,n){const o=this;let s,a,r=o.events.length;for(;r--;)if(("labelImage"===o.events[r][1].type||"labelLink"===o.events[r][1].type)&&!o.events[r][1]._balanced){s=o.events[r][1];break}return function(t){return s?s._inactive?u(t):(a=o.parser.defined.includes(hr(o.sliceSerialize({start:s.end,end:o.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),i):n(t)};function i(t){return 40===t?e.attempt(_i,c,a?c:u)(t):91===t?e.attempt(vi,c,a?l:u)(t):a?c(t):u(t)}function l(t){return e.attempt(bi,c,u)(t)}function c(e){return t(e)}function u(e){return s._balanced=!0,n(e)}},resolveTo:function(e,t){let n,o,s,a,r=e.length,i=0;for(;r--;)if(n=e[r][1],o){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[r][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(s){if("enter"===e[r][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(o=r,"labelLink"!==n.type)){i=2;break}}else"labelEnd"===n.type&&(s=r);const l={type:"labelLink"===e[o][1].type?"link":"image",start:Object.assign({},e[o][1].start),end:Object.assign({},e[e.length-1][1].end)},c={type:"label",start:Object.assign({},e[o][1].start),end:Object.assign({},e[s][1].end)},u={type:"labelText",start:Object.assign({},e[o+i+2][1].end),end:Object.assign({},e[s-2][1].start)};return a=[["enter",l,t],["enter",c,t]],a=rr(a,e.slice(o+1,o+i+3)),a=rr(a,[["enter",u,t]]),a=rr(a,Hr(t.parser.constructs.insideSpan.null,e.slice(o+i+4,s-3),t)),a=rr(a,[["exit",u,t],e[s-2],e[s-1],["exit",c,t]]),a=rr(a,e.slice(s+1)),a=rr(a,[["exit",l,t]]),ar(e,o,e.length,a),e},resolveAll:function(e){let t=-1;for(;++t<e.length;){const n=e[t][1];("labelImage"===n.type||"labelLink"===n.type||"labelEnd"===n.type)&&(e.splice(t+1,"labelImage"===n.type?4:2),n.type="data",t++)}return e}},_i={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),o};function o(t){return Sr(t)?ai(e,s)(t):s(t)}function s(t){return 41===t?c(t):ni(e,a,r,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function a(t){return Sr(t)?ai(e,i)(t):c(t)}function r(e){return n(e)}function i(t){return 34===t||39===t||40===t?si(e,l,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):c(t)}function l(t){return Sr(t)?ai(e,c)(t):c(t)}function c(o){return 41===o?(e.enter("resourceMarker"),e.consume(o),e.exit("resourceMarker"),e.exit("resource"),t):n(o)}}},vi={tokenize:function(e,t,n){const o=this;return function(t){return oi.call(o,e,s,a,"reference","referenceMarker","referenceString")(t)};function s(e){return o.parser.defined.includes(hr(o.sliceSerialize(o.events[o.events.length-1][1]).slice(1,-1)))?t(e):n(e)}function a(e){return n(e)}}},bi={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),o};function o(o){return 93===o?(e.enter("referenceMarker"),e.consume(o),e.exit("referenceMarker"),e.exit("reference"),t):n(o)}}};const xi={name:"labelStartImage",tokenize:function(e,t,n){const o=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),s};function s(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),a):n(t)}function a(e){return 94===e&&"_hiddenFootnoteSupport"in o.parser.constructs?n(e):t(e)}},resolveAll:gi.resolveAll};const yi={name:"labelStartLink",tokenize:function(e,t,n){const o=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),s};function s(e){return 94===e&&"_hiddenFootnoteSupport"in o.parser.constructs?n(e):t(e)}},resolveAll:gi.resolveAll};const wi={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Or(e,t,"linePrefix")}}};const ki={name:"thematicBreak",tokenize:function(e,t,n){let o,s=0;return function(t){return e.enter("thematicBreak"),function(e){return o=e,a(e)}(t)};function a(a){return a===o?(e.enter("thematicBreakSequence"),r(a)):s>=3&&(null===a||kr(a))?(e.exit("thematicBreak"),t(a)):n(a)}function r(t){return t===o?(e.consume(t),s++,r):(e.exit("thematicBreakSequence"),Mr(t)?Or(e,a,"whitespace")(t):a(t))}}};const Si={name:"list",tokenize:function(e,t,n){const o=this,s=o.events[o.events.length-1];let a=s&&"linePrefix"===s[1].type?s[2].sliceSerialize(s[1],!0).length:0,r=0;return function(t){const s=o.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===s?!o.containerState.marker||t===o.containerState.marker:xr(t)){if(o.containerState.type||(o.containerState.type=s,e.enter(s,{_container:!0})),"listUnordered"===s)return e.enter("listItemPrefix"),42===t||45===t?e.check(ki,n,l)(t):l(t);if(!o.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),i(t)}return n(t)};function i(t){return xr(t)&&++r<10?(e.consume(t),i):(!o.interrupt||r<2)&&(o.containerState.marker?t===o.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),l(t)):n(t)}function l(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),o.containerState.marker=o.containerState.marker||t,e.check(Vr,o.interrupt?n:c,e.attempt(Mi,d,u))}function c(e){return o.containerState.initialBlankLine=!0,a++,d(e)}function u(t){return Mr(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),d):n(t)}function d(n){return o.containerState.size=a+o.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}},continuation:{tokenize:function(e,t,n){const o=this;return o.containerState._closeFlow=void 0,e.check(Vr,(function(n){return o.containerState.furtherBlankLines=o.containerState.furtherBlankLines||o.containerState.initialBlankLine,Or(e,t,"listItemIndent",o.containerState.size+1)(n)}),(function(n){return o.containerState.furtherBlankLines||!Mr(n)?(o.containerState.furtherBlankLines=void 0,o.containerState.initialBlankLine=void 0,s(n)):(o.containerState.furtherBlankLines=void 0,o.containerState.initialBlankLine=void 0,e.attempt(Ai,t,s)(n))}));function s(s){return o.containerState._closeFlow=!0,o.interrupt=void 0,Or(e,e.attempt(Si,t,n),"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}},exit:function(e){e.exit(this.containerState.type)}},Mi={tokenize:function(e,t,n){const o=this;return Or(e,(function(e){const s=o.events[o.events.length-1];return!Mr(e)&&s&&"listItemPrefixWhitespace"===s[1].type?t(e):n(e)}),"listItemPrefixWhitespace",o.parser.constructs.disable.null.includes("codeIndented")?void 0:5)},partial:!0},Ai={tokenize:function(e,t,n){const o=this;return Or(e,(function(e){const s=o.events[o.events.length-1];return s&&"listItemIndent"===s[1].type&&s[2].sliceSerialize(s[1],!0).length===o.containerState.size?t(e):n(e)}),"listItemIndent",o.containerState.size+1)},partial:!0};const Ri={name:"setextUnderline",tokenize:function(e,t,n){const o=this;let s;return function(t){let r,i=o.events.length;for(;i--;)if("lineEnding"!==o.events[i][1].type&&"linePrefix"!==o.events[i][1].type&&"content"!==o.events[i][1].type){r="paragraph"===o.events[i][1].type;break}return o.parser.lazy[o.now().line]||!o.interrupt&&!r?n(t):(e.enter("setextHeadingLine"),s=t,function(t){return e.enter("setextHeadingLineSequence"),a(t)}(t))};function a(t){return t===s?(e.consume(t),a):(e.exit("setextHeadingLineSequence"),Mr(t)?Or(e,r,"lineSuffix")(t):r(t))}function r(o){return null===o||kr(o)?(e.exit("setextHeadingLine"),t(o)):n(o)}},resolveTo:function(e,t){let n,o,s,a=e.length;for(;a--;)if("enter"===e[a][0]){if("content"===e[a][1].type){n=a;break}"paragraph"===e[a][1].type&&(o=a)}else"content"===e[a][1].type&&e.splice(a,1),!s&&"definition"===e[a][1].type&&(s=a);const r={type:"setextHeading",start:Object.assign({},e[o][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[o][1].type="setextHeadingText",s?(e.splice(o,0,["enter",r,t]),e.splice(s+1,0,["exit",e[n][1],t]),e[n][1].end=Object.assign({},e[s][1].end)):e[n][1]=r,e.push(["exit",r,t]),e}};const Ei={tokenize:function(e){const t=this,n=e.attempt(Vr,(function(o){if(null===o)return void e.consume(o);return e.enter("lineEndingBlank"),e.consume(o),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}),e.attempt(this.parser.constructs.flowInitial,o,Or(e,e.attempt(this.parser.constructs.flow,o,e.attempt(ei,o)),"linePrefix")));return n;function o(o){if(null!==o)return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(o)}}};const Ti={resolveAll:ji()},Bi=Ci("string"),Ii=Ci("text");function Ci(e){return{tokenize:function(t){const n=this,o=this.parser.constructs[e],s=t.attempt(o,a,r);return a;function a(e){return l(e)?s(e):r(e)}function r(e){if(null!==e)return t.enter("data"),t.consume(e),i;t.consume(e)}function i(e){return l(e)?(t.exit("data"),s(e)):(t.consume(e),i)}function l(e){if(null===e)return!0;const t=o[e];let s=-1;if(t)for(;++s<t.length;){const e=t[s];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}},resolveAll:ji("text"===e?Oi:void 0)}}function ji(e){return function(t,n){let o,s=-1;for(;++s<=t.length;)void 0===o?t[s]&&"data"===t[s][1].type&&(o=s,s++):(!t[s]||"data"!==t[s][1].type)&&(s!==o+2&&(t[o][1].end=t[s-1][1].end,t.splice(o+2,s-o-2),s=o+2),o=void 0);return e?e(t,n):t}}function Oi(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){const o=e[n-1][1],s=t.sliceStream(o);let a,r=s.length,i=-1,l=0;for(;r--;){const e=s[r];if("string"==typeof e){for(i=e.length;32===e.charCodeAt(i-1);)l++,i--;if(i)break;i=-1}else if(-2===e)a=!0,l++;else if(-1!==e){r++;break}}if(l){const s={type:n===e.length||a||l<2?"lineSuffix":"hardBreakTrailing",start:{line:o.end.line,column:o.end.column-l,offset:o.end.offset-l,_index:o.start._index+r,_bufferIndex:r?i:o.start._bufferIndex+i},end:Object.assign({},o.end)};o.end=Object.assign({},s.start),o.start.offset===o.end.offset?Object.assign(o,s):(e.splice(n,0,["enter",s,t],["exit",s,t]),n+=2)}n++}return e}function Fi(e,t,n){let o=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const s={},a=[];let r=[],i=[];const l={consume:function(e){kr(e)?(o.line++,o.column=1,o.offset+=-3===e?2:1,_()):-1!==e&&(o.column++,o.offset++),o._bufferIndex<0?o._index++:(o._bufferIndex++,o._bufferIndex===r[o._index].length&&(o._bufferIndex=-1,o._index++)),c.previous=e},enter:function(e,t){const n=t||{};return n.type=e,n.start=m(),c.events.push(["enter",n,c]),i.push(n),n},exit:function(e){const t=i.pop();return t.end=m(),c.events.push(["exit",t,c]),t},attempt:h((function(e,t){g(e,t.from)})),check:h(p),interrupt:h(p,{interrupt:!0})},c={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:d,sliceSerialize:function(e,t){return function(e,t){let n=-1;const o=[];let s;for(;++n<e.length;){const a=e[n];let r;if("string"==typeof a)r=a;else switch(a){case-5:r="\r";break;case-4:r="\n";break;case-3:r="\r\n";break;case-2:r=t?" ":"\t";break;case-1:if(!t&&s)continue;r=" ";break;default:r=String.fromCharCode(a)}s=-2===a,o.push(r)}return o.join("")}(d(e),t)},now:m,defineSkip:function(e){s[e.line]=e.column,_()},write:function(e){return r=rr(r,e),function(){let e;for(;o._index<r.length;){const t=r[o._index];if("string"==typeof t)for(e=o._index,o._bufferIndex<0&&(o._bufferIndex=0);o._index===e&&o._bufferIndex<t.length;)f(t.charCodeAt(o._bufferIndex));else f(t)}}(),null!==r[r.length-1]?[]:(g(t,0),c.events=Hr(a,c.events,c),c.events)}};let u=t.tokenize.call(c,l);return t.resolveAll&&a.push(t),c;function d(e){return function(e,t){const n=t.start._index,o=t.start._bufferIndex,s=t.end._index,a=t.end._bufferIndex;let r;if(n===s)r=[e[n].slice(o,a)];else{if(r=e.slice(n,s),o>-1){const e=r[0];"string"==typeof e?r[0]=e.slice(o):r.shift()}a>0&&r.push(e[s].slice(0,a))}return r}(r,e)}function m(){const{line:e,column:t,offset:n,_index:s,_bufferIndex:a}=o;return{line:e,column:t,offset:n,_index:s,_bufferIndex:a}}function f(e){u=u(e)}function p(e,t){t.restore()}function h(e,t){return function(n,s,a){let r,u,d,f;return Array.isArray(n)?p(n):"tokenize"in n?p([n]):function(e){return t;function t(t){const n=null!==t&&e[t],o=null!==t&&e.null;return p([...Array.isArray(n)?n:n?[n]:[],...Array.isArray(o)?o:o?[o]:[]])(t)}}(n);function p(e){return r=e,u=0,0===e.length?a:h(e[u])}function h(e){return function(n){return f=function(){const e=m(),t=c.previous,n=c.currentConstruct,s=c.events.length,a=Array.from(i);return{restore:r,from:s};function r(){o=e,c.previous=t,c.currentConstruct=n,c.events.length=s,i=a,_()}}(),d=e,e.partial||(c.currentConstruct=e),e.name&&c.parser.constructs.disable.null.includes(e.name)?v():e.tokenize.call(t?Object.assign(Object.create(c),t):c,l,g,v)(n)}}function g(t){return e(d,f),s}function v(e){return f.restore(),++u<r.length?h(r[u]):a}}}function g(e,t){e.resolveAll&&!a.includes(e)&&a.push(e),e.resolve&&ar(c.events,t,c.events.length-t,e.resolve(c.events.slice(t),c)),e.resolveTo&&(c.events=e.resolveTo(c.events,c))}function _(){o.line in s&&o.column<2&&(o.column=s[o.line],o.offset+=s[o.line]-1)}}var Li=Object.freeze(Object.defineProperty({__proto__:null,document:{42:Si,43:Si,45:Si,48:Si,49:Si,50:Si,51:Si,52:Si,53:Si,54:Si,55:Si,56:Si,57:Si,62:qr},contentInitial:{91:ri},flowInitial:{[-2]:Kr,[-1]:Kr,32:Kr},flow:{35:ci,42:ki,45:[Ri,ki],60:mi,61:Ri,95:ki,96:Gr,126:Gr},string:{38:Xr,92:Ur},text:{[-5]:wi,[-4]:wi,[-3]:wi,33:xi,38:Xr,42:Nr,60:[zr,hi],91:yi,92:[li,Ur],93:gi,95:Nr,96:Wr},insideSpan:{null:[Nr,Ti]},attentionMarkers:{null:[42,95]},disable:{null:[]}},Symbol.toStringTag,{value:"Module"}));const Pi=/[\0\t\n\r]/g;function Di(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),jr(n)(function(e){for(;!Qr(e););return e}(function(e){const t={defined:[],lazy:{},constructs:lr([Li,...(e||{}).extensions||[]]),content:n(Fr),document:n(Lr),flow:n(Ei),string:n(Bi),text:n(Ii)};return t;function n(e){return function(n){return Fi(t,e,n)}}}(n).document().write(function(){let e,t=1,n="",o=!0;return function(s,a,r){const i=[];let l,c,u,d,m;for(s=n+s.toString(a),u=0,n="",o&&(65279===s.charCodeAt(0)&&u++,o=void 0);u<s.length;){if(Pi.lastIndex=u,l=Pi.exec(s),d=l&&void 0!==l.index?l.index:s.length,m=s.charCodeAt(d),!l){n=s.slice(u);break}if(10===m&&u===d&&e)i.push(-3),e=void 0;else switch(e&&(i.push(-5),e=void 0),u<d&&(i.push(s.slice(u,d)),t+=d-u),m){case 0:i.push(65533),t++;break;case 9:for(c=4*Math.ceil(t/4),i.push(-2);t++<c;)i.push(-1);break;case 10:i.push(-4),t=1;break;default:e=!0,t=1}u=d+1}return r&&(e&&i.push(-5),n&&i.push(n),i.push(null)),i}}()(e,t,!0))))}const Hi={tokenize:function(e,t,n){let o=0;return function t(a){return(87===a||119===a)&&o<3?(o++,e.consume(a),t):46===a&&3===o?(e.consume(a),s):n(a)};function s(e){return null===e?n(e):t(e)}},partial:!0},Ni={tokenize:function(e,t,n){let o,s,a;return r;function r(t){return 46===t||95===t?e.check(zi,l,i)(t):null===t||Sr(t)||Rr(t)||45!==t&&Ar(t)?l(t):(a=!0,e.consume(t),r)}function i(t){return 95===t?o=!0:(s=o,o=void 0),e.consume(t),r}function l(e){return s||o||!a?n(e):t(e)}},partial:!0},$i={tokenize:function(e,t){let n=0,o=0;return s;function s(r){return 40===r?(n++,e.consume(r),s):41===r&&o<n?a(r):33===r||34===r||38===r||39===r||41===r||42===r||44===r||46===r||58===r||59===r||60===r||63===r||93===r||95===r||126===r?e.check(zi,t,a)(r):null===r||Sr(r)||Rr(r)?t(r):(e.consume(r),s)}function a(t){return 41===t&&o++,e.consume(t),s}},partial:!0},zi={tokenize:function(e,t,n){return o;function o(r){return 33===r||34===r||39===r||41===r||42===r||44===r||46===r||58===r||59===r||63===r||95===r||126===r?(e.consume(r),o):38===r?(e.consume(r),a):93===r?(e.consume(r),s):60===r||null===r||Sr(r)||Rr(r)?t(r):n(r)}function s(e){return null===e||40===e||91===e||Sr(e)||Rr(e)?t(e):o(e)}function a(e){return gr(e)?r(e):n(e)}function r(t){return 59===t?(e.consume(t),o):gr(t)?(e.consume(t),r):n(t)}},partial:!0},Vi={tokenize:function(e,t,n){return function(t){return e.consume(t),o};function o(e){return _r(e)?n(e):t(e)}},partial:!0},qi={tokenize:function(e,t,n){const o=this;return function(t){return 87!==t&&119!==t||!Zi.call(o,o.previous)||el(o.events)?n(t):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(Hi,e.attempt(Ni,e.attempt($i,s),n),n)(t))};function s(n){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(n)}},previous:Zi},Ui={tokenize:function(e,t,n){const o=this;let s="",a=!1;return function(t){return 72!==t&&104!==t||!Wi.call(o,o.previous)||el(o.events)?n(t):(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(t),e.consume(t),r)};function r(t){if(gr(t)&&s.length<5)return s+=String.fromCodePoint(t),e.consume(t),r;if(58===t){const n=s.toLowerCase();if("http"===n||"https"===n)return e.consume(t),i}return n(t)}function i(t){return 47===t?(e.consume(t),a?l:(a=!0,i)):n(t)}function l(t){return null===t||br(t)||Sr(t)||Rr(t)||Ar(t)?n(t):e.attempt(Ni,e.attempt($i,c),n)(t)}function c(n){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(n)}},previous:Wi},Xi={tokenize:function(e,t,n){const o=this;let s,a;return function(t){return Ji(t)&&Qi.call(o,o.previous)&&!el(o.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),r(t)):n(t)};function r(t){return Ji(t)?(e.consume(t),r):64===t?(e.consume(t),i):n(t)}function i(t){return 46===t?e.check(Vi,c,l)(t):45===t||95===t||_r(t)?(a=!0,e.consume(t),i):c(t)}function l(t){return e.consume(t),s=!0,i}function c(r){return a&&s&&gr(o.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(r)):n(r)}},previous:Qi},Yi={},Gi={text:Yi};let Ki=48;for(;Ki<123;)Yi[Ki]=Xi,Ki++,58===Ki?Ki=65:91===Ki&&(Ki=97);function Zi(e){return null===e||40===e||42===e||95===e||91===e||93===e||126===e||Sr(e)}function Wi(e){return!gr(e)}function Qi(e){return!(47===e||Ji(e))}function Ji(e){return 43===e||45===e||46===e||95===e||_r(e)}function el(e){let t=e.length,n=!1;for(;t--;){const o=e[t][1];if(("labelLink"===o.type||"labelImage"===o.type)&&!o._balanced){n=!0;break}if(o._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}Yi[43]=Xi,Yi[45]=Xi,Yi[46]=Xi,Yi[95]=Xi,Yi[72]=[Xi,Ui],Yi[104]=[Xi,Ui],Yi[87]=[Xi,qi],Yi[119]=[Xi,qi];const tl={exit:{literalAutolinkEmail:function(e){nl.call(this,e,"mailto:")},literalAutolinkHttp:function(e){nl.call(this,e)},literalAutolinkWww:function(e){nl.call(this,e,"http://")}}};function nl(e,t){const n=this.sliceSerialize(e);this.tag('<a href="'+Tr((t||"")+n)+'">'),this.raw(this.encode(n)),this.tag("</a>")}const ol={tokenize:function(e,t,n){const o=this;return Or(e,(function(e){const s=o.events[o.events.length-1];return s&&"gfmFootnoteDefinitionIndent"===s[1].type&&4===s[2].sliceSerialize(s[1],!0).length?t(e):n(e)}),"gfmFootnoteDefinitionIndent",5)},partial:!0};function sl(e,t,n){const o=this;let s=o.events.length;const a=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]);let r;for(;s--;){const e=o.events[s][1];if("labelImage"===e.type){r=e;break}if("gfmFootnoteCall"===e.type||"labelLink"===e.type||"label"===e.type||"image"===e.type||"link"===e.type)break}return function(s){if(!r||!r._balanced)return n(s);const i=hr(o.sliceSerialize({start:r.end,end:o.now()}));return 94===i.codePointAt(0)&&a.includes(i.slice(1))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(s),e.exit("gfmFootnoteCallLabelMarker"),t(s)):n(s)}}function al(e,t){let n=e.length;for(;n--;)if("labelImage"===e[n][1].type&&"enter"===e[n][0]){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const o={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},r={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},i=[e[n+1],e[n+2],["enter",o,t],e[n+3],e[n+4],["enter",s,t],["exit",s,t],["enter",a,t],["enter",r,t],["exit",r,t],["exit",a,t],e[e.length-2],e[e.length-1],["exit",o,t]];return e.splice(n,e.length-n+1,...i),e}function rl(e,t,n){const o=this,s=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]);let a,r=0;return function(t){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(t),e.exit("gfmFootnoteCallLabelMarker"),i};function i(t){return 94!==t?n(t):(e.enter("gfmFootnoteCallMarker"),e.consume(t),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",l)}function l(i){if(r>999||93===i&&!a||null===i||91===i||Sr(i))return n(i);if(93===i){e.exit("chunkString");const a=e.exit("gfmFootnoteCallString");return s.includes(hr(o.sliceSerialize(a)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(i),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(i)}return Sr(i)||(a=!0),r++,e.consume(i),92===i?c:l}function c(t){return 91===t||92===t||93===t?(e.consume(t),r++,l):l(t)}}function il(e,t,n){const o=this,s=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]);let a,r,i=0;return function(t){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),l};function l(t){return 94===t?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",c):n(t)}function c(t){if(i>999||93===t&&!r||null===t||91===t||Sr(t))return n(t);if(93===t){e.exit("chunkString");const n=e.exit("gfmFootnoteDefinitionLabelString");return a=hr(o.sliceSerialize(n)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),d}return Sr(t)||(r=!0),i++,e.consume(t),92===t?u:c}function u(t){return 91===t||92===t||93===t?(e.consume(t),i++,c):c(t)}function d(t){return 58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),s.includes(a)||s.push(a),Or(e,m,"gfmFootnoteDefinitionWhitespace")):n(t)}function m(e){return t(e)}}function ll(e,t,n){return e.check(Vr,t,e.attempt(ol,t,n))}function cl(e){e.exit("gfmFootnoteDefinition")}const ul={}.hasOwnProperty,dl={};function ml(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function fl(e){const t=e||dl,n=t.label||"Footnotes",o=t.labelTagName||"h2",s=null===t.labelAttributes||void 0===t.labelAttributes?'class="sr-only"':t.labelAttributes,a=t.backLabel||ml,r=null===t.clobberPrefix||void 0===t.clobberPrefix?"user-content-":t.clobberPrefix;return{enter:{gfmFootnoteDefinition(){this.getData("tightStack").push(!1)},gfmFootnoteDefinitionLabelString(){this.buffer()},gfmFootnoteCallString(){this.buffer()}},exit:{gfmFootnoteDefinition(){let e=this.getData("gfmFootnoteDefinitions");const t=this.getData("gfmFootnoteDefinitionStack"),n=this.getData("tightStack"),o=t.pop(),s=this.resume();e||this.setData("gfmFootnoteDefinitions",e={}),ul.call(e,o)||(e[o]=s),n.pop(),this.setData("slurpOneLineEnding",!0),this.setData("lastWasTag")},gfmFootnoteDefinitionLabelString(e){let t=this.getData("gfmFootnoteDefinitionStack");t||this.setData("gfmFootnoteDefinitionStack",t=[]),t.push(hr(this.sliceSerialize(e))),this.resume(),this.buffer()},gfmFootnoteCallString(e){let t=this.getData("gfmFootnoteCallOrder"),n=this.getData("gfmFootnoteCallCounts");const o=hr(this.sliceSerialize(e));let s;this.resume(),t||this.setData("gfmFootnoteCallOrder",t=[]),n||this.setData("gfmFootnoteCallCounts",n={});const a=t.indexOf(o),i=Tr(o.toLowerCase());-1===a?(t.push(o),n[o]=1,s=t.length):(n[o]++,s=a+1);const l=n[o];this.tag('<sup><a href="#'+r+"fn-"+i+'" id="'+r+"fnref-"+i+(l>1?"-"+l:"")+'" data-footnote-ref="" aria-describedby="footnote-label">'+String(s)+"</a></sup>")},null(){const e=this.getData("gfmFootnoteCallOrder")||[],t=this.getData("gfmFootnoteCallCounts")||{},i=this.getData("gfmFootnoteDefinitions")||{};let l=-1;for(e.length>0&&(this.lineEndingIfNeeded(),this.tag('<section data-footnotes="" class="footnotes"><'+o+' id="footnote-label"'+(s?" "+s:"")+">"),this.raw(this.encode(n)),this.tag("</"+o+">"),this.lineEndingIfNeeded(),this.tag("<ol>"));++l<e.length;){const n=e[l],o=Tr(n.toLowerCase());let s=0;const c=[];for(;++s<=t[n];)c.push('<a href="#'+r+"fnref-"+o+(s>1?"-"+s:"")+'" data-footnote-backref="" aria-label="'+this.encode("string"==typeof a?a:a(l,s))+'" class="data-footnote-backref">'+(s>1?"<sup>"+s+"</sup>":"")+"</a>");const u=c.join(" ");let d=!1;this.lineEndingIfNeeded(),this.tag('<li id="'+r+"fn-"+o+'">'),this.lineEndingIfNeeded(),this.tag(i[n].replace(/<\/p>(?:\r?\n|\r)?$/,(e=>(d=!0," "+u+e)))),d||(this.lineEndingIfNeeded(),this.tag(u)),this.lineEndingIfNeeded(),this.tag("</li>")}e.length>0&&(this.lineEndingIfNeeded(),this.tag("</ol>"),this.lineEndingIfNeeded(),this.tag("</section>"))}}}}const pl={enter:{strikethrough(){this.tag("<del>")}},exit:{strikethrough(){this.tag("</del>")}}};function hl(e){let t=(e||{}).singleTilde;const n={tokenize:function(e,n,o){const s=this.previous,a=this.events;let r=0;return function(t){return 126===s&&"characterEscape"!==a[a.length-1][1].type?o(t):(e.enter("strikethroughSequenceTemporary"),i(t))};function i(a){const l=Dr(s);if(126===a)return r>1?o(a):(e.consume(a),r++,i);if(r<2&&!t)return o(a);const c=e.exit("strikethroughSequenceTemporary"),u=Dr(a);return c._open=!u||2===u&&Boolean(l),c._close=!l||2===l&&Boolean(u),n(a)}},resolveAll:function(e,t){let n=-1;for(;++n<e.length;)if("enter"===e[n][0]&&"strikethroughSequenceTemporary"===e[n][1].type&&e[n][1]._close){let o=n;for(;o--;)if("exit"===e[o][0]&&"strikethroughSequenceTemporary"===e[o][1].type&&e[o][1]._open&&e[n][1].end.offset-e[n][1].start.offset==e[o][1].end.offset-e[o][1].start.offset){e[n][1].type="strikethroughSequence",e[o][1].type="strikethroughSequence";const s={type:"strikethrough",start:Object.assign({},e[o][1].start),end:Object.assign({},e[n][1].end)},a={type:"strikethroughText",start:Object.assign({},e[o][1].end),end:Object.assign({},e[n][1].start)},r=[["enter",s,t],["enter",e[o][1],t],["exit",e[o][1],t],["enter",a,t]],i=t.parser.constructs.insideSpan.null;i&&ar(r,r.length,0,Hr(i,e.slice(o+1,n),t)),ar(r,r.length,0,[["exit",a,t],["enter",e[n][1],t],["exit",e[n][1],t],["exit",s,t]]),ar(e,o-1,n-o+3,r),n=o+r.length-2;break}}for(n=-1;++n<e.length;)"strikethroughSequenceTemporary"===e[n][1].type&&(e[n][1].type="data");return e}};return null==t&&(t=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}}}const gl={none:"",left:' align="left"',right:' align="right"',center:' align="center"'},_l={enter:{table(e){const t=e._align;this.lineEndingIfNeeded(),this.tag("<table>"),this.setData("tableAlign",t)},tableBody(){this.tag("<tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=gl[e[t]];void 0===n?this.buffer():(this.lineEndingIfNeeded(),this.tag("<td"+n+">"))},tableHead(){this.lineEndingIfNeeded(),this.tag("<thead>")},tableHeader(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=gl[e[t]];this.lineEndingIfNeeded(),this.tag("<th"+n+">")},tableRow(){this.setData("tableColumn",0),this.lineEndingIfNeeded(),this.tag("<tr>")}},exit:{codeTextData(e){let t=this.sliceSerialize(e);this.getData("tableAlign")&&(t=t.replace(/\\([\\|])/g,vl)),this.raw(this.encode(t))},table(){this.setData("tableAlign"),this.setData("slurpAllLineEndings"),this.lineEndingIfNeeded(),this.tag("</table>")},tableBody(){this.lineEndingIfNeeded(),this.tag("</tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn");t in e?(this.tag("</td>"),this.setData("tableColumn",t+1)):this.resume()},tableHead(){this.lineEndingIfNeeded(),this.tag("</thead>")},tableHeader(){const e=this.getData("tableColumn");this.tag("</th>"),this.setData("tableColumn",e+1)},tableRow(){const e=this.getData("tableAlign");let t=this.getData("tableColumn");for(;t<e.length;)this.lineEndingIfNeeded(),this.tag("<td"+gl[e[t]]+"></td>"),t++;this.setData("tableColumn",t),this.lineEndingIfNeeded(),this.tag("</tr>")}}};function vl(e,t){return"|"===t?t:e}class bl{constructor(){this.map=[]}add(e,t,n){!function(e,t,n,o){let s=0;if(0!==n||0!==o.length){for(;s<e.map.length;){if(e.map[s][0]===t)return e.map[s][1]+=n,void e.map[s][2].push(...o);s+=1}e.map.push([t,n,o])}}(this,e,t,n)}consume(e){if(this.map.sort(((e,t)=>e[0]-t[0])),0===this.map.length)return;let t=this.map.length;const n=[];for(;t>0;)t-=1,n.push(e.slice(this.map[t][0]+this.map[t][1])),n.push(this.map[t][2]),e.length=this.map[t][0];n.push([...e]),e.length=0;let o=n.pop();for(;o;)e.push(...o),o=n.pop();this.map.length=0}}function xl(e,t){let n=!1;const o=[];for(;t<e.length;){const s=e[t];if(n){if("enter"===s[0])"tableContent"===s[1].type&&o.push("tableDelimiterMarker"===e[t+1][1].type?"left":"none");else if("tableContent"===s[1].type){if("tableDelimiterMarker"===e[t-1][1].type){const e=o.length-1;o[e]="left"===o[e]?"center":"right"}}else if("tableDelimiterRow"===s[1].type)break}else"enter"===s[0]&&"tableDelimiterRow"===s[1].type&&(n=!0);t+=1}return o}const yl={flow:{null:{tokenize:function(e,t,n){const o=this;let s,a=0,r=0;return function(e){let t=o.events.length-1;for(;t>-1;){const e=o.events[t][1].type;if("lineEnding"!==e&&"linePrefix"!==e)break;t--}const s=t>-1?o.events[t][1].type:null,a="tableHead"===s||"tableRow"===s?x:i;return a===x&&o.parser.lazy[o.now().line]?n(e):a(e)};function i(t){return e.enter("tableHead"),e.enter("tableRow"),function(e){return 124===e||(s=!0,r+=1),l(e)}(t)}function l(t){return null===t?n(t):kr(t)?r>1?(r=0,o.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),d):n(t):Mr(t)?Or(e,l,"whitespace")(t):(r+=1,s&&(s=!1,a+=1),124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),s=!0,l):(e.enter("data"),c(t)))}function c(t){return null===t||124===t||Sr(t)?(e.exit("data"),l(t)):(e.consume(t),92===t?u:c)}function u(t){return 92===t||124===t?(e.consume(t),c):c(t)}function d(t){return o.interrupt=!1,o.parser.lazy[o.now().line]?n(t):(e.enter("tableDelimiterRow"),s=!1,Mr(t)?Or(e,m,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):m(t))}function m(t){return 45===t||58===t?p(t):124===t?(s=!0,e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),f):b(t)}function f(t){return Mr(t)?Or(e,p,"whitespace")(t):p(t)}function p(t){return 58===t?(r+=1,s=!0,e.enter("tableDelimiterMarker"),e.consume(t),e.exit("tableDelimiterMarker"),h):45===t?(r+=1,h(t)):null===t||kr(t)?v(t):b(t)}function h(t){return 45===t?(e.enter("tableDelimiterFiller"),g(t)):b(t)}function g(t){return 45===t?(e.consume(t),g):58===t?(s=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(t),e.exit("tableDelimiterMarker"),_):(e.exit("tableDelimiterFiller"),_(t))}function _(t){return Mr(t)?Or(e,v,"whitespace")(t):v(t)}function v(n){return 124===n?m(n):(null===n||kr(n))&&s&&a===r?(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(n)):b(n)}function b(e){return n(e)}function x(t){return e.enter("tableRow"),y(t)}function y(n){return 124===n?(e.enter("tableCellDivider"),e.consume(n),e.exit("tableCellDivider"),y):null===n||kr(n)?(e.exit("tableRow"),t(n)):Mr(n)?Or(e,y,"whitespace")(n):(e.enter("data"),w(n))}function w(t){return null===t||124===t||Sr(t)?(e.exit("data"),y(t)):(e.consume(t),92===t?k:w)}function k(t){return 92===t||124===t?(e.consume(t),w):w(t)}},resolveAll:function(e,t){let n,o,s,a=-1,r=!0,i=0,l=[0,0,0,0],c=[0,0,0,0],u=!1,d=0;const m=new bl;for(;++a<e.length;){const f=e[a],p=f[1];"enter"===f[0]?"tableHead"===p.type?(u=!1,0!==d&&(kl(m,t,d,n,o),o=void 0,d=0),n={type:"table",start:Object.assign({},p.start),end:Object.assign({},p.end)},m.add(a,0,[["enter",n,t]])):"tableRow"===p.type||"tableDelimiterRow"===p.type?(r=!0,s=void 0,l=[0,0,0,0],c=[0,a+1,0,0],u&&(u=!1,o={type:"tableBody",start:Object.assign({},p.start),end:Object.assign({},p.end)},m.add(a,0,[["enter",o,t]])),i="tableDelimiterRow"===p.type?2:o?3:1):!i||"data"!==p.type&&"tableDelimiterMarker"!==p.type&&"tableDelimiterFiller"!==p.type?"tableCellDivider"===p.type&&(r?r=!1:(0!==l[1]&&(c[0]=c[1],s=wl(m,t,l,i,void 0,s)),l=c,c=[l[1],a,0,0])):(r=!1,0===c[2]&&(0!==l[1]&&(c[0]=c[1],s=wl(m,t,l,i,void 0,s),l=[0,0,0,0]),c[2]=a)):"tableHead"===p.type?(u=!0,d=a):"tableRow"===p.type||"tableDelimiterRow"===p.type?(d=a,0!==l[1]?(c[0]=c[1],s=wl(m,t,l,i,a,s)):0!==c[1]&&(s=wl(m,t,c,i,a,s)),i=0):i&&("data"===p.type||"tableDelimiterMarker"===p.type||"tableDelimiterFiller"===p.type)&&(c[3]=a)}for(0!==d&&kl(m,t,d,n,o),m.consume(t.events),a=-1;++a<t.events.length;){const e=t.events[a];"enter"===e[0]&&"table"===e[1].type&&(e[1]._align=xl(t.events,a))}return e}}}};function wl(e,t,n,o,s,a){const r=1===o?"tableHeader":2===o?"tableDelimiter":"tableData";0!==n[0]&&(a.end=Object.assign({},Sl(t.events,n[0])),e.add(n[0],0,[["exit",a,t]]));const i=Sl(t.events,n[1]);if(a={type:r,start:Object.assign({},i),end:Object.assign({},i)},e.add(n[1],0,[["enter",a,t]]),0!==n[2]){const s=Sl(t.events,n[2]),a=Sl(t.events,n[3]),r={type:"tableContent",start:Object.assign({},s),end:Object.assign({},a)};if(e.add(n[2],0,[["enter",r,t]]),2!==o){const o=t.events[n[2]],s=t.events[n[3]];if(o[1].end=Object.assign({},s[1].end),o[1].type="chunkText",o[1].contentType="text",n[3]>n[2]+1){const t=n[2]+1,o=n[3]-n[2]-1;e.add(t,o,[])}}e.add(n[3]+1,0,[["exit",r,t]])}return void 0!==s&&(a.end=Object.assign({},Sl(t.events,s)),e.add(s,0,[["exit",a,t]]),a=void 0),a}function kl(e,t,n,o,s){const a=[],r=Sl(t.events,n);s&&(s.end=Object.assign({},r),a.push(["exit",s,t])),o.end=Object.assign({},r),a.push(["exit",o,t]),e.add(n+1,0,a)}function Sl(e,t){const n=e[t],o="enter"===n[0]?"start":"end";return n[1][o]}const Ml=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|title|textarea|xmp)(?=[\t\n\f\r />])/gi,Al=new RegExp("^"+Ml.source,"i"),Rl={exit:{htmlFlowData(e){El.call(this,e,Ml)},htmlTextData(e){El.call(this,e,Al)}}};function El(e,t){let n=this.sliceSerialize(e);this.options.allowDangerousHtml&&(n=n.replace(t,"&lt;$1$2")),this.raw(this.encode(n))}const Tl={enter:{taskListCheck(){this.tag('<input type="checkbox" disabled="" ')}},exit:{taskListCheck(){this.tag("/>")},taskListCheckValueChecked(){this.tag('checked="" ')}}},Bl={text:{91:{tokenize:function(e,t,n){const o=this;return function(t){return null===o.previous&&o._gfmTasklistFirstContentOfListItem?(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),s):n(t)};function s(t){return Sr(t)?(e.enter("taskListCheckValueUnchecked"),e.consume(t),e.exit("taskListCheckValueUnchecked"),a):88===t||120===t?(e.enter("taskListCheckValueChecked"),e.consume(t),e.exit("taskListCheckValueChecked"),a):n(t)}function a(t){return 93===t?(e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),r):n(t)}function r(o){return kr(o)?t(o):Mr(o)?e.check({tokenize:Il},t,n)(o):n(o)}}}}};function Il(e,t,n){return Or(e,(function(e){return null===e?n(e):t(e)}),"whitespace")}function Cl(e){return lr([Gi,{document:{91:{tokenize:il,continuation:{tokenize:ll},exit:cl}},text:{91:{tokenize:rl},93:{add:"after",tokenize:sl,resolveTo:al}}},hl(e),yl,Bl])}function jl(e){return dr([tl,fl(e),pl,_l,Rl,Tl])}const Ol=-5,Fl=-4,Ll=-3,Pl=null,Dl=62,Hl=64,Nl=92,$l=176,zl={text:{176:{name:"underline",tokenize:(e,t,n)=>{const o=a=>a===Ol||a===Fl||a===Ll||a===Pl?n(a):a===Nl?(e.consume(a),s):a===$l?(e.exit("underlineContent"),e.enter("underlineMarker"),e.consume(a),e.exit("underlineMarker"),e.exit("underline"),t):(e.consume(a),o),s=t=>t===Nl||t===$l?(e.consume(t),o):o(t),a=e=>e===$l?n(e):o(e);return t=>(e.enter("underline"),e.enter("underlineMarker"),e.consume(t),e.exit("underlineMarker"),e.enter("underlineContent",{contentType:"string"}),a)}}}},Vl={enter:{underline(){this.tag("<u>")}},exit:{underline(){this.tag("</u>")}}},ql={text:{60:{name:"usertag",tokenize:(e,t,n)=>{const o=a=>a===Ol||a===Fl||a===Ll||a===Pl?n(a):a===Nl?(e.consume(a),s):a===Dl?(e.exit("usertagContent"),e.enter("usertagMarker"),e.consume(a),e.exit("usertagMarker"),e.exit("usertag"),t):(e.consume(a),o),s=t=>t===Nl||t===Dl?(e.consume(t),o):o(t),a=t=>t===Hl?(e.consume(t),e.exit("usertagMarker"),e.enter("usertagContent"),o):n(t);return t=>(e.enter("usertag"),e.enter("usertagMarker"),e.consume(t),a)}}}},Ul=e=>({exit:{usertagContent(t){const n=this.sliceSerialize(t);this.tag(`<span class="vac-text-tag" data-user-id="${n}">`);const o=e.find((e=>e._id===n));this.raw(`@${this.encode(o?o.username:n)}`),this.tag("</span>")}}});const Xl=["png","jpg","jpeg","webp","svg","gif"],Yl=["mp4","video/ogg","webm","quicktime"],Gl=["mp3","audio/ogg","wav","mpeg"],Kl={name:"FormatMessage",components:{SvgIcon:Qa},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{parsedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];let e;e=this.textFormatting.disabled?{}:{textFormatting:{linkify:this.linkify,linkOptions:this.linkOptions,singleLine:this.singleLine,reply:this.reply,users:this.users,...this.textFormatting}};const t=((e,{textFormatting:t})=>{if(t){let n=[];t.linkify||(n=["literalAutolink","literalAutolinkEmail"]);const o=Di(e.replaceAll("<usertag>","<@").replaceAll("</usertag>",">"),{extensions:[{...Cl(),disable:{null:n}},zl,ql],htmlExtensions:[jl(),Vl,Ul(t.users)]});if(t.singleLine){const e=document.createElement("div");return e.innerHTML=o,[{types:[],value:e.innerText}]}return[{types:["markdown"],value:o}]}return[{types:[],value:e}]})(this.content,e);return t.forEach((e=>{e.markdown=this.checkType(e,"markdown"),e.tag=this.checkType(e,"tag"),e.image=this.checkImageType(e)})),t}},methods:{checkType:(e,t)=>e.types&&-1!==e.types.indexOf(t),checkImageType(e){let t=e.value.lastIndexOf(".");e.value.lastIndexOf("/")>t&&(t=-1);const n=e.value.substring(t+1,e.value.length),o=t>0&&Xl.some((e=>n.toLowerCase().includes(e)));return o&&this.setImageSize(e),o},setImageSize(e){const t=new Image;t.src=e.value,t.addEventListener("load",(function n(o){const s=o.path[0].width/150;e.height=Math.round(o.path[0].height/s)+"px",t.removeEventListener("load",n)}))},openTag(e){const t=e.target.getAttribute("data-user-id");if(!this.singleLine&&t){const e=this.users.find((e=>String(e._id)===t));this.$emit("open-user-tag",e)}}}},Zl=["innerHTML"],Wl={class:"vac-image-link-container"},Ql={class:"vac-image-link-message"};var Jl=Na(Kl,[["render",function(e,t,n,o,s,a){const r=Un("svg-icon");return Uo(),Ko("div",{class:Ne(["vac-format-message-wrapper",{"vac-text-ellipsis":n.singleLine}])},[(Uo(!0),Ko(Ho,null,Wn(a.parsedMessage,((o,s)=>(Uo(),Ko(Ho,{key:s},[o.markdown?(Uo(),Ko("div",{key:0,class:"markdown",onClick:t[0]||(t[0]=(...e)=>a.openTag&&a.openTag(...e)),innerHTML:o.value},null,8,Zl)):(Uo(),Ko("div",{key:1,class:Ne(["vac-format-container",{"vac-text-ellipsis":n.singleLine}])},[(Uo(),Zo(Yn(o.url?"a":"span"),{class:Ne({"vac-text-ellipsis":n.singleLine,"vac-text-tag":!n.singleLine&&!n.reply&&o.tag}),href:o.href,target:o.href?n.linkOptions.target:null,rel:o.href?n.linkOptions.rel:null},{default:tn((()=>[n.deleted?(Uo(),Ko(Ho,{key:0},[Jn(e.$slots,n.roomList?"deleted-icon-room_"+n.roomId:"deleted-icon_"+n.messageId,{},(()=>[os(r,{name:"deleted",class:Ne(["vac-icon-deleted",{"vac-icon-deleted-room":n.roomList}])},null,8,["class"])])),rs(" "+ze(n.textMessages.MESSAGE_DELETED),1)],64)):o.url&&o.image?(Uo(),Ko(Ho,{key:1},[ns("div",Wl,[ns("div",{class:"vac-image-link",style:Le({"background-image":`url('${o.value}')`,height:o.height})},null,4)]),ns("div",Ql,ze(o.value),1)],64)):(Uo(),Ko(Ho,{key:2},[rs(ze(o.value),1)],64))])),_:2},1032,["class","href","target","rel"]))],2))],64)))),128))],2)}]]);const ec="__v-click-outside",tc="undefined"!=typeof window,nc="undefined"!=typeof navigator,oc=tc&&("ontouchstart"in window||nc&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],sc=({event:e,handler:t,middleware:n})=>{n(e)&&t(e)},ac=(e,{value:t})=>{const{events:n,handler:o,middleware:s,isActive:a,detectIframe:r,capture:i}=(e=>{const t="function"==typeof e;if(!t&&"object"!=typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(e=>e),events:e.events||oc,isActive:!1!==e.isActive,detectIframe:!1!==e.detectIframe,capture:Boolean(e.capture)}})(t);if(a){if(e[ec]=n.map((t=>({event:t,srcTarget:document.documentElement,handler:t=>(({el:e,event:t,handler:n,middleware:o})=>{const s=t.path||t.composedPath&&t.composedPath();(s?s.indexOf(e)<0:!e.contains(t.target))&&sc({event:t,handler:n,middleware:o})})({el:e,event:t,handler:o,middleware:s}),capture:i}))),r){const t={event:"blur",srcTarget:window,handler:t=>(({el:e,event:t,handler:n,middleware:o})=>{setTimeout((()=>{const{activeElement:s}=document;s&&"IFRAME"===s.tagName&&!e.contains(s)&&sc({event:t,handler:n,middleware:o})}),0)})({el:e,event:t,handler:o,middleware:s}),capture:i};e[ec]=[...e[ec],t]}e[ec].forEach((({event:t,srcTarget:n,handler:o})=>setTimeout((()=>{!e[ec]||n.addEventListener(t,o,i)}),0)))}},rc=e=>{(e[ec]||[]).forEach((({event:e,srcTarget:t,handler:n,capture:o})=>t.removeEventListener(e,n,o))),delete e[ec]};var ic=tc?{beforeMount:ac,updated:(e,{value:t,oldValue:n})=>{JSON.stringify(t)!==JSON.stringify(n)&&(rc(e),ac(e,{value:t}))},unmounted:rc}:{},lc=(e,t,n)=>{if(e.typingUsers&&e.typingUsers.length){const o=e.users.filter((n=>{if(n._id!==t&&-1!==e.typingUsers.indexOf(n._id)&&(!n.status||"offline"!==n.status.state))return!0}));return o.length?2===e.users.length?n.IS_TYPING:o.map((e=>e.username)).join(", ")+" "+n.IS_TYPING:void 0}};function cc(e,t){if(t&&t.type)return e.some((e=>t.type.toLowerCase().includes(e)))}function uc(e){return cc(Xl,e)}function dc(e){return cc(Yl,e)}function mc(e){return cc(Xl,e)||cc(Yl,e)}function fc(e){return cc(Gl,e)}const pc={class:"vac-room-container"},hc={class:"vac-name-container vac-text-ellipsis"},gc={class:"vac-title-container"},_c={class:"vac-room-name vac-text-ellipsis"},vc={key:1,class:"vac-text-date"},bc={key:0},xc={key:1,class:"vac-text-ellipsis"},yc={key:3,class:"vac-text-ellipsis"},wc={class:"vac-room-options-container"},kc={key:0,class:"vac-badge-counter vac-room-badge"},Sc={key:0,class:"vac-menu-options"},Mc={class:"vac-menu-list"},Ac=["onClick"];var Rc=Na({name:"RoomsContent",components:{SvgIcon:Qa,FormatMessage:Jl},directives:{clickOutside:ic},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data:()=>({roomMenuOpened:null}),computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const n=this.room.users.find((e=>e._id===this.room.lastMessage.senderId));return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:n&&n._id!==this.currentUserId?`${n.username} - ${t}`:t},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find((e=>e._id!==this.currentUserId));return e&&e.status?e.status.state:null},typingUsers(){return lc(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var e,t;const n=null==(t=null==(e=this.room.lastMessage)?void 0:e.files)?void 0:t[0];if(n){if(!n.duration)return`${n.name}.${n.extension}`;let e=Math.floor(n.duration);return(e-(e%=60))/60+(e>9?":":":0")+e}return""},isAudio(){return!!this.room.lastMessage.files&&fc(this.room.lastMessage.files[0])}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},[["render",function(e,t,n,o,s,a){const r=Un("svg-icon"),i=Un("format-message"),l=Gn("click-outside");return Uo(),Ko("div",pc,[Jn(e.$slots,"room-list-item_"+n.room.roomId,{},(()=>[Jn(e.$slots,"room-list-avatar_"+n.room.roomId,{},(()=>[n.room.avatar?(Uo(),Ko("div",{key:0,class:"vac-avatar",style:Le({"background-image":`url('${n.room.avatar}')`})},null,4)):is("",!0)])),ns("div",hc,[ns("div",gc,[a.userStatus?(Uo(),Ko("div",{key:0,class:Ne(["vac-state-circle",{"vac-state-online":"online"===a.userStatus}])},null,2)):is("",!0),Jn(e.$slots,"room-list-info_"+n.room.roomId,{},(()=>[ns("div",_c,ze(n.room.roomName),1)])),n.room.lastMessage?(Uo(),Ko("div",vc,ze(n.room.lastMessage.timestamp),1)):is("",!0)]),ns("div",{class:Ne(["vac-text-last",{"vac-message-new":n.room.lastMessage&&n.room.lastMessage.new&&!a.typingUsers}])},[a.isMessageCheckmarkVisible?(Uo(),Ko("span",bc,[Jn(e.$slots,"checkmark-icon_"+n.room.roomId,{},(()=>[os(r,{name:n.room.lastMessage.distributed?"double-checkmark":"checkmark",param:n.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])]))])):is("",!0),n.room.lastMessage&&!n.room.lastMessage.deleted&&a.isAudio?(Uo(),Ko("div",xc,[Jn(e.$slots,"microphone-icon_"+n.room.roomId,{},(()=>[os(r,{name:"microphone",class:"vac-icon-microphone"})])),rs(" "+ze(a.formattedDuration),1)])):n.room.lastMessage?(Uo(),Zo(i,{key:2,"message-id":n.room.lastMessage._id,"room-id":n.room.roomId,"room-list":!0,content:a.getLastMessage,deleted:!!n.room.lastMessage.deleted&&!a.typingUsers,users:n.room.users,"text-messages":n.textMessages,linkify:!1,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"single-line":!0},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):is("",!0),!n.room.lastMessage&&a.typingUsers?(Uo(),Ko("div",yc,ze(a.typingUsers),1)):is("",!0),ns("div",wc,[n.room.unreadCount?(Uo(),Ko("div",kc,ze(n.room.unreadCount),1)):is("",!0),Jn(e.$slots,"room-list-options_"+n.room.roomId,{},(()=>[n.roomActions.length?(Uo(),Ko("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Ca((e=>s.roomMenuOpened=n.room.roomId),["stop"]))},[Jn(e.$slots,"room-list-options-icon_"+n.room.roomId,{},(()=>[os(r,{name:"dropdown",param:"room"})]))])):is("",!0),n.roomActions.length?(Uo(),Zo(la,{key:1,name:"vac-slide-left"},{default:tn((()=>[s.roomMenuOpened===n.room.roomId?$n((Uo(),Ko("div",Sc,[ns("div",Mc,[(Uo(!0),Ko(Ho,null,Wn(n.roomActions,(e=>(Uo(),Ko("div",{key:e.name},[ns("div",{class:"vac-menu-item",onClick:Ca((t=>a.roomActionHandler(e)),["stop"])},ze(e.title),9,Ac)])))),128))])])),[[l,a.closeRoomMenu]]):is("",!0)])),_:1})):is("",!0)]))])],2)])]))])}]]),Ec=(e,t,n,o=!1)=>n&&""!==n?e.filter((e=>o?Tc(e[t]).startsWith(Tc(n)):Tc(e[t]).includes(Tc(n)))):e;function Tc(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const Bc={name:"RoomsList",components:{Loader:Ga,RoomsSearch:nr,RoomContent:Rc},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout((()=>this.initIntersectionObserver()))},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver((e=>{e[0].isIntersecting&&this.loadMoreRooms()}),t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=Ec(this.rooms,"roomName",e.target.value)},openRoom(e){e.roomId===this.room.roomId&&!this.isMobile||(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded)return this.loadingMoreRooms=!1,void(this.showLoader=!1);this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},Ic={key:0,class:"vac-rooms-empty"},Cc={key:1,id:"rooms-list",class:"vac-room-list"},jc=["id","onClick"],Oc={key:0,id:"infinite-loader-rooms"};var Fc=Na(Bc,[["render",function(e,t,n,o,s,a){const r=Un("rooms-search"),i=Un("loader"),l=Un("room-content");return $n((Uo(),Ko("div",{class:Ne(["vac-rooms-container",{"vac-rooms-container-full":n.isMobile,"vac-app-border-r":!n.isMobile}])},[Jn(e.$slots,"rooms-header"),Jn(e.$slots,"rooms-list-search",{},(()=>[os(r,{rooms:n.rooms,"loading-rooms":n.loadingRooms,"text-messages":n.textMessages,"show-search":n.showSearch,"show-add-room":n.showAddRoom,onSearchRoom:a.searchRoom,onAddRoom:t[0]||(t[0]=t=>e.$emit("add-room"))},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])])),os(i,{show:n.loadingRooms,type:"rooms"},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["show"]),n.loadingRooms||n.rooms.length?is("",!0):(Uo(),Ko("div",Ic,[Jn(e.$slots,"rooms-empty",{},(()=>[rs(ze(n.textMessages.ROOMS_EMPTY),1)]))])),n.loadingRooms?is("",!0):(Uo(),Ko("div",Cc,[(Uo(!0),Ko(Ho,null,Wn(s.filteredRooms,(o=>(Uo(),Ko("div",{id:o.roomId,key:o.roomId,class:Ne(["vac-room-item",{"vac-room-selected":s.selectedRoomId===o.roomId}]),onClick:e=>a.openRoom(o)},[os(l,{"current-user-id":n.currentUserId,room:o,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"text-messages":n.textMessages,"room-actions":n.roomActions,onRoomActionHandler:t[1]||(t[1]=t=>e.$emit("room-action-handler",t))},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,jc)))),128)),os(la,{name:"vac-fade-message"},{default:tn((()=>[n.rooms.length&&!n.loadingRooms?(Uo(),Ko("div",Oc,[os(i,{show:s.showLoader,infinite:!0,type:"infinite-rooms"},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["show"])])):is("",!0)])),_:3})]))],2)),[[Fa,n.showRoomsList]])}]]);const Lc={name:"RoomHeader",components:{SvgIcon:Qa},directives:{clickOutside:ic},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data:()=>({menuOpened:!1,messageSelectionAnimationEnded:!0}),computed:{typingUsers(){return lc(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find((e=>e._id!==this.currentUserId));if(null==e||!e.status)return;let t="";return"online"===e.status.state?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout((()=>{this.messageSelectionAnimationEnded=!0}),300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},Pc={class:"vac-room-header vac-app-border-b"},Dc={class:"vac-room-wrapper"},Hc={key:0,class:"vac-room-selection"},Nc=["id"],$c=["onClick"],zc={class:"vac-selection-button-count"},Vc={class:"vac-text-ellipsis"},qc={class:"vac-room-name vac-text-ellipsis"},Uc={key:0,class:"vac-room-info vac-text-ellipsis"},Xc={key:1,class:"vac-room-info vac-text-ellipsis"},Yc={key:0,class:"vac-menu-options"},Gc={class:"vac-menu-list"},Kc=["onClick"];var Zc=Na(Lc,[["render",function(e,t,n,o,s,a){const r=Un("svg-icon"),i=Gn("click-outside");return Uo(),Ko("div",Pc,[Jn(e.$slots,"room-header",{},(()=>[ns("div",Dc,[os(la,{name:"vac-slide-up"},{default:tn((()=>[n.messageSelectionEnabled?(Uo(),Ko("div",Hc,[(Uo(!0),Ko(Ho,null,Wn(n.messageSelectionActions,(e=>(Uo(),Ko("div",{id:e.name,key:e.name},[ns("div",{class:"vac-selection-button",onClick:t=>a.messageSelectionActionHandler(e)},[rs(ze(e.title)+" ",1),ns("span",zc,ze(n.selectedMessagesTotal),1)],8,$c)],8,Nc)))),128)),ns("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=t=>e.$emit("cancel-message-selection"))},ze(n.textMessages.CANCEL_SELECT_MESSAGE),1)])):is("",!0)])),_:1}),!n.messageSelectionEnabled&&s.messageSelectionAnimationEnded?(Uo(),Ko(Ho,{key:0},[n.singleRoom?is("",!0):(Uo(),Ko("div",{key:0,class:Ne(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!n.isMobile,"vac-rotate-icon":!n.showRoomsList&&!n.isMobile}]),onClick:t[1]||(t[1]=t=>e.$emit("toggle-rooms-list"))},[Jn(e.$slots,"toggle-icon",{},(()=>[os(r,{name:"toggle"})]))],2)),ns("div",{class:Ne(["vac-info-wrapper",{"vac-item-clickable":n.roomInfoEnabled}]),onClick:t[2]||(t[2]=t=>e.$emit("room-info"))},[Jn(e.$slots,"room-header-avatar",{},(()=>[n.room.avatar?(Uo(),Ko("div",{key:0,class:"vac-avatar",style:Le({"background-image":`url('${n.room.avatar}')`})},null,4)):is("",!0)])),Jn(e.$slots,"room-header-info",{},(()=>[ns("div",Vc,[ns("div",qc,ze(n.room.roomName),1),a.typingUsers?(Uo(),Ko("div",Uc,ze(a.typingUsers),1)):(Uo(),Ko("div",Xc,ze(a.userStatus),1))])]))],2),n.room.roomId?Jn(e.$slots,"room-options",{key:1},(()=>[n.menuActions.length?(Uo(),Ko("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=e=>s.menuOpened=!s.menuOpened)},[Jn(e.$slots,"menu-icon",{},(()=>[os(r,{name:"menu"})]))])):is("",!0),n.menuActions.length?(Uo(),Zo(la,{key:1,name:"vac-slide-left"},{default:tn((()=>[s.menuOpened?$n((Uo(),Ko("div",Yc,[ns("div",Gc,[(Uo(!0),Ko(Ho,null,Wn(n.menuActions,(e=>(Uo(),Ko("div",{key:e.name},[ns("div",{class:"vac-menu-item",onClick:t=>a.menuActionHandler(e)},ze(e.title),9,Kc)])))),128))])])),[[i,a.closeMenu]]):is("",!0)])),_:1})):is("",!0)])):is("",!0)],64)):is("",!0)])]))])}]]);function Wc(e){if("string"!=typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function Qc(e){if("number"!=typeof e)throw new Error("expected a number, got: "+e)}const Jc=1,eu=1,tu="emoji",nu="keyvalue",ou="favorites",su="tokens",au="tokens",ru="unicode",iu="count",lu="group",cu="order",uu="group-order",du="eTag",mu="url",fu="skinTone",pu="readonly",hu="readwrite",gu="skinUnicodes",_u="skinUnicodes";function vu(e){return function(e,t){const n=new Set,o=[];for(const s of e){const e=t(s);n.has(e)||(n.add(e),o.push(s))}return o}(e,(e=>e.unicode))}const bu={},xu={},yu={};function wu(e,t,n){n.onerror=()=>t(n.error),n.onblocked=()=>t(new Error("IDB blocked")),n.onsuccess=()=>e(n.result)}async function ku(e){const t=await new Promise(((t,n)=>{const o=indexedDB.open(e,Jc);bu[e]=o,o.onupgradeneeded=e=>{e.oldVersion<eu&&function(e){function t(t,n,o){const s=n?e.createObjectStore(t,{keyPath:n}):e.createObjectStore(t);if(o)for(const[e,[t,n]]of Object.entries(o))s.createIndex(e,t,{multiEntry:n});return s}t(nu),t(tu,ru,{[au]:[su,!0],[uu]:[[lu,cu]],[gu]:[_u,!0]}),t(ou,void 0,{[iu]:[""]})}(o.result)},wu(t,n,o)}));return t.onclose=()=>Mu(e),t}function Su(e,t,n,o){return new Promise(((s,a)=>{const r=e.transaction(t,n,{durability:"relaxed"}),i="string"==typeof t?r.objectStore(t):t.map((e=>r.objectStore(e)));let l;o(i,r,(e=>{l=e})),r.oncomplete=()=>s(l),r.onerror=()=>a(r.error)}))}function Mu(e){const t=bu[e],n=t&&t.result;if(n){n.close();const t=yu[e];if(t)for(const e of t)e()}delete bu[e],delete xu[e],delete yu[e]}const Au=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function Ru(e){return e.split(/[\s_]+/).map((e=>!e.match(/\w/)||Au.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(//g,"'").toLowerCase())).filter(Boolean)}const Eu=2;function Tu(e){return e.filter(Boolean).map((e=>e.toLowerCase())).filter((e=>e.length>=Eu))}function Bu(e,t,n,o){e[t](n).onsuccess=e=>o&&o(e.target.result)}function Iu(e,t,n){Bu(e,"get",t,n)}function Cu(e,t,n){Bu(e,"getAll",t,n)}function ju(e){e.commit&&e.commit()}function Ou(e,t){const n=function(e,t){let n=e[0];for(let o=1;o<e.length;o++){const s=e[o];t(n)>t(s)&&(n=s)}return n}(e,(e=>e.length)),o=[];for(const s of n)e.some((e=>-1===e.findIndex((e=>t(e)===t(s)))))||o.push(s);return o}async function Fu(e,t,n,o){try{const s=function(e){return e.map((({annotation:e,emoticon:t,group:n,order:o,shortcodes:s,skins:a,tags:r,emoji:i,version:l})=>{const c=[...new Set(Tu([...(s||[]).map(Ru).flat(),...r.map(Ru).flat(),...Ru(e),t]))].sort(),u={annotation:e,group:n,order:o,tags:r,tokens:c,unicode:i,version:l};if(t&&(u.emoticon=t),s&&(u.shortcodes=s),a){u.skinTones=[],u.skinUnicodes=[],u.skinVersions=[];for(const{tone:e,emoji:t,version:n}of a)u.skinTones.push(e),u.skinUnicodes.push(t),u.skinVersions.push(n)}return u}))}(t);await Su(e,[tu,nu],hu,(([e,t],a)=>{let r,i,l=0;function c(){2==++l&&function(){if(r!==o||i!==n){e.clear();for(const t of s)e.put(t);t.put(o,du),t.put(n,mu),ju(a)}}()}Iu(t,du,(e=>{r=e,c()})),Iu(t,mu,(e=>{i=e,c()}))}))}finally{}}async function Lu(e,t){const n=Tu(Ru(t));return n.length?Su(e,tu,pu,((e,t,o)=>{const s=[],a=()=>{const e=Ou(s,(e=>e.unicode));o(e.sort(((e,t)=>e.order<t.order?-1:1)))};for(let t=0;t<n.length;t++){const o=n[t],r=t===n.length-1?IDBKeyRange.bound(o,o+"",!1,!0):IDBKeyRange.only(o);Cu(e.index(au),r,(e=>{s.push(e),s.length===n.length&&a()}))}})):[]}async function Pu(e,t){const n=await Lu(e,t);return n.length?n.filter((e=>(e.shortcodes||[]).map((e=>e.toLowerCase())).includes(t.toLowerCase())))[0]||null:await async function(e,t){return Su(e,tu,pu,((e,n,o)=>{let s;const a=()=>{e.getAll(s&&IDBKeyRange.lowerBound(s,!0),50).onsuccess=e=>{const n=e.target.result;for(const e of n)if(s=e.unicode,t(e))return o(e);if(n.length<50)return o();a()}};a()}))}(e,(e=>(e.shortcodes||[]).includes(t.toLowerCase())))||null}function Du(e,t,n){return Su(e,t,pu,((e,t,o)=>Iu(e,n,o)))}const Hu="";const Nu=["name","url"];function $u(e){!function(e){const t=e&&Array.isArray(e),n=t&&e.length&&(!e[0]||Nu.some((t=>!(t in e[0]))));if(!t||n)throw new Error("Custom emojis are in the wrong format")}(e);const t=(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1,n=e.sort(t),o=function(e,t){const n=new Map;for(const o of e){const e=t(o);for(const t of e){let e=n;for(let n=0;n<t.length;n++){const o=t.charAt(n);let s=e.get(o);s||(s=new Map,e.set(o,s)),e=s}let s=e.get(Hu);s||(s=[],e.set(Hu,s)),s.push(o)}}return(e,t)=>{let o=n;for(let t=0;t<e.length;t++){const n=e.charAt(t),s=o.get(n);if(!s)return[];o=s}if(t)return o.get(Hu)||[];const s=[],a=[o];for(;a.length;){const e=[...a.shift().entries()].sort(((e,t)=>e[0]<t[0]?-1:1));for(const[t,n]of e)t===Hu?s.push(...n):a.push(n)}return s}}(e,(e=>[...new Set((e.shortcodes||[]).map((e=>Ru(e))).flat())])),s=e=>o(e,!0),a=e=>o(e,!1),r=new Map,i=new Map;for(const t of e){i.set(t.name.toLowerCase(),t);for(const e of t.shortcodes||[])r.set(e.toLowerCase(),t)}return{all:n,search:e=>{const n=Ru(e);return Ou(n.map(((e,t)=>(t<n.length-1?s:a)(e))),(e=>e.name)).sort(t)},byShortcode:e=>r.get(e.toLowerCase()),byName:e=>i.get(e.toLowerCase())}}function zu(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let n=0;n<t;n++)e.skins[n]={tone:e.skinTones[n],unicode:e.skinUnicodes[n],version:e.skinVersions[n]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function Vu(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const qu=["annotation","emoji","group","order","tags","version"];function Uu(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function Xu(e){const t=await fetch(e);Uu(t,e);const n=t.headers.get("etag");Vu(n);const o=await t.json();return function(e){if(!e||!Array.isArray(e)||!e[0]||"object"!=typeof e[0]||qu.some((t=>!(t in e[0]))))throw new Error("Emoji data is in the wrong format")}(o),[n,o]}async function Yu(e){const t=function(e){for(var t=e.length,n=new ArrayBuffer(t),o=new Uint8Array(n),s=-1;++s<t;)o[s]=e.charCodeAt(s);return n}(JSON.stringify(e)),n=function(e){for(var t="",n=new Uint8Array(e),o=n.byteLength,s=-1;++s<o;)t+=String.fromCharCode(n[s]);return t}(await crypto.subtle.digest("SHA-1",t));return btoa(n)}async function Gu(e,t){let n,o=await async function(e){const t=await fetch(e,{method:"HEAD"});Uu(t,e);const n=t.headers.get("etag");return Vu(n),n}(t);if(!o){const e=await Xu(t);o=e[0],n=e[1],o||(o=await Yu(n))}await async function(e,t,n){const[o,s]=await Promise.all([du,mu].map((t=>Du(e,nu,t))));return o===n&&s===t}(e,t,o)||(n||(n=(await Xu(t))[1]),await Fu(e,n,t,o))}class Ku{constructor({dataSource:e="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",locale:t="en",customEmoji:n=[]}={}){this.dataSource=e,this.locale=t,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=$u(n),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await(t=this._dbName,xu[t]||(xu[t]=ku(t)),xu[t]);var t;!function(e,t){let n=yu[e];n||(n=yu[e]=[]),n.push(t)}(this._dbName,this._clear);const n=this.dataSource;await async function(e){return!await Du(e,nu,mu)}(e)?await async function(e,t){let[n,o]=await Xu(t);n||(n=await Yu(o)),await Fu(e,o,t,n)}(e,n):this._lazyUpdate=Gu(e,n)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return Qc(e),await this.ready(),vu(await async function(e,t){return Su(e,tu,pu,((e,n,o)=>{const s=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);Cu(e.index(uu),s,o)}))}(this._db,e)).map(zu)}async getEmojiBySearchQuery(e){Wc(e),await this.ready();return[...this._custom.search(e),...vu(await Lu(this._db,e)).map(zu)]}async getEmojiByShortcode(e){Wc(e),await this.ready();return this._custom.byShortcode(e)||zu(await Pu(this._db,e))}async getEmojiByUnicodeOrName(e){Wc(e),await this.ready();return this._custom.byName(e)||zu(await async function(e,t){return Su(e,tu,pu,((e,n,o)=>Iu(e,t,(n=>{if(n)return o(n);Iu(e.index(gu),t,(e=>o(e||null)))}))))}(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await Du(this._db,nu,fu)||0}async setPreferredSkinTone(e){return Qc(e),await this.ready(),function(e,t,n,o){return Su(e,t,hu,((e,t)=>{e.put(o,n),ju(t)}))}(this._db,nu,fu,e)}async incrementFavoriteEmojiCount(e){return Wc(e),await this.ready(),function(e,t){return Su(e,ou,hu,((e,n)=>Iu(e,t,(o=>{e.put((o||0)+1,t),ju(n)}))))}(this._db,e)}async getTopFavoriteEmoji(e){return Qc(e),await this.ready(),(await function(e,t,n){return 0===n?[]:Su(e,[ou,tu],pu,(([e,o],s,a)=>{const r=[];e.index(iu).openCursor(void 0,"prev").onsuccess=e=>{const s=e.target.result;if(!s)return a(r);function i(e){if(r.push(e),r.length===n)return a(r);s.continue()}const l=s.primaryKey,c=t.byName(l);if(c)return i(c);Iu(o,l,(e=>{if(e)return i(e);s.continue()}))}}))}(this._db,this._custom,e)).map(zu)}set customEmoji(e){this._custom=$u(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await Mu(this._dbName)}async delete(){var e;await this._shutdown(),await(e=this._dbName,new Promise(((t,n)=>{Mu(e),wu(t,n,indexedDB.deleteDatabase(e))})))}}function Zu(){}function Wu(e){return e()}function Qu(){return Object.create(null)}function Ju(e){e.forEach(Wu)}function ed(e){return"function"==typeof e}function td(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let nd,od;function sd(e,t){return nd||(nd=document.createElement("a")),nd.href=t,e===nd.href}function ad(e){return e&&ed(e.destroy)?e.destroy:Zu}function rd(e,t){e.appendChild(t)}function id(e,t,n){e.insertBefore(t,n||null)}function ld(e){e.parentNode.removeChild(e)}function cd(e){return document.createElement(e)}function ud(e){return document.createTextNode(e)}function dd(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function md(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function fd(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function pd(e,t){e.value=null==t?"":t}function hd(e,t,n,o){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function gd(e){od=e}const _d=[],vd=[],bd=[],xd=[],yd=Promise.resolve();let wd=!1;function kd(){wd||(wd=!0,yd.then(Rd))}function Sd(e){bd.push(e)}const Md=new Set;let Ad=0;function Rd(){const e=od;do{for(;Ad<_d.length;){const e=_d[Ad];Ad++,gd(e),Ed(e.$$)}for(gd(null),_d.length=0,Ad=0;vd.length;)vd.pop()();for(let e=0;e<bd.length;e+=1){const t=bd[e];Md.has(t)||(Md.add(t),t())}bd.length=0}while(_d.length);for(;xd.length;)xd.pop()();wd=!1,Md.clear(),gd(e)}function Ed(e){if(null!==e.fragment){e.update(),Ju(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Sd)}}const Td=new Set;const Bd="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Id(e,t){e.d(1),t.delete(e.key)}function Cd(e,t,n,o,s,a,r,i,l,c,u,d){let m=e.length,f=a.length,p=m;const h={};for(;p--;)h[e[p].key]=p;const g=[],_=new Map,v=new Map;for(p=f;p--;){const e=d(s,a,p),i=n(e);let l=r.get(i);l?o&&l.p(e,t):(l=c(i,e),l.c()),_.set(i,g[p]=l),i in h&&v.set(i,Math.abs(p-h[i]))}const b=new Set,x=new Set;function y(e){(function(e,t){e&&e.i&&(Td.delete(e),e.i(t))})(e,1),e.m(i,u),r.set(e.key,e),u=e.first,f--}for(;m&&f;){const t=g[f-1],n=e[m-1],o=t.key,s=n.key;t===n?(u=t.first,m--,f--):_.has(s)?!r.has(o)||b.has(o)?y(t):x.has(s)?m--:v.get(o)>v.get(s)?(x.add(o),y(t)):(b.add(s),m--):(l(n,r),m--)}for(;m--;){const t=e[m];_.has(t.key)||l(t,r)}for(;f;)y(g[f-1]);return g}function jd(e,t,n,o,s,a,r,i=[-1]){const l=od;gd(e);const c=e.$$={fragment:null,ctx:null,props:a,update:Zu,not_equal:s,bound:Qu(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:Qu(),dirty:i,skip_bound:!1,root:t.target||l.$$.root};r&&r(c.root);let u=!1;c.ctx=n?n(e,t.props||{},((t,n,...o)=>{const a=o.length?o[0]:n;return c.ctx&&s(c.ctx[t],c.ctx[t]=a)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](a),u&&function(e,t){-1===e.$$.dirty[0]&&(_d.push(e),kd(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],c.update(),u=!0,Ju(c.before_update),c.fragment=!!o&&o(c.ctx),t.target&&(c.fragment&&c.fragment.c(),function(e,t,n,o){const{fragment:s,on_mount:a,on_destroy:r,after_update:i}=e.$$;s&&s.m(t,n),o||Sd((()=>{const t=a.map(Wu).filter(ed);r?r.push(...t):Ju(t),e.$$.on_mount=[]})),i.forEach(Sd)}(e,t.target,void 0,void 0),Rd()),gd(l)}class Od{$destroy(){(function(e,t){const n=e.$$;null!==n.fragment&&(Ju(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])})(this,1),this.$destroy=Zu}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Fd=[[-1,"","custom"],[0,"","smileys-emotion"],[1,"","people-body"],[3,"","animals-nature"],[4,"","food-drink"],[5,"","travel-places"],[6,"","activities"],[7,"","objects"],[8,"","symbols"],[9,"","flags"]].map((([e,t,n])=>({id:e,emoji:t,name:n}))),Ld=Fd.slice(1),Pd=Fd[0],Dd="function"==typeof requestIdleCallback?requestIdleCallback:setTimeout;function Hd(e){return e.unicode.includes("")}const Nd={"":14,"":13.1,"":12.1,"":11,"":5,"":4,"":3,"":2,"":1,"":.7,"":.6},$d=["","","","","","","","","","","","","",""],zd='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',Vd=(e,t)=>e<t?-1:e>t?1:0,qd=(e,t)=>{const n=document.createElement("canvas");n.width=n.height=1;const o=n.getContext("2d");return o.textBaseline="top",o.font=`100px ${zd}`,o.fillStyle=t,o.scale(.01,.01),o.fillText(e,0,0),o.getImageData(0,0,1,1).data},Ud=(e,t)=>{const n=[...e].join(",");return n===[...t].join(",")&&!n.startsWith("0,0,0,")};function Xd(e){const t=qd(e,"#000"),n=qd(e,"#fff");return t&&n&&Ud(t,n)}const Yd=new Promise((e=>Dd((()=>e(function(){const e=Object.entries(Nd);try{for(const[t,n]of e)if(Xd(t))return n}catch{}return e[0][1]}()))))),Gd=new Map,Kd="",Zd="\ud83c",Wd="",Qd=127995,Jd=57339;function em(e){e.preventDefault(),e.stopPropagation()}function tm(e,t,n){return(t+=e?-1:1)<0?t=n.length-1:t>=n.length&&(t=0),t}function nm(e,t){const n=new Set,o=[];for(const s of e){const e=t(s);n.has(e)||(n.add(e),o.push(s))}return o}const om=requestAnimationFrame;let sm,am="function"==typeof ResizeObserver;function rm(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}const{Map:im}=Bd;function lm(e,t,n){const o=e.slice();return o[63]=t[n],o[65]=n,o}function cm(e,t,n){const o=e.slice();return o[66]=t[n],o[65]=n,o}function um(e,t,n){const o=e.slice();return o[63]=t[n],o[65]=n,o}function dm(e,t,n){const o=e.slice();return o[69]=t[n],o}function mm(e,t,n){const o=e.slice();return o[72]=t[n],o[65]=n,o}function fm(e,t){let n,o,s,a,r,i,l,c=t[72]+"";return{key:e,first:null,c(){n=cd("div"),o=ud(c),md(n,"id",s="skintone-"+t[65]),md(n,"class",a="emoji hide-focus "+(t[65]===t[20]?"active":"")),md(n,"aria-selected",r=t[65]===t[20]),md(n,"role","option"),md(n,"title",i=t[0].skinTones[t[65]]),md(n,"tabindex","-1"),md(n,"aria-label",l=t[0].skinTones[t[65]]),this.first=n},m(e,t){id(e,n,t),rd(n,o)},p(e,u){t=e,512&u[0]&&c!==(c=t[72]+"")&&fd(o,c),512&u[0]&&s!==(s="skintone-"+t[65])&&md(n,"id",s),1049088&u[0]&&a!==(a="emoji hide-focus "+(t[65]===t[20]?"active":""))&&md(n,"class",a),1049088&u[0]&&r!==(r=t[65]===t[20])&&md(n,"aria-selected",r),513&u[0]&&i!==(i=t[0].skinTones[t[65]])&&md(n,"title",i),513&u[0]&&l!==(l=t[0].skinTones[t[65]])&&md(n,"aria-label",l)},d(e){e&&ld(n)}}}function pm(e,t){let n,o,s,a,r,i,l,c,u,d=t[69].emoji+"";function m(){return t[49](t[69])}return{key:e,first:null,c(){n=cd("button"),o=cd("div"),s=ud(d),md(o,"class","nav-emoji emoji"),md(n,"role","tab"),md(n,"class","nav-button"),md(n,"aria-controls",a="tab-"+t[69].id),md(n,"aria-label",r=t[0].categories[t[69].name]),md(n,"aria-selected",i=!t[4]&&t[13].id===t[69].id),md(n,"title",l=t[0].categories[t[69].name]),this.first=n},m(e,t){id(e,n,t),rd(n,o),rd(o,s),c||(u=dd(n,"click",m),c=!0)},p(e,o){t=e,4096&o[0]&&d!==(d=t[69].emoji+"")&&fd(s,d),4096&o[0]&&a!==(a="tab-"+t[69].id)&&md(n,"aria-controls",a),4097&o[0]&&r!==(r=t[0].categories[t[69].name])&&md(n,"aria-label",r),12304&o[0]&&i!==(i=!t[4]&&t[13].id===t[69].id)&&md(n,"aria-selected",i),4097&o[0]&&l!==(l=t[0].categories[t[69].name])&&md(n,"title",l)},d(e){e&&ld(n),c=!1,u()}}}function hm(e){let t,n;return{c(){t=cd("img"),md(t,"class","custom-emoji"),sd(t.src,n=e[63].url)||md(t,"src",n),md(t,"alt",""),md(t,"loading","lazy")},m(e,n){id(e,t,n)},p(e,o){32768&o[0]&&!sd(t.src,n=e[63].url)&&md(t,"src",n)},d(e){e&&ld(t)}}}function gm(e){let t,n=e[27](e[63],e[8])+"";return{c(){t=ud(n)},m(e,n){id(e,t,n)},p(e,o){33024&o[0]&&n!==(n=e[27](e[63],e[8])+"")&&fd(t,n)},d(e){e&&ld(t)}}}function _m(e,t){let n,o,s,a,r,i,l;function c(e,t){return e[63].unicode?gm:hm}let u=c(t),d=u(t);return{key:e,first:null,c(){n=cd("button"),d.c(),md(n,"role",o=t[4]?"option":"menuitem"),md(n,"aria-selected",s=t[4]?t[65]==t[5]:""),md(n,"aria-label",a=t[28](t[63],t[8])),md(n,"title",r=t[63].title),md(n,"class",i="emoji "+(t[4]&&t[65]===t[5]?"active":"")),md(n,"id",l="emo-"+t[63].id),this.first=n},m(e,t){id(e,n,t),d.m(n,null)},p(e,m){u===(u=c(t=e))&&d?d.p(t,m):(d.d(1),d=u(t),d&&(d.c(),d.m(n,null))),16&m[0]&&o!==(o=t[4]?"option":"menuitem")&&md(n,"role",o),32816&m[0]&&s!==(s=t[4]?t[65]==t[5]:"")&&md(n,"aria-selected",s),33024&m[0]&&a!==(a=t[28](t[63],t[8]))&&md(n,"aria-label",a),32768&m[0]&&r!==(r=t[63].title)&&md(n,"title",r),32816&m[0]&&i!==(i="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&md(n,"class",i),32768&m[0]&&l!==(l="emo-"+t[63].id)&&md(n,"id",l)},d(e){e&&ld(n),d.d()}}}function vm(e,t){let n,o,s,a,r,i,l,c,u=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",d=[],m=new im,f=t[66].emojis;const p=e=>e[63].id;for(let e=0;e<f.length;e+=1){let n=um(t,f,e),o=p(n);m.set(o,d[e]=_m(o,n))}return{key:e,first:null,c(){n=cd("div"),o=ud(u),r=cd("div");for(let e=0;e<d.length;e+=1)d[e].c();md(n,"id",s="menu-label-"+t[65]),md(n,"class",a="category "+(1===t[15].length&&""===t[15][0].category?"gone":"")),md(n,"aria-hidden","true"),md(r,"class","emoji-menu"),md(r,"role",i=t[4]?"listbox":"menu"),md(r,"aria-labelledby",l="menu-label-"+t[65]),md(r,"id",c=t[4]?"search-results":""),this.first=n},m(e,t){id(e,n,t),rd(n,o),id(e,r,t);for(let e=0;e<d.length;e+=1)d[e].m(r,null)},p(e,h){t=e,40977&h[0]&&u!==(u=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&fd(o,u),32768&h[0]&&s!==(s="menu-label-"+t[65])&&md(n,"id",s),32768&h[0]&&a!==(a="category "+(1===t[15].length&&""===t[15][0].category?"gone":""))&&md(n,"class",a),402686256&h[0]&&(f=t[66].emojis,d=Cd(d,h,p,1,t,f,m,r,Id,_m,null,um)),16&h[0]&&i!==(i=t[4]?"listbox":"menu")&&md(r,"role",i),32768&h[0]&&l!==(l="menu-label-"+t[65])&&md(r,"aria-labelledby",l),16&h[0]&&c!==(c=t[4]?"search-results":"")&&md(r,"id",c)},d(e){e&&ld(n),e&&ld(r);for(let e=0;e<d.length;e+=1)d[e].d()}}}function bm(e){let t,n;return{c(){t=cd("img"),md(t,"class","custom-emoji"),sd(t.src,n=e[63].url)||md(t,"src",n),md(t,"alt",""),md(t,"loading","lazy")},m(e,n){id(e,t,n)},p(e,o){1024&o[0]&&!sd(t.src,n=e[63].url)&&md(t,"src",n)},d(e){e&&ld(t)}}}function xm(e){let t,n=e[27](e[63],e[8])+"";return{c(){t=ud(n)},m(e,n){id(e,t,n)},p(e,o){1280&o[0]&&n!==(n=e[27](e[63],e[8])+"")&&fd(t,n)},d(e){e&&ld(t)}}}function ym(e,t){let n,o,s,a;function r(e,t){return e[63].unicode?xm:bm}let i=r(t),l=i(t);return{key:e,first:null,c(){n=cd("button"),l.c(),md(n,"role","menuitem"),md(n,"aria-label",o=t[28](t[63],t[8])),md(n,"title",s=t[63].title),md(n,"class","emoji"),md(n,"id",a="fav-"+t[63].id),this.first=n},m(e,t){id(e,n,t),l.m(n,null)},p(e,c){i===(i=r(t=e))&&l?l.p(t,c):(l.d(1),l=i(t),l&&(l.c(),l.m(n,null))),1280&c[0]&&o!==(o=t[28](t[63],t[8]))&&md(n,"aria-label",o),1024&c[0]&&s!==(s=t[63].title)&&md(n,"title",s),1024&c[0]&&a!==(a="fav-"+t[63].id)&&md(n,"id",a)},d(e){e&&ld(n),l.d()}}}function wm(e){let t,n,o,s,a,r,i,l,c,u,d,m,f,p,h,g,_,v,b,x,y,w,k,S,M,A,R,E,T,B,I,C,j,O,F,L,P,D,H,N,$,z,V,q,U=e[0].searchLabel+"",X=e[0].searchDescription+"",Y=e[0].skinToneDescription+"",G=[],K=new im,Z=[],W=new im,Q=[],J=new im,ee=[],te=new im,ne=e[9];const oe=e=>e[72];for(let t=0;t<ne.length;t+=1){let n=mm(e,ne,t),o=oe(n);K.set(o,G[t]=fm(o,n))}let se=e[12];const ae=e=>e[69].id;for(let t=0;t<se.length;t+=1){let n=dm(e,se,t),o=ae(n);W.set(o,Z[t]=pm(o,n))}let re=e[15];const ie=e=>e[66].category;for(let t=0;t<re.length;t+=1){let n=cm(e,re,t),o=ie(n);J.set(o,Q[t]=vm(o,n))}let le=e[10];const ce=e=>e[63].id;for(let t=0;t<le.length;t+=1){let n=lm(e,le,t),o=ce(n);te.set(o,ee[t]=ym(o,n))}return{c(){t=cd("section"),n=cd("div"),o=cd("div"),s=cd("div"),a=cd("input"),c=cd("label"),u=ud(U),d=cd("span"),m=ud(X),f=cd("div"),p=cd("button"),h=ud(e[21]),v=cd("span"),b=ud(Y),x=cd("div");for(let e=0;e<G.length;e+=1)G[e].c();M=cd("div");for(let e=0;e<Z.length;e+=1)Z[e].c();R=cd("div"),E=cd("div"),T=cd("div"),B=ud(e[18]),C=cd("div"),j=cd("div");for(let e=0;e<Q.length;e+=1)Q[e].c();D=cd("div");for(let e=0;e<ee.length;e+=1)ee[e].c();$=cd("button"),$.textContent="",md(n,"class","pad-top"),md(a,"id","search"),md(a,"class","search"),md(a,"type","search"),md(a,"role","combobox"),md(a,"enterkeyhint","search"),md(a,"placeholder",r=e[0].searchLabel),md(a,"autocapitalize","none"),md(a,"autocomplete","off"),md(a,"spellcheck","true"),md(a,"aria-expanded",i=!(!e[4]||!e[1].length)),md(a,"aria-controls","search-results"),md(a,"aria-describedby","search-description"),md(a,"aria-autocomplete","list"),md(a,"aria-activedescendant",l=e[26]?`emo-${e[26]}`:""),md(c,"class","sr-only"),md(c,"for","search"),md(d,"id","search-description"),md(d,"class","sr-only"),md(s,"class","search-wrapper"),md(p,"id","skintone-button"),md(p,"class",g="emoji "+(e[6]?"hide-focus":"")),md(p,"aria-label",e[23]),md(p,"title",e[23]),md(p,"aria-describedby","skintone-description"),md(p,"aria-haspopup","listbox"),md(p,"aria-expanded",e[6]),md(p,"aria-controls","skintone-list"),md(f,"class",_="skintone-button-wrapper "+(e[19]?"expanded":"")),md(v,"id","skintone-description"),md(v,"class","sr-only"),md(x,"id","skintone-list"),md(x,"class",y="skintone-list "+(e[6]?"":"hidden no-animate")),hd(x,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),md(x,"role","listbox"),md(x,"aria-label",w=e[0].skinTonesLabel),md(x,"aria-activedescendant",k="skintone-"+e[20]),md(x,"aria-hidden",S=!e[6]),md(o,"class","search-row"),md(M,"class","nav"),md(M,"role","tablist"),hd(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),md(M,"aria-label",A=e[0].categoriesLabel),md(E,"class","indicator"),hd(E,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),md(R,"class","indicator-wrapper"),md(T,"class",I="message "+(e[18]?"":"gone")),md(T,"role","alert"),md(T,"aria-live","polite"),md(C,"class",O="tabpanel "+(!e[14]||e[18]?"gone":"")),md(C,"role",F=e[4]?"region":"tabpanel"),md(C,"aria-label",L=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),md(C,"id",P=e[4]?"":`tab-${e[13].id}`),md(C,"tabindex","0"),md(D,"class",H="favorites emoji-menu "+(e[18]?"gone":"")),md(D,"role","menu"),md(D,"aria-label",N=e[0].favoritesLabel),hd(D,"padding-inline-end",e[25]+"px"),md($,"aria-hidden","true"),md($,"tabindex","-1"),md($,"class","abs-pos hidden emoji"),md(t,"class","picker"),md(t,"aria-label",z=e[0].regionLabel),md(t,"style",e[22])},m(r,i){id(r,t,i),rd(t,n),rd(t,o),rd(o,s),rd(s,a),pd(a,e[2]),rd(s,c),rd(c,u),rd(s,d),rd(d,m),rd(o,f),rd(f,p),rd(p,h),rd(o,v),rd(v,b),rd(o,x);for(let e=0;e<G.length;e+=1)G[e].m(x,null);e[48](x),rd(t,M);for(let e=0;e<Z.length;e+=1)Z[e].m(M,null);rd(t,R),rd(R,E),rd(t,T),rd(T,B),rd(t,C),rd(C,j);for(let e=0;e<Q.length;e+=1)Q[e].m(j,null);e[50](C),rd(t,D);for(let e=0;e<ee.length;e+=1)ee[e].m(D,null);rd(t,$),e[51]($),e[52](t),V||(q=[dd(a,"input",e[47]),dd(a,"keydown",e[30]),dd(p,"click",e[35]),dd(x,"focusout",e[38]),dd(x,"click",e[34]),dd(x,"keydown",e[36]),dd(x,"keyup",e[37]),dd(M,"keydown",e[32]),ad(e[29].call(null,j)),dd(C,"click",e[33]),dd(D,"click",e[33])],V=!0)},p(e,n){1&n[0]&&r!==(r=e[0].searchLabel)&&md(a,"placeholder",r),18&n[0]&&i!==(i=!(!e[4]||!e[1].length))&&md(a,"aria-expanded",i),67108864&n[0]&&l!==(l=e[26]?`emo-${e[26]}`:"")&&md(a,"aria-activedescendant",l),4&n[0]&&pd(a,e[2]),1&n[0]&&U!==(U=e[0].searchLabel+"")&&fd(u,U),1&n[0]&&X!==(X=e[0].searchDescription+"")&&fd(m,X),2097152&n[0]&&fd(h,e[21]),64&n[0]&&g!==(g="emoji "+(e[6]?"hide-focus":""))&&md(p,"class",g),8388608&n[0]&&md(p,"aria-label",e[23]),8388608&n[0]&&md(p,"title",e[23]),64&n[0]&&md(p,"aria-expanded",e[6]),524288&n[0]&&_!==(_="skintone-button-wrapper "+(e[19]?"expanded":""))&&md(f,"class",_),1&n[0]&&Y!==(Y=e[0].skinToneDescription+"")&&fd(b,Y),1049089&n[0]&&(ne=e[9],G=Cd(G,n,oe,1,e,ne,K,x,Id,fm,null,mm)),64&n[0]&&y!==(y="skintone-list "+(e[6]?"":"hidden no-animate"))&&md(x,"class",y),64&n[0]&&hd(x,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),1&n[0]&&w!==(w=e[0].skinTonesLabel)&&md(x,"aria-label",w),1048576&n[0]&&k!==(k="skintone-"+e[20])&&md(x,"aria-activedescendant",k),64&n[0]&&S!==(S=!e[6])&&md(x,"aria-hidden",S),12305&n[0]|1&n[1]&&(se=e[12],Z=Cd(Z,n,ae,1,e,se,W,M,Id,pm,null,dm)),4096&n[0]&&hd(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),1&n[0]&&A!==(A=e[0].categoriesLabel)&&md(M,"aria-label",A),16779264&n[0]&&hd(E,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),262144&n[0]&&fd(B,e[18]),262144&n[0]&&I!==(I="message "+(e[18]?"":"gone"))&&md(T,"class",I),402694449&n[0]&&(re=e[15],Q=Cd(Q,n,ie,1,e,re,J,j,Id,vm,null,cm)),278528&n[0]&&O!==(O="tabpanel "+(!e[14]||e[18]?"gone":""))&&md(C,"class",O),16&n[0]&&F!==(F=e[4]?"region":"tabpanel")&&md(C,"role",F),8209&n[0]&&L!==(L=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name])&&md(C,"aria-label",L),8208&n[0]&&P!==(P=e[4]?"":`tab-${e[13].id}`)&&md(C,"id",P),402654464&n[0]&&(le=e[10],ee=Cd(ee,n,ce,1,e,le,te,D,Id,ym,null,lm)),262144&n[0]&&H!==(H="favorites emoji-menu "+(e[18]?"gone":""))&&md(D,"class",H),1&n[0]&&N!==(N=e[0].favoritesLabel)&&md(D,"aria-label",N),33554432&n[0]&&hd(D,"padding-inline-end",e[25]+"px"),1&n[0]&&z!==(z=e[0].regionLabel)&&md(t,"aria-label",z),4194304&n[0]&&md(t,"style",e[22])},i:Zu,o:Zu,d(n){n&&ld(t);for(let e=0;e<G.length;e+=1)G[e].d();e[48](null);for(let e=0;e<Z.length;e+=1)Z[e].d();for(let e=0;e<Q.length;e+=1)Q[e].d();e[50](null);for(let e=0;e<ee.length;e+=1)ee[e].d();e[51](null),e[52](null),V=!1,Ju(q)}}}function km(e,t,n){let o,s,a,r,i,l,c,u,d,m,{skinToneEmoji:f}=t,{i18n:p}=t,{database:h}=t,{customEmoji:g}=t,{customCategorySorting:_}=t,v=[],b=[],x="",y="",w=!1,k=-1,S=!1,M=!1,A=0,R=0,E="",T=[],B=[],I=8,C=!1,j=0,O=0,F=Ld,L=!1;const P=e=>{o.getRootNode().getElementById(e).focus()},D=(e,t)=>{o.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},H=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,N=e=>/^skintone-/.test(e.id);function $(e){const t=o.getRootNode();(function(e,t,n){for(const o of e){const e=rm(n(o));void 0===sm&&(sm=rm(t));const s=e/1.8<sm;Gd.set(o.unicode,s)}})(e,s,(e=>t.getElementById(`emo-${e.id}`))),n(1,v)}function z(e){return!e.unicode||!Hd(e)||Gd.get(e.unicode)}async function V(e){const t=await Yd;return e.filter((({version:e})=>!e||e<=t))}async function q(e){return function(e,t){const n=e=>{const n={};for(const o of e)"number"==typeof o.tone&&o.version<=t&&(n[o.tone]=o.unicode);return n};return e.map((({unicode:e,skins:t,shortcodes:o,url:s,name:a,category:r})=>({unicode:e,name:a,shortcodes:o,url:s,category:r,id:e||a,skins:t&&n(t),title:(o||[]).join(", ")})))}(e,await Yd)}function U(e){n(2,x=""),n(44,y=""),n(5,k=-1),n(11,O=F.findIndex((t=>t.id===e.id)))}async function X(e){const t=await h.getEmojiByUnicodeOrName(e),n=[...v,...B].find((t=>t.id===e)),o=n.unicode&&H(n,A);await h.incrementFavoriteEmojiCount(e),D("emoji-click",{emoji:t,skinTone:A,...o&&{unicode:o},...n.name&&{name:n.name}})}async function Y(e){const{target:t}=e;if(!N(t))return;em(e);const o=parseInt(t.id.slice(9),10);n(8,A=o),n(6,S=!1),P("skintone-button"),D("skin-tone-change",{skinTone:o}),h.setPreferredSkinTone(o)}Yd.then((e=>{e||n(18,r=p.emojiUnsupportedMessage)}));return e.$$set=e=>{"skinToneEmoji"in e&&n(40,f=e.skinToneEmoji),"i18n"in e&&n(0,p=e.i18n),"database"in e&&n(39,h=e.database),"customEmoji"in e&&n(41,g=e.customEmoji),"customCategorySorting"in e&&n(42,_=e.customCategorySorting)},e.$$.update=()=>{if(1280&e.$$.dirty[1]&&g&&h&&n(39,h.customEmoji=g,h),1&e.$$.dirty[0]|256&e.$$.dirty[1]){async function t(){let e=!1;const t=setTimeout((()=>{e=!0,n(18,r=p.loadingMessage)}),1e3);try{await h.ready(),n(14,L=!0)}catch(e){console.error(e),n(18,r=p.networkErrorMessage)}finally{clearTimeout(t),e&&(e=!1,n(18,r=""))}}h&&t()}if(6144&e.$$.dirty[0]|1024&e.$$.dirty[1]&&(g&&g.length?n(12,F=[Pd,...Ld]):F!==Ld&&(O&&n(11,O--,O),n(12,F=Ld))),4&e.$$.dirty[0]&&Dd((()=>{n(44,y=(x||"").trim()),n(5,k=-1)})),6144&e.$$.dirty[0]&&n(13,d=F[O]),24576&e.$$.dirty[0]|8192&e.$$.dirty[1]){async function o(){if(L){if(y.length>=2){const e=y,t=await async function(e){return q(await V(await h.getEmojiBySearchQuery(e)))}(e);e===y&&(n(1,v=t),n(4,w=!0))}else if(d){const e=d.id,t=await async function(e){if(void 0===e)return[];const t=-1===e?g:await h.getEmojiByGroup(e);return q(await V(t))}(e);e===d.id&&(n(1,v=t),n(4,w=!1))}}else n(1,v=[]),n(4,w=!1)}o()}if(4112&e.$$.dirty[0]&&n(22,c=`\n  --font-family: ${zd};\n  --num-groups: ${F.length}; \n  --indicator-opacity: ${w?0:1}; \n  --num-skintones: 6;`),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function s(){L&&n(8,A=await h.getPreferredSkinTone())}s()}if(512&e.$$.dirty[1]&&n(9,T=Array(6).fill().map(((e,t)=>function(e,t){if(0===t)return e;const n=e.indexOf(Wd);return-1!==n?e.substring(0,n)+String.fromCodePoint(Qd+t-1)+e.substring(n):(e.endsWith(Kd)&&(e=e.substring(0,e.length-1)),e+Zd+String.fromCodePoint(Jd+t-1))}(f,t)))),768&e.$$.dirty[0]&&n(21,l=T[A]),257&e.$$.dirty[0]&&n(23,E=p.skinToneLabel.replace("{skinTone}",p.skinTones[A])),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function R(){n(45,u=(await Promise.all($d.map((e=>h.getEmojiByUnicodeOrName(e))))).filter(Boolean))}L&&R()}if(16384&e.$$.dirty[0]|49408&e.$$.dirty[1]){async function C(){const e=await h.getTopFavoriteEmoji(I),t=await q(nm([...e,...u],(e=>e.unicode||e.name)).slice(0,I));n(10,B=t)}L&&u&&C()}if(10&e.$$.dirty[0]){const j=v.filter((e=>e.unicode)).filter((e=>Hd(e)&&!Gd.has(e.unicode)));j.length?om((()=>$(j))):(n(1,v=v.filter(z)),om((()=>{(a||{}).scrollTop=0})))}e.$$.dirty[0],e.$$.dirty[1],18&e.$$.dirty[0]|2048&e.$$.dirty[1]&&n(15,b=function(){if(w)return[{category:"",emojis:v}];const e=new Map;for(const t of v){const n=t.category||"";let o=e.get(n);o||(o=[],e.set(n,o)),o.push(t)}return[...e.entries()].map((([e,t])=>({category:e,emojis:t}))).sort(((e,t)=>_(e.category,t.category)))}()),34&e.$$.dirty[0]&&n(26,m=-1!==k&&v[k].id),192&e.$$.dirty[0]&&(S?i.addEventListener("transitionend",(()=>{n(19,M=!0)}),{once:!0}):n(19,M=!1))},[p,v,x,a,w,k,S,i,A,T,B,O,F,d,L,b,o,s,r,M,R,l,c,E,C,j,m,H,(e,t)=>function(e){return nm(e,(e=>e))}([e.name||H(e,t),...e.shortcodes||[]]).join(", "),function(e){return function(e,t){let n;return am?(n=new ResizeObserver((e=>t(e[0].contentRect.width))),n.observe(e)):om((()=>t(e.getBoundingClientRect().width))),{destroy(){n&&n.disconnect()}}}(e,(t=>{{const s=getComputedStyle(o),a=parseInt(s.getPropertyValue("--num-columns"),10),r="rtl"===s.getPropertyValue("direction"),i=e.parentElement.getBoundingClientRect().width-t;n(46,I=a),n(25,j=i),n(24,C=r)}}))},function(e){if(!w||!v.length)return;const t=t=>{em(e),n(5,k=tm(t,k,v))};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==k)return em(e),X(v[k].id);v.length&&n(5,k=0)}},U,function(e){const{target:t,key:n}=e,o=t=>{t&&(em(e),t.focus())};switch(n){case"ArrowLeft":return o(t.previousSibling);case"ArrowRight":return o(t.nextSibling);case"Home":return o(t.parentElement.firstChild);case"End":return o(t.parentElement.lastChild)}},async function(e){const{target:t}=e;if(!t.classList.contains("emoji"))return;em(e),X(t.id.substring(4))},Y,async function(e){n(6,S=!S),n(20,R=A),S&&(em(e),om((()=>P(`skintone-${R}`))))},function(e){if(!S)return;const t=async t=>{em(e),n(20,R=t),await(kd(),yd),P(`skintone-${R}`)};switch(e.key){case"ArrowUp":return t(tm(!0,R,T));case"ArrowDown":return t(tm(!1,R,T));case"Home":return t(0);case"End":return t(T.length-1);case"Enter":return Y(e);case"Escape":return em(e),n(6,S=!1),P("skintone-button")}},function(e){if(S&&" "===e.key)return Y(e)},async function(e){const{relatedTarget:t}=e;(!t||!N(t))&&n(6,S=!1)},h,f,g,_,!0,y,u,I,function(){x=this.value,n(2,x)},function(e){vd[e?"unshift":"push"]((()=>{i=e,n(7,i)}))},e=>U(e),function(e){vd[e?"unshift":"push"]((()=>{a=e,n(3,a)}))},function(e){vd[e?"unshift":"push"]((()=>{s=e,n(17,s)}))},function(e){vd[e?"unshift":"push"]((()=>{o=e,n(16,o)}))}]}class Sm extends Od{constructor(e){super(),jd(this,e,km,wm,td,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}var Mm={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const Am=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class Rm extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(t),this._ctx={locale:"en",dataSource:"https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",skinToneEmoji:"",customCategorySorting:Vd,customEmoji:null,i18n:Mm,...e};for(const e of Am)"database"!==e&&Object.prototype.hasOwnProperty.call(this,e)&&(this._ctx[e]=this[e],delete this[e]);this._dbFlush()}connectedCallback(){this._cmp=new Sm({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e&&e.close().catch((e=>console.error(e)))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(e,t,n){this._set(e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase())),n)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:n}=this._ctx;(!n||n.locale!==e||n.dataSource!==t)&&this._set("database",new Ku({locale:e,dataSource:t}))}_dbFlush(){Promise.resolve().then((()=>this._dbCreate()))}}const Em={};for(const e of Am)Em[e]={get(){return"database"===e&&this._dbCreate(),this._ctx[e]},set(t){if("database"===e)throw new Error("database is read-only");this._set(e,t)}};function Tm(e,t){for(;e&&!e.querySelector(t);){const n=(e=e.parentNode).querySelector(t);if(n)return n}return null}Object.defineProperties(Rm.prototype,Em),customElements.get("emoji-picker")||customElements.define("emoji-picker",Rm);const Bm={name:"EmojiPickerContainer",components:{SvgIcon:Qa},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data:()=>({emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}),watch:{emojiOpened(e){e&&setTimeout((()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",(({detail:e})=>{this.$emit("add-emoji",{unicode:e.unicode})}))}),0)}},methods:{addCustomStyling(){const e=document.createElement("style");e.textContent=".picker {\n\t\t\t\tborder: none;\n\t\t\t}.nav {\n\t\t\t\toverflow-x: auto;\n\t\t\t}.search-wrapper {\n\t\t\t\tpadding-right: 2px;\n\t\t\t\tpadding-left: 2px;\n\t\t\t}input.search {\n\t\t\t\theight: 32px;\n\t\t\t\tfont-size: 14px;\n\t\t\t\tborder-radius: 10rem;\n\t\t\t\tborder: var(--chat-border-style);\n\t\t\t\tpadding: 5px 10px;\n\t\t\t\toutline: none;\n\t\t\t\tbackground: var(--chat-bg-color-input);\n\t\t\t\tcolor: var(--chat-color);\n\t\t\t}",this.$refs.emojiPicker.shadowRoot.appendChild(e)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,n){const o=t<500||n<700,s=Tm(this.$el,"#room-footer");s?o?(this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=n-200):(s.getBoundingClientRect().top-e>this.emojiPickerHeight-50?this.emojiPickerTop=e+10:this.emojiPickerTop=e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":""):o&&(this.emojiPickerRight="-50px")}}},Im={class:"vac-emoji-wrapper"};var Cm=Na(Bm,[["render",function(e,t,n,o,s,a){const r=Un("svg-icon"),i=Un("emoji-picker");return Uo(),Ko("div",Im,[ns("div",{class:Ne(["vac-svg-button",{"vac-emoji-reaction":n.emojiReaction}]),onClick:t[0]||(t[0]=(...e)=>a.openEmoji&&a.openEmoji(...e))},[Jn(e.$slots,n.messageId?"emoji-picker-reaction-icon_"+n.messageId:"emoji-picker-icon",{},(()=>[os(r,{name:"emoji",param:n.emojiReaction?"reaction":""},null,8,["param"])]))],2),n.emojiOpened?(Uo(),Zo(la,{key:0,name:"vac-slide-up",appear:""},{default:tn((()=>[ns("div",{class:Ne(["vac-emoji-picker",{"vac-picker-reaction":n.emojiReaction}]),style:Le({height:`${s.emojiPickerHeight}px`,top:n.positionTop?s.emojiPickerHeight:`${s.emojiPickerTop}px`,right:s.emojiPickerRight,display:s.emojiPickerTop||!n.emojiReaction?"initial":"none"})},[n.emojiOpened?(Uo(),Zo(i,{key:0,ref:"emojiPicker","data-source":n.emojiDataSource},null,8,["data-source"])):is("",!0)],6)])),_:1})):is("",!0)])}]]);const jm={class:"vac-room-file-container"},Om=["src"],Fm={class:"vac-text-ellipsis"},Lm={key:0,class:"vac-text-ellipsis vac-text-extension"};var Pm=Na({name:"RoomFiles",components:{Loader:Ga,SvgIcon:Qa},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return uc(this.file)},isVideo(){return dc(this.file)}}},[["render",function(e,t,n,o,s,a){const r=Un("loader"),i=Un("svg-icon");return Uo(),Ko("div",jm,[os(r,{show:n.file.loading,type:"room-file"},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["show"]),ns("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=t=>e.$emit("remove-file",n.index))},[Jn(e.$slots,"image-close-icon",{},(()=>[os(i,{name:"close",param:"image"})]))]),a.isImage?(Uo(),Ko("div",{key:0,class:Ne(["vac-message-image",{"vac-blur-loading":n.file.loading}]),style:Le({"background-image":`url('${n.file.localUrl||n.file.url}')`})},null,6)):a.isVideo?(Uo(),Ko("video",{key:1,controls:"",class:Ne({"vac-blur-loading":n.file.loading})},[ns("source",{src:n.file.localUrl||n.file.url},null,8,Om)],2)):(Uo(),Ko("div",{key:2,class:Ne(["vac-file-container",{"vac-blur-loading":n.file.loading}])},[ns("div",null,[Jn(e.$slots,"file-icon",{},(()=>[os(i,{name:"file"})]))]),ns("div",Fm,ze(n.file.name),1),n.file.extension?(Uo(),Ko("div",Lm,ze(n.file.extension),1)):is("",!0)],2))])}]]);const Dm={key:0,class:"vac-room-files-container"},Hm={class:"vac-files-box"},Nm={class:"vac-icon-close"};var $m=Na({name:"RoomFiles",components:{SvgIcon:Qa,RoomFile:Pm},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},[["render",function(e,t,n,o,s,a){const r=Un("room-file"),i=Un("svg-icon");return Uo(),Zo(la,{name:"vac-slide-up"},{default:tn((()=>[n.files.length?(Uo(),Ko("div",Dm,[ns("div",Hm,[(Uo(!0),Ko(Ho,null,Wn(n.files,((n,o)=>(Uo(),Ko("div",{key:o},[os(r,{file:n,index:o,onRemoveFile:t[0]||(t[0]=t=>e.$emit("remove-file",t))},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["file","index"])])))),128))]),ns("div",Nm,[ns("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=t=>e.$emit("reset-message"))},[Jn(e.$slots,"files-close-icon",{},(()=>[os(i,{name:"close-outline"})]))])])])):is("",!0)])),_:3})}]]);const zm={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data:()=>({isMouseDown:!1}),methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const n=t.getBoundingClientRect().width,o=t.getBoundingClientRect().left;let s=(e.clientX-o)/n;return s=s<0?0:s,s=s>1?1:s,s}}},Vm={class:"vac-player-progress"},qm={class:"vac-line-container"};const Um={name:"AudioPlayer",components:{SvgIcon:Qa,AudioControl:Na(zm,[["render",function(e,t,n,o,s,a){return Uo(),Ko("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...e)=>a.onMouseDown&&a.onMouseDown(...e)),onMouseover:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=t=>e.$emit("hover-audio-progress",!1))},[ns("div",Vm,[ns("div",qm,[ns("div",{class:"vac-line-progress",style:Le({width:`${n.percentage}%`})},null,4),ns("div",{class:Ne(["vac-line-dot",{"vac-line-dot__active":s.isMouseDown}]),style:Le({left:`${n.percentage}%`})},null,6)])])],544)}]])},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",(()=>{this.isPlaying=!1})),this.player.addEventListener("loadeddata",(()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()})),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS:e=>new Date(1e3*e).toISOString().substr(14,5),playback(){this.messageSelectionEnabled||!this.audioSource||(this.isPlaying?this.player.pause():setTimeout((()=>this.player.play())),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},Xm={class:"vac-audio-player"},Ym=["id","src"];var Gm=Na(Um,[["render",function(e,t,n,o,s,a){const r=Un("svg-icon"),i=Un("audio-control");return Uo(),Ko("div",null,[ns("div",Xm,[ns("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...e)=>a.playback&&a.playback(...e))},[s.isPlaying?Jn(e.$slots,"audio-pause-icon_"+n.messageId,{key:0},(()=>[os(r,{name:"audio-pause"})])):Jn(e.$slots,"audio-play-icon_"+n.messageId,{key:1},(()=>[os(r,{name:"audio-play"})]))]),os(i,{percentage:s.progress,"message-selection-enabled":n.messageSelectionEnabled,onChangeLinehead:a.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",t))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),ns("audio",{id:a.playerUniqId,src:a.audioSource},null,8,Ym)])])}]]);const Km={key:0,class:"vac-reply-container"},Zm={class:"vac-reply-box"},Wm={class:"vac-reply-info"},Qm={class:"vac-reply-username"},Jm={class:"vac-reply-content"},ef=["src"],tf={key:1,controls:"",class:"vac-image-reply"},nf=["src"],of={key:3,class:"vac-image-reply vac-file-container"},sf={class:"vac-text-ellipsis"},af={key:0,class:"vac-text-ellipsis vac-text-extension"},rf={class:"vac-icon-reply"};var lf=Na({name:"RoomMessageReply",components:{SvgIcon:Qa,FormatMessage:Jl,AudioPlayer:Gm},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return null!=(t=null==(e=this.messageReply)?void 0:e.files)&&t.length?this.messageReply.files[0]:{}},isImage(){return uc(this.firstFile)},isVideo(){return dc(this.firstFile)},isAudio(){return fc(this.firstFile)},isOtherFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},[["render",function(e,t,n,o,s,a){const r=Un("format-message"),i=Un("audio-player"),l=Un("svg-icon");return Uo(),Zo(la,{name:"vac-slide-up"},{default:tn((()=>[n.messageReply?(Uo(),Ko("div",Km,[ns("div",Zm,[ns("div",Wm,[ns("div",Qm,ze(n.messageReply.username),1),ns("div",Jm,[os(r,{"message-id":n.messageReply._id,content:n.messageReply.content,users:n.room.users,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),a.isImage?(Uo(),Ko("img",{key:0,src:a.firstFile.url,class:"vac-image-reply"},null,8,ef)):a.isVideo?(Uo(),Ko("video",tf,[ns("source",{src:a.firstFile.url},null,8,nf)])):a.isAudio?(Uo(),Zo(i,{key:2,src:a.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["src"])):a.isOtherFile?(Uo(),Ko("div",of,[ns("div",null,[Jn(e.$slots,"file-icon",{},(()=>[os(l,{name:"file"})]))]),ns("div",sf,ze(a.firstFile.name),1),a.firstFile.extension?(Uo(),Ko("div",af,ze(a.firstFile.extension),1)):is("",!0)])):is("",!0)]),ns("div",rf,[ns("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=t=>e.$emit("reset-message"))},[Jn(e.$slots,"reply-close-icon",{},(()=>[os(l,{name:"close-outline"})]))])])])):is("",!0)])),_:3})}]]);const cf={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data:()=>({activeItem:null}),watch:{filteredUsersTag(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},uf={key:0,class:"vac-tags-container"},df=["onMouseover","onClick"],mf={class:"vac-tags-info"},ff={class:"vac-tags-username"};var pf=Na(cf,[["render",function(e,t,n,o,s,a){return Uo(),Zo(la,{name:"vac-slide-up"},{default:tn((()=>[n.filteredUsersTag.length?(Uo(),Ko("div",uf,[(Uo(!0),Ko(Ho,null,Wn(n.filteredUsersTag,((t,n)=>(Uo(),Ko("div",{key:t._id,class:Ne(["vac-tags-box",{"vac-tags-box-active":n===s.activeItem}]),onMouseover:e=>s.activeItem=n,onClick:n=>e.$emit("select-user-tag",t)},[ns("div",mf,[t.avatar?(Uo(),Ko("div",{key:0,class:"vac-avatar vac-tags-avatar",style:Le({"background-image":`url('${t.avatar}')`})},null,4)):is("",!0),ns("div",ff,ze(t.username),1)])],42,df)))),128))])):is("",!0)])),_:1})}]]);const hf={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data:()=>({activeItem:null}),watch:{filteredEmojis(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},gf={key:0,class:"vac-emojis-container"},_f=["onMouseover","onClick"];var vf=Na(hf,[["render",function(e,t,n,o,s,a){return Uo(),Zo(la,{name:"vac-slide-up"},{default:tn((()=>[n.filteredEmojis.length?(Uo(),Ko("div",gf,[(Uo(!0),Ko(Ho,null,Wn(n.filteredEmojis,((t,n)=>(Uo(),Ko("div",{key:t,class:Ne(["vac-emoji-element",{"vac-emoji-element-active":n===s.activeItem}]),onMouseover:e=>s.activeItem=n,onClick:n=>e.$emit("select-emoji",t)},ze(t),43,_f)))),128))])):is("",!0)])),_:1})}]]);const bf={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data:()=>({activeItem:null}),watch:{filteredTemplatesText(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},xf={key:0,class:"vac-template-container vac-app-box-shadow"},yf=["onMouseover","onClick"],wf={class:"vac-template-info"},kf={class:"vac-template-tag"},Sf={class:"vac-template-text"};var Mf=Na(bf,[["render",function(e,t,n,o,s,a){return Uo(),Zo(la,{name:"vac-slide-up"},{default:tn((()=>[n.filteredTemplatesText.length?(Uo(),Ko("div",xf,[(Uo(!0),Ko(Ho,null,Wn(n.filteredTemplatesText,((t,n)=>(Uo(),Ko("div",{key:n,class:Ne(["vac-template-box",{"vac-template-active":n===s.activeItem}]),onMouseover:e=>s.activeItem=n,onClick:n=>e.$emit("select-template-text",t)},[ns("div",wf,[ns("div",kf," /"+ze(t.tag),1),ns("div",Sf,ze(t.text),1)])],42,yf)))),128))])):is("",!0)])),_:1})}]]);function Af(e){return new Int16Array(e)}function Rf(e){return new Int32Array(e)}function Ef(e){return new Float32Array(e)}var Tf={fill:function(e,t,n,o){if(2==arguments.length)for(var s=0;s<e.length;s++)e[s]=arguments[1];else for(s=t;s<n;s++)e[s]=o}},Bf={arraycopy:function(e,t,n,o,s){for(var a=t+s;t<a;)n[o++]=e[t++]},out:{}};Bf.out.println=function(e){console.log(e)},Bf.out.printf=function(){console.log.apply(console,arguments)};var If={};function Cf(e){this.ordinal=e}If.SQRT2=1.4142135623730951,If.FAST_LOG10=function(e){return Math.log10(e)},If.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},Cf.short_block_allowed=new Cf(0),Cf.short_block_coupled=new Cf(1),Cf.short_block_dispensed=new Cf(2),Cf.short_block_forced=new Cf(3);var jf={};function Of(e){this.ordinal=e}jf.MAX_VALUE=34028235e31,Of.vbr_off=new Of(0),Of.vbr_mt=new Of(1),Of.vbr_rh=new Of(2),Of.vbr_abr=new Of(3),Of.vbr_mtrh=new Of(4),Of.vbr_default=Of.vbr_mtrh;var Ff={System:Bf,VbrMode:Of,Float:jf,ShortBlock:Cf,Util:If,Arrays:Tf,new_array_n:function e(t){if(1==t.length)return new Array(t[0]);var n=t[0];t=t.slice(1);for(var o=[],s=0;s<n;s++)o.push(e(t));return o},new_byte:function(e){return new Int8Array(e)},new_double:function(e){return new Float64Array(e)},new_float:Ef,new_float_n:function e(t){if(1==t.length)return Ef(t[0]);var n=t[0];t=t.slice(1);for(var o=[],s=0;s<n;s++)o.push(e(t));return o},new_int:Rf,new_int_n:function e(t){if(1==t.length)return Rf(t[0]);var n=t[0];t=t.slice(1);for(var o=[],s=0;s<n;s++)o.push(e(t));return o},new_short:Af,new_short_n:function e(t){if(1==t.length)return Af(t[0]);var n=t[0];t=t.slice(1);for(var o=[],s=0;s<n;s++)o.push(e(t));return o},assert:function(e){}},Lf=Ff.System,Pf=Ff.Util,Df=Ff.Arrays,Hf=Ff.new_float;function Nf(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*Pf.SQRT2*.5/2384e-9,.017876148*Pf.SQRT2*.5/2384e-9,.003134727*Pf.SQRT2*.5/2384e-9,.002457142*Pf.SQRT2*.5/2384e-9,971317e-9*Pf.SQRT2*.5/2384e-9,218868e-9*Pf.SQRT2*.5/2384e-9,101566e-9*Pf.SQRT2*.5/2384e-9,13828e-9*Pf.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],n=t[ep.SHORT_TYPE],o=t[ep.SHORT_TYPE],s=t[ep.SHORT_TYPE],a=t[ep.SHORT_TYPE],r=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function i(t,n,o){for(var s=10,a=n+238-14-286,r=-15;r<0;r++){var i;i=e[s+-10],l=t[a+-224]*i,c=t[n+224]*i,i=e[s+-9],l+=t[a+-160]*i,c+=t[n+160]*i,i=e[s+-8],l+=t[a+-96]*i,c+=t[n+96]*i,i=e[s+-7],l+=t[a+-32]*i,c+=t[n+32]*i,i=e[s+-6],l+=t[a+32]*i,c+=t[n+-32]*i,i=e[s+-5],l+=t[a+96]*i,c+=t[n+-96]*i,i=e[s+-4],l+=t[a+160]*i,c+=t[n+-160]*i,i=e[s+-3],l+=t[a+224]*i,c+=t[n+-224]*i,i=e[s+-2],l+=t[n+-256]*i,c-=t[a+256]*i,i=e[s+-1],l+=t[n+-192]*i,c-=t[a+192]*i,i=e[s+0],l+=t[n+-128]*i,c-=t[a+128]*i,i=e[s+1],l+=t[n+-64]*i,c-=t[a+64]*i,i=e[s+2],l+=t[n+0]*i,c-=t[a+0]*i,i=e[s+3],l+=t[n+64]*i,c-=t[a+-64]*i,i=e[s+4],l+=t[n+128]*i,c-=t[a+-128]*i,i=e[s+5],l+=t[n+192]*i,i=(c-=t[a+-192]*i)-(l*=e[s+6]),o[30+2*r]=c+l,o[31+2*r]=e[s+7]*i,s+=18,n--,a++}var l,c,u,d,m;c=t[n+-16]*e[s+-10],l=t[n+-32]*e[s+-2],c+=(t[n+-48]-t[n+16])*e[s+-9],l+=t[n+-96]*e[s+-1],c+=(t[n+-80]+t[n+48])*e[s+-8],l+=t[n+-160]*e[s+0],c+=(t[n+-112]-t[n+80])*e[s+-7],l+=t[n+-224]*e[s+1],c+=(t[n+-144]+t[n+112])*e[s+-6],l-=t[n+32]*e[s+2],c+=(t[n+-176]-t[n+144])*e[s+-5],l-=t[n+96]*e[s+3],c+=(t[n+-208]+t[n+176])*e[s+-4],l-=t[n+160]*e[s+4],c+=(t[n+-240]-t[n+208])*e[s+-3],u=(l-=t[n+224])-c,d=l+c,c=o[14],l=o[15]-c,o[31]=d+c,o[30]=u+l,o[15]=u-l,o[14]=d-c,m=o[28]-o[0],o[0]+=o[28],o[28]=m*e[s+-36+7],m=o[29]-o[1],o[1]+=o[29],o[29]=m*e[s+-36+7],m=o[26]-o[2],o[2]+=o[26],o[26]=m*e[s+-72+7],m=o[27]-o[3],o[3]+=o[27],o[27]=m*e[s+-72+7],m=o[24]-o[4],o[4]+=o[24],o[24]=m*e[s+-108+7],m=o[25]-o[5],o[5]+=o[25],o[25]=m*e[s+-108+7],m=o[22]-o[6],o[6]+=o[22],o[22]=m*Pf.SQRT2,m=o[23]-o[7],o[7]+=o[23],o[23]=m*Pf.SQRT2-o[7],o[7]-=o[6],o[22]-=o[7],o[23]-=o[22],m=o[6],o[6]=o[31]-m,o[31]=o[31]+m,m=o[7],o[7]=o[30]-m,o[30]=o[30]+m,m=o[22],o[22]=o[15]-m,o[15]=o[15]+m,m=o[23],o[23]=o[14]-m,o[14]=o[14]+m,m=o[20]-o[8],o[8]+=o[20],o[20]=m*e[s+-180+7],m=o[21]-o[9],o[9]+=o[21],o[21]=m*e[s+-180+7],m=o[18]-o[10],o[10]+=o[18],o[18]=m*e[s+-216+7],m=o[19]-o[11],o[11]+=o[19],o[19]=m*e[s+-216+7],m=o[16]-o[12],o[12]+=o[16],o[16]=m*e[s+-252+7],m=o[17]-o[13],o[13]+=o[17],o[17]=m*e[s+-252+7],m=-o[20]+o[24],o[20]+=o[24],o[24]=m*e[s+-216+7],m=-o[21]+o[25],o[21]+=o[25],o[25]=m*e[s+-216+7],m=o[4]-o[8],o[4]+=o[8],o[8]=m*e[s+-216+7],m=o[5]-o[9],o[5]+=o[9],o[9]=m*e[s+-216+7],m=o[0]-o[12],o[0]+=o[12],o[12]=m*e[s+-72+7],m=o[1]-o[13],o[1]+=o[13],o[13]=m*e[s+-72+7],m=o[16]-o[28],o[16]+=o[28],o[28]=m*e[s+-72+7],m=-o[17]+o[29],o[17]+=o[29],o[29]=m*e[s+-72+7],m=Pf.SQRT2*(o[2]-o[10]),o[2]+=o[10],o[10]=m,m=Pf.SQRT2*(o[3]-o[11]),o[3]+=o[11],o[11]=m,m=Pf.SQRT2*(-o[18]+o[26]),o[18]+=o[26],o[26]=m-o[18],m=Pf.SQRT2*(-o[19]+o[27]),o[19]+=o[27],o[27]=m-o[19],m=o[2],o[19]-=o[3],o[3]-=m,o[2]=o[31]-m,o[31]+=m,m=o[3],o[11]-=o[19],o[18]-=m,o[3]=o[30]-m,o[30]+=m,m=o[18],o[27]-=o[11],o[19]-=m,o[18]=o[15]-m,o[15]+=m,m=o[19],o[10]-=m,o[19]=o[14]-m,o[14]+=m,m=o[10],o[11]-=m,o[10]=o[23]-m,o[23]+=m,m=o[11],o[26]-=m,o[11]=o[22]-m,o[22]+=m,m=o[26],o[27]-=m,o[26]=o[7]-m,o[7]+=m,m=o[27],o[27]=o[6]-m,o[6]+=m,m=Pf.SQRT2*(o[0]-o[4]),o[0]+=o[4],o[4]=m,m=Pf.SQRT2*(o[1]-o[5]),o[1]+=o[5],o[5]=m,m=Pf.SQRT2*(o[16]-o[20]),o[16]+=o[20],o[20]=m,m=Pf.SQRT2*(o[17]-o[21]),o[17]+=o[21],o[21]=m,m=-Pf.SQRT2*(o[8]-o[12]),o[8]+=o[12],o[12]=m-o[8],m=-Pf.SQRT2*(o[9]-o[13]),o[9]+=o[13],o[13]=m-o[9],m=-Pf.SQRT2*(o[25]-o[29]),o[25]+=o[29],o[29]=m-o[25],m=-Pf.SQRT2*(o[24]+o[28]),o[24]-=o[28],o[28]=m-o[24],m=o[24]-o[16],o[24]=m,m=o[20]-m,o[20]=m,m=o[28]-m,o[28]=m,m=o[25]-o[17],o[25]=m,m=o[21]-m,o[21]=m,m=o[29]-m,o[29]=m,m=o[17]-o[1],o[17]=m,m=o[9]-m,o[9]=m,m=o[25]-m,o[25]=m,m=o[5]-m,o[5]=m,m=o[21]-m,o[21]=m,m=o[13]-m,o[13]=m,m=o[29]-m,o[29]=m,m=o[1]-o[0],o[1]=m,m=o[16]-m,o[16]=m,m=o[17]-m,o[17]=m,m=o[8]-m,o[8]=m,m=o[9]-m,o[9]=m,m=o[24]-m,o[24]=m,m=o[25]-m,o[25]=m,m=o[4]-m,o[4]=m,m=o[5]-m,o[5]=m,m=o[20]-m,o[20]=m,m=o[21]-m,o[21]=m,m=o[12]-m,o[12]=m,m=o[13]-m,o[13]=m,m=o[28]-m,o[28]=m,m=o[29]-m,o[29]=m,m=o[0],o[0]+=o[31],o[31]-=m,m=o[1],o[1]+=o[30],o[30]-=m,m=o[16],o[16]+=o[15],o[15]-=m,m=o[17],o[17]+=o[14],o[14]-=m,m=o[8],o[8]+=o[23],o[23]-=m,m=o[9],o[9]+=o[22],o[22]-=m,m=o[24],o[24]+=o[7],o[7]-=m,m=o[25],o[25]+=o[6],o[6]-=m,m=o[4],o[4]+=o[27],o[27]-=m,m=o[5],o[5]+=o[26],o[26]-=m,m=o[20],o[20]+=o[11],o[11]-=m,m=o[21],o[21]+=o[10],o[10]-=m,m=o[12],o[12]+=o[19],o[19]-=m,m=o[13],o[13]+=o[18],o[18]-=m,m=o[28],o[28]+=o[3],o[3]-=m,m=o[29],o[29]+=o[2],o[2]-=m}function l(e,n){for(var o=0;o<3;o++){var s,a,r,i,l,c;a=(i=e[n+6]*t[ep.SHORT_TYPE][0]-e[n+15])+(s=e[n+0]*t[ep.SHORT_TYPE][2]-e[n+9]),r=i-s,l=(i=e[n+15]*t[ep.SHORT_TYPE][0]+e[n+6])+(s=e[n+9]*t[ep.SHORT_TYPE][2]+e[n+0]),c=-i+s,s=2069978111953089e-26*(e[n+3]*t[ep.SHORT_TYPE][1]-e[n+12]),i=2069978111953089e-26*(e[n+12]*t[ep.SHORT_TYPE][1]+e[n+3]),e[n+0]=190752519173728e-25*a+s,e[n+15]=190752519173728e-25*-l+i,r=.8660254037844387*r*1907525191737281e-26,l=.5*l*1907525191737281e-26+i,e[n+3]=r-l,e[n+6]=r+l,a=.5*a*1907525191737281e-26-s,c=.8660254037844387*c*1907525191737281e-26,e[n+9]=a+c,e[n+12]=a-c,n++}}function c(e,t,n){var s,a,r,i,l,c,u,d,m,f,p,h,g,_,v,b,x,y;r=n[17]-n[9],l=n[15]-n[11],c=n[14]-n[12],u=n[0]+n[8],d=n[1]+n[7],m=n[2]+n[6],f=n[3]+n[5],e[t+17]=u+m-f-(d-n[4]),a=(u+m-f)*o[19]+(d-n[4]),s=(r-l-c)*o[18],e[t+5]=s+a,e[t+6]=s-a,i=(n[16]-n[10])*o[18],d=d*o[19]+n[4],s=r*o[12]+i+l*o[13]+c*o[14],a=-u*o[16]+d-m*o[17]+f*o[15],e[t+1]=s+a,e[t+2]=s-a,s=r*o[13]-i-l*o[14]+c*o[12],a=-u*o[17]+d-m*o[15]+f*o[16],e[t+9]=s+a,e[t+10]=s-a,s=r*o[14]-i+l*o[12]-c*o[13],a=u*o[15]-d+m*o[16]-f*o[17],e[t+13]=s+a,e[t+14]=s-a,p=n[8]-n[0],g=n[6]-n[2],_=n[5]-n[3],v=n[17]+n[9],b=n[16]+n[10],x=n[15]+n[11],y=n[14]+n[12],e[t+0]=v+x+y+(b+n[13]),s=(v+x+y)*o[19]-(b+n[13]),a=(p-g+_)*o[18],e[t+11]=s+a,e[t+12]=s-a,h=(n[7]-n[1])*o[18],b=n[13]-b*o[19],s=v*o[15]-b+x*o[16]+y*o[17],a=p*o[14]+h+g*o[12]+_*o[13],e[t+3]=s+a,e[t+4]=s-a,s=-v*o[17]+b-x*o[15]-y*o[16],a=p*o[13]+h-g*o[14]-_*o[12],e[t+7]=s+a,e[t+8]=s-a,s=-v*o[16]+b-x*o[17]-y*o[15],a=p*o[12]-h+g*o[13]-_*o[14],e[t+15]=s+a,e[t+16]=s-a}this.mdct_sub48=function(e,o,u){for(var d=o,m=286,f=0;f<e.channels_out;f++){for(var p=0;p<e.mode_gr;p++){for(var h,g=e.l3_side.tt[p][f],_=g.xr,v=0,b=e.sb_sample[f][1-p],x=0,y=0;y<9;y++)for(i(d,m,b[x]),i(d,m+32,b[x+1]),x+=2,m+=64,h=1;h<32;h+=2)b[x-1][h]*=-1;for(h=0;h<32;h++,v+=18){var w=g.block_type,k=e.sb_sample[f][p],S=e.sb_sample[f][1-p];if(0!=g.mixed_block_flag&&h<2&&(w=0),e.amp_filter[h]<1e-12)Df.fill(_,v+0,v+18,0);else{if(e.amp_filter[h]<1)for(y=0;y<18;y++)S[y][r[h]]*=e.amp_filter[h];if(w==ep.SHORT_TYPE){for(y=-3;y<0;y++){var M=t[ep.SHORT_TYPE][y+3];_[v+3*y+9]=k[9+y][r[h]]*M-k[8-y][r[h]],_[v+3*y+18]=k[14-y][r[h]]*M+k[15+y][r[h]],_[v+3*y+10]=k[15+y][r[h]]*M-k[14-y][r[h]],_[v+3*y+19]=S[2-y][r[h]]*M+S[3+y][r[h]],_[v+3*y+11]=S[3+y][r[h]]*M-S[2-y][r[h]],_[v+3*y+20]=S[8-y][r[h]]*M+S[9+y][r[h]]}l(_,v)}else{var A=Hf(18);for(y=-9;y<0;y++){var R,E;R=t[w][y+27]*S[y+9][r[h]]+t[w][y+36]*S[8-y][r[h]],E=t[w][y+9]*k[y+9][r[h]]-t[w][y+18]*k[8-y][r[h]],A[y+9]=R-E*n[3+y+9],A[y+18]=R*n[3+y+9]+E}c(_,v,A)}}if(w!=ep.SHORT_TYPE&&0!=h)for(y=7;y>=0;--y){var T,B;T=_[v+y]*s[20+y]+_[v+-1-y]*a[28+y],B=_[v+y]*a[28+y]-_[v+-1-y]*s[20+y],_[v+-1-y]=T,_[v+y]=B}}}if(d=u,m=286,1==e.mode_gr)for(var I=0;I<18;I++)Lf.arraycopy(e.sb_sample[f][1][I],0,e.sb_sample[f][0][I],0,32)}}}var $f=Ff.System,zf=Ff.new_float,Vf=Ff.new_float_n;function qf(){this.l=zf(ep.SBMAX_l),this.s=Vf([ep.SBMAX_s,3]);var e=this;this.assign=function(t){$f.arraycopy(t.l,0,e.l,0,ep.SBMAX_l);for(var n=0;n<ep.SBMAX_s;n++)for(var o=0;o<3;o++)e.s[n][o]=t.s[n][o]}}function Uf(){this.thm=new qf,this.en=new qf}function Xf(e){var t=e;this.ordinal=function(){return t}}Xf.STEREO=new Xf(0),Xf.JOINT_STEREO=new Xf(1),Xf.DUAL_CHANNEL=new Xf(2),Xf.MONO=new Xf(3),Xf.NOT_SET=new Xf(4);var Yf=Ff.System,Gf=Ff.VbrMode,Kf=Ff.new_array_n,Zf=Ff.new_float,Wf=Ff.new_float_n,Qf=Ff.new_int,Jf=Ff.assert;function ep(){var e=ep.FFTOFFSET,t=ep.MPG_MD_MS_LR,n=null;this.psy=null;var o=null,s=null,a=null;this.setModules=function(e,t,r,i){n=e,this.psy=t,o=t,s=i,a=r};var r=new Nf;this.lame_encode_mp3_frame=function(i,l,c,u,d,m){var f,p=Kf([2,2]);p[0][0]=new Uf,p[0][1]=new Uf,p[1][0]=new Uf,p[1][1]=new Uf;var h=Kf([2,2]);h[0][0]=new Uf,h[0][1]=new Uf,h[1][0]=new Uf,h[1][1]=new Uf;var g,_,v,b,x=[null,null],y=i.internal_flags,w=Wf([2,4]),k=[.5,.5],S=[[0,0],[0,0]],M=[[0,0],[0,0]];if(x[0]=l,x[1]=c,0==y.lame_encode_frame_init&&function(e,t){var n,o,s=e.internal_flags;if(0==s.lame_encode_frame_init){var a,i,l=Zf(2014),c=Zf(2014);for(s.lame_encode_frame_init=1,a=0,i=0;a<286+576*(1+s.mode_gr);++a)a<576*s.mode_gr?(l[a]=0,2==s.channels_out&&(c[a]=0)):(l[a]=t[0][i],2==s.channels_out&&(c[a]=t[1][i]),++i);for(o=0;o<s.mode_gr;o++)for(n=0;n<s.channels_out;n++)s.l3_side.tt[o][n].block_type=ep.SHORT_TYPE;r.mdct_sub48(s,l,c),Jf(s.mf_size>=ep.BLKSIZE+e.framesize-ep.FFTOFFSET),Jf(s.mf_size>=512+e.framesize-32)}}(i,x),y.padding=0,(y.slot_lag-=y.frac_SpF)<0&&(y.slot_lag+=i.out_samplerate,y.padding=1),0!=y.psymodel){var A=[null,null],R=0,E=Qf(2);for(b=0;b<y.mode_gr;b++){for(v=0;v<y.channels_out;v++)A[v]=x[v],R=576+576*b-ep.FFTOFFSET;if(0!=(i.VBR==Gf.vbr_mtrh||i.VBR==Gf.vbr_mt?o.L3psycho_anal_vbr(i,A,R,b,p,h,S[b],M[b],w[b],E):o.L3psycho_anal_ns(i,A,R,b,p,h,S[b],M[b],w[b],E)))return-4;for(i.mode==Xf.JOINT_STEREO&&(k[b]=w[b][2]+w[b][3],k[b]>0&&(k[b]=w[b][3]/k[b])),v=0;v<y.channels_out;v++){var T=y.l3_side.tt[b][v];T.block_type=E[v],T.mixed_block_flag=0}}}else for(b=0;b<y.mode_gr;b++)for(v=0;v<y.channels_out;v++)y.l3_side.tt[b][v].block_type=ep.NORM_TYPE,y.l3_side.tt[b][v].mixed_block_flag=0,M[b][v]=S[b][v]=700;if(function(e){var t,n;if(0!=e.ATH.useAdjust)if(n=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(n+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(n+=n,t+=t),2==e.mode_gr&&(n=Math.max(n,t)),n*=.5,(n*=e.ATH.aaSensitivityP)>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var o=31.98*n+625e-6;e.ATH.adjust>=o?(e.ATH.adjust*=.075*o+.925,e.ATH.adjust<o&&(e.ATH.adjust=o)):e.ATH.adjustLimit>=o?e.ATH.adjust=o:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=o}else e.ATH.adjust=1}(y),r.mdct_sub48(y,x[0],x[1]),y.mode_ext=ep.MPG_MD_LR_LR,i.force_ms)y.mode_ext=ep.MPG_MD_MS_LR;else if(i.mode==Xf.JOINT_STEREO){var B=0,I=0;for(b=0;b<y.mode_gr;b++)for(v=0;v<y.channels_out;v++)B+=M[b][v],I+=S[b][v];if(B<=1*I){var C=y.l3_side.tt[0],j=y.l3_side.tt[y.mode_gr-1];C[0].block_type==C[1].block_type&&j[0].block_type==j[1].block_type&&(y.mode_ext=ep.MPG_MD_MS_LR)}}if(y.mode_ext==t?(g=h,_=M):(g=p,_=S),i.analysis&&null!=y.pinfo)for(b=0;b<y.mode_gr;b++)for(v=0;v<y.channels_out;v++)y.pinfo.ms_ratio[b]=y.ms_ratio[b],y.pinfo.ms_ener_ratio[b]=k[b],y.pinfo.blocktype[b][v]=y.l3_side.tt[b][v].block_type,y.pinfo.pe[b][v]=_[b][v],Yf.arraycopy(y.l3_side.tt[b][v].xr,0,y.pinfo.xr[b][v],0,576),y.mode_ext==t&&(y.pinfo.ers[b][v]=y.pinfo.ers[b][v+2],Yf.arraycopy(y.pinfo.energy[b][v+2],0,y.pinfo.energy[b][v],0,y.pinfo.energy[b][v].length));if(i.VBR==Gf.vbr_off||i.VBR==Gf.vbr_abr){var O,F;for(O=0;O<18;O++)y.nsPsy.pefirbuf[O]=y.nsPsy.pefirbuf[O+1];for(F=0,b=0;b<y.mode_gr;b++)for(v=0;v<y.channels_out;v++)F+=_[b][v];for(y.nsPsy.pefirbuf[18]=F,F=y.nsPsy.pefirbuf[9],O=0;O<9;O++)F+=(y.nsPsy.pefirbuf[O]+y.nsPsy.pefirbuf[18-O])*ep.fircoef[O];for(F=3350*y.mode_gr*y.channels_out/F,b=0;b<y.mode_gr;b++)for(v=0;v<y.channels_out;v++)_[b][v]*=F}if(y.iteration_loop.iteration_loop(i,_,k,g),n.format_bitstream(i),f=n.copy_buffer(y,u,d,m,1),i.bWriteVbrTag&&s.addVbrFrame(i),i.analysis&&null!=y.pinfo){for(v=0;v<y.channels_out;v++){var L;for(L=0;L<e;L++)y.pinfo.pcmdata[v][L]=y.pinfo.pcmdata[v][L+i.framesize];for(L=e;L<1600;L++)y.pinfo.pcmdata[v][L]=x[v][L-e]}a.set_frame_pinfo(i,g)}return function(e){var t,n;for(Jf(e.bitrate_index>=0&&e.bitrate_index<16),Jf(e.mode_ext>=0&&e.mode_ext<4),e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(n=0;n<e.channels_out;++n){var o=0|e.l3_side.tt[t][n].block_type;0!=e.l3_side.tt[t][n].mixed_block_flag&&(o=4),e.bitrate_blockType_Hist[e.bitrate_index][o]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][o]++,e.bitrate_blockType_Hist[15][5]++}}(y),f}}ep.ENCDELAY=576,ep.POSTDELAY=1152,ep.MDCTDELAY=48,ep.FFTOFFSET=224+ep.MDCTDELAY,ep.DECDELAY=528,ep.SBLIMIT=32,ep.CBANDS=64,ep.SBPSY_l=21,ep.SBPSY_s=12,ep.SBMAX_l=22,ep.SBMAX_s=13,ep.PSFB21=6,ep.PSFB12=6,ep.BLKSIZE=1024,ep.HBLKSIZE=ep.BLKSIZE/2+1,ep.BLKSIZE_s=256,ep.HBLKSIZE_s=ep.BLKSIZE_s/2+1,ep.NORM_TYPE=0,ep.START_TYPE=1,ep.SHORT_TYPE=2,ep.STOP_TYPE=3,ep.MPG_MD_LR_LR=0,ep.MPG_MD_LR_I=1,ep.MPG_MD_MS_LR=2,ep.MPG_MD_MS_I=3,ep.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5];var tp=Ff.Util,np=Ff.new_float;function op(){var e=np(ep.BLKSIZE),t=np(ep.BLKSIZE_s/2),n=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function o(e,t,o){var s,a,r,i=0,l=t+(o<<=1);s=4;do{var c,u,d,m,f,p,h;h=s>>1,p=(f=s<<1)+(m=s),s=f<<1,r=(a=t)+h;do{w=e[a+0]-e[a+m],y=e[a+0]+e[a+m],A=e[a+f]-e[a+p],S=e[a+f]+e[a+p],e[a+f]=y-S,e[a+0]=y+S,e[a+p]=w-A,e[a+m]=w+A,w=e[r+0]-e[r+m],y=e[r+0]+e[r+m],A=tp.SQRT2*e[r+p],S=tp.SQRT2*e[r+f],e[r+f]=y-S,e[r+0]=y+S,e[r+p]=w-A,e[r+m]=w+A,r+=s,a+=s}while(a<l);for(u=n[i+0],c=n[i+1],d=1;d<h;d++){var g,_;g=1-2*c*c,_=2*c*u,a=t+d,r=t+m-d;do{var v,b,x,y,w,k,S,M,A,R;b=_*e[a+m]-g*e[r+m],v=g*e[a+m]+_*e[r+m],w=e[a+0]-v,y=e[a+0]+v,k=e[r+0]-b,x=e[r+0]+b,b=_*e[a+p]-g*e[r+p],v=g*e[a+p]+_*e[r+p],A=e[a+f]-v,S=e[a+f]+v,R=e[r+f]-b,M=e[r+f]+b,b=c*S-u*R,v=u*S+c*R,e[a+f]=y-v,e[a+0]=y+v,e[r+p]=k-b,e[r+m]=k+b,b=u*M-c*A,v=c*M+u*A,e[r+f]=x-v,e[r+0]=x+v,e[a+p]=w-b,e[a+m]=w+b,r+=s,a+=s}while(a<l);u=(g=u)*n[i+0]-c*n[i+1],c=g*n[i+1]+c*n[i+0]}i+=2}while(s<o)}var s=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,n,a,r,i){for(var l=0;l<3;l++){var c=ep.BLKSIZE_s/2,u=65535&192*(l+1),d=ep.BLKSIZE_s/8-1;do{var m,f,p,h,g,_=255&s[d<<2];f=(m=t[_]*r[a][i+_+u])-(g=t[127-_]*r[a][i+_+u+128]),m+=g,h=(p=t[_+64]*r[a][i+_+u+64])-(g=t[63-_]*r[a][i+_+u+192]),p+=g,c-=4,n[l][c+0]=m+p,n[l][c+2]=m-p,n[l][c+1]=f+h,n[l][c+3]=f-h,f=(m=t[_+1]*r[a][i+_+u+1])-(g=t[126-_]*r[a][i+_+u+129]),m+=g,h=(p=t[_+65]*r[a][i+_+u+65])-(g=t[62-_]*r[a][i+_+u+193]),p+=g,n[l][c+ep.BLKSIZE_s/2+0]=m+p,n[l][c+ep.BLKSIZE_s/2+2]=m-p,n[l][c+ep.BLKSIZE_s/2+1]=f+h,n[l][c+ep.BLKSIZE_s/2+3]=f-h}while(--d>=0);o(n[l],c,ep.BLKSIZE_s/2)}},this.fft_long=function(t,n,a,r,i){var l=ep.BLKSIZE/8-1,c=ep.BLKSIZE/2;do{var u,d,m,f,p,h=255&s[l];d=(u=e[h]*r[a][i+h])-(p=e[h+512]*r[a][i+h+512]),u+=p,f=(m=e[h+256]*r[a][i+h+256])-(p=e[h+768]*r[a][i+h+768]),m+=p,n[(c-=4)+0]=u+m,n[c+2]=u-m,n[c+1]=d+f,n[c+3]=d-f,d=(u=e[h+1]*r[a][i+h+1])-(p=e[h+513]*r[a][i+h+513]),u+=p,f=(m=e[h+257]*r[a][i+h+257])-(p=e[h+769]*r[a][i+h+769]),m+=p,n[c+ep.BLKSIZE/2+0]=u+m,n[c+ep.BLKSIZE/2+2]=u-m,n[c+ep.BLKSIZE/2+1]=d+f,n[c+ep.BLKSIZE/2+3]=d-f}while(--l>=0);o(n,c,ep.BLKSIZE/2)},this.init_fft=function(n){for(var o=0;o<ep.BLKSIZE;o++)e[o]=.42-.5*Math.cos(2*Math.PI*(o+.5)/ep.BLKSIZE)+.08*Math.cos(4*Math.PI*(o+.5)/ep.BLKSIZE);for(o=0;o<ep.BLKSIZE_s/2;o++)t[o]=.5*(1-Math.cos(2*Math.PI*(o+.5)/ep.BLKSIZE_s))}}var sp=Ff.VbrMode,ap=Ff.Float,rp=Ff.ShortBlock,ip=Ff.Util,lp=Ff.Arrays,cp=Ff.new_float,up=Ff.new_float_n,dp=Ff.new_int,mp=Ff.assert;function fp(){var e=new op,t=2.302585092994046,n=1/217621504/(ep.BLKSIZE/2),o=.3,s=21,a=.2302585093;function r(e,t){for(var o=0,s=0;s<ep.BLKSIZE/2;++s)o+=e[s]*t.ATH.eql_w[s];return o*=n}function i(t,n,o,s,a,i,l,c,u,d,m){var f=t.internal_flags;if(u<2)e.fft_long(f,s[a],u,d,m),e.fft_short(f,i[l],u,d,m);else if(2==u){for(var p=ep.BLKSIZE-1;p>=0;--p){var h=s[a+0][p],g=s[a+1][p];s[a+0][p]=(h+g)*ip.SQRT2*.5,s[a+1][p]=(h-g)*ip.SQRT2*.5}for(var _=2;_>=0;--_)for(p=ep.BLKSIZE_s-1;p>=0;--p){h=i[l+0][_][p],g=i[l+1][_][p];i[l+0][_][p]=(h+g)*ip.SQRT2*.5,i[l+1][_][p]=(h-g)*ip.SQRT2*.5}}n[0]=s[a+0][0],n[0]*=n[0];for(p=ep.BLKSIZE/2-1;p>=0;--p){var v=s[a+0][ep.BLKSIZE/2-p],b=s[a+0][ep.BLKSIZE/2+p];n[ep.BLKSIZE/2-p]=.5*(v*v+b*b)}for(_=2;_>=0;--_){o[_][0]=i[l+0][_][0],o[_][0]*=o[_][0];for(p=ep.BLKSIZE_s/2-1;p>=0;--p){v=i[l+0][_][ep.BLKSIZE_s/2-p],b=i[l+0][_][ep.BLKSIZE_s/2+p];o[_][ep.BLKSIZE_s/2-p]=.5*(v*v+b*b)}}var x=0;for(p=11;p<ep.HBLKSIZE;p++)x+=n[p];if(f.tot_ener[u]=x,t.analysis){for(p=0;p<ep.HBLKSIZE;p++)f.pinfo.energy[c][u][p]=f.pinfo.energy_save[u][p],f.pinfo.energy_save[u][p]=n[p];f.pinfo.pe[c][u]=f.pe[u]}2==t.athaa_loudapprox&&u<2&&(f.loudness_sq[c][u]=f.loudness_sq_save[u],f.loudness_sq_save[u]=r(n,f))}var l,c,u,d=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];var m=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],f=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],p=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function h(e,t,n,o,s,a){var r;if(t>e){if(!(t<e*c))return e+t;r=t/e}else{if(e>=t*c)return e+t;r=e/t}if(e+=t,o+3<=6){if(r>=l)return e;var i=0|ip.FAST_LOG10_X(r,16);return e*f[i]}var d,h;i=0|ip.FAST_LOG10_X(r,16);return t=0!=a?s.ATH.cb_s[n]*s.ATH.adjust:s.ATH.cb_l[n]*s.ATH.adjust,e<u*t?e>t?(d=1,i<=13&&(d=p[i]),h=ip.FAST_LOG10_X(e/t,10/15),e*((m[i]-d)*h+d)):i>13?e:e*p[i]:e*m[i]}var g=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function _(e,t,n){var o;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(o=t>e?t/e:e/t,n>=-2&&n<=2){if(o>=l)return e+t;var s=0|ip.FAST_LOG10_X(o,16);return(e+t)*g[s]}return o<c?e+t:(e<t&&(e=t),e)}function v(e,t,n,o,s){var a,r,i=0,l=0;for(a=r=0;a<ep.SBMAX_s;++r,++a){for(var c=e.bo_s[a],u=e.npart_s,d=c<u?c:u;r<d;)mp(t[r]>=0),mp(n[r]>=0),i+=t[r],l+=n[r],r++;if(e.en[o].s[a][s]=i,e.thm[o].s[a][s]=l,r>=u){++a;break}mp(t[r]>=0),mp(n[r]>=0);var m=e.PSY.bo_s_weight[a],f=1-m;i=m*t[r],l=m*n[r],e.en[o].s[a][s]+=i,e.thm[o].s[a][s]+=l,i=f*t[r],l=f*n[r]}for(;a<ep.SBMAX_s;++a)e.en[o].s[a][s]=0,e.thm[o].s[a][s]=0}function b(e,t,n,o){var s,a,r=0,i=0;for(s=a=0;s<ep.SBMAX_l;++a,++s){for(var l=e.bo_l[s],c=e.npart_l,u=l<c?l:c;a<u;)mp(t[a]>=0),mp(n[a]>=0),r+=t[a],i+=n[a],a++;if(e.en[o].l[s]=r,e.thm[o].l[s]=i,a>=c){++s;break}mp(t[a]>=0),mp(n[a]>=0);var d=e.PSY.bo_l_weight[s],m=1-d;r=d*t[a],i=d*n[a],e.en[o].l[s]+=r,e.thm[o].l[s]+=i,r=m*t[a],i=m*n[a]}for(;s<ep.SBMAX_l;++s)e.en[o].l[s]=0,e.thm[o].l[s]=0}function x(e,t,n,o,s,a){var r,i,l=e.internal_flags;for(i=r=0;i<l.npart_s;++i){for(var c=0,u=l.numlines_s[i],d=0;d<u;++d,++r){c+=t[a][r]}n[i]=c}for(mp(i==l.npart_s),r=i=0;i<l.npart_s;i++){var m=l.s3ind_s[i][0],f=l.s3_ss[r++]*n[m];for(++m;m<=l.s3ind_s[i][1];)f+=l.s3_ss[r]*n[m],++r,++m;var p=2*l.nb_s1[s][i];if(o[i]=Math.min(f,p),l.blocktype_old[1&s]==ep.SHORT_TYPE){p=16*l.nb_s2[s][i];var h=o[i];o[i]=Math.min(p,h)}l.nb_s2[s][i]=l.nb_s1[s][i],l.nb_s1[s][i]=f,mp(o[i]>=0)}for(;i<=ep.CBANDS;++i)n[i]=0,o[i]=0}function y(e,t,n){return n>=1?e:n<=0?t:t>0?Math.pow(e/t,n)*t:0}var w=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function k(e,n){for(var o=309.07,s=0;s<ep.SBMAX_s-1;s++)for(var a=0;a<3;a++){var r=e.thm.s[s][a];if(r>0){var i=r*n,l=e.en.s[s][a];l>i&&(o+=l>1e10*i?w[s]*(10*t):w[s]*ip.FAST_LOG10(l/i))}}return o}var S=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function M(e,n){for(var o=281.0575,s=0;s<ep.SBMAX_l-1;s++){var a=e.thm.l[s];if(a>0){var r=a*n,i=e.en.l[s];i>r&&(o+=i>1e10*r?S[s]*(10*t):S[s]*ip.FAST_LOG10(i/r))}}return o}function A(e,t,n,o,s){var a,r;for(a=r=0;a<e.npart_l;++a){var i,l=0,c=0;for(i=0;i<e.numlines_l[a];++i,++r){var u=t[r];l+=u,c<u&&(c=u)}n[a]=l,o[a]=c,s[a]=l*e.rnumlines_l[a],mp(e.rnumlines_l[a]>=0),mp(n[a]>=0),mp(o[a]>=0),mp(s[a]>=0)}}function R(e,t,n,o){var s=d.length-1,a=0,r=n[a]+n[a+1];r>0?((i=t[a])<t[a+1]&&(i=t[a+1]),mp(e.numlines_l[a]+e.numlines_l[a+1]-1>0),(l=0|(r=20*(2*i-r)/(r*(e.numlines_l[a]+e.numlines_l[a+1]-1))))>s&&(l=s),o[a]=l):o[a]=0;for(a=1;a<e.npart_l-1;a++)if((r=n[a-1]+n[a]+n[a+1])>0){var i,l;(i=t[a-1])<t[a]&&(i=t[a]),i<t[a+1]&&(i=t[a+1]),mp(e.numlines_l[a-1]+e.numlines_l[a]+e.numlines_l[a+1]-1>0),(l=0|(r=20*(3*i-r)/(r*(e.numlines_l[a-1]+e.numlines_l[a]+e.numlines_l[a+1]-1))))>s&&(l=s),o[a]=l}else o[a]=0;(mp(a==e.npart_l-1),(r=n[a-1]+n[a])>0)?((i=t[a-1])<t[a]&&(i=t[a]),mp(e.numlines_l[a-1]+e.numlines_l[a]-1>0),(l=0|(r=20*(2*i-r)/(r*(e.numlines_l[a-1]+e.numlines_l[a]-1))))>s&&(l=s),o[a]=l):o[a]=0;mp(a==e.npart_l-1)}var E=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function T(t,n,o,s,a,r,i,l){var c=t.internal_flags;if(s<2)e.fft_long(c,i[l],s,n,o);else if(2==s)for(var u=ep.BLKSIZE-1;u>=0;--u){var d=i[l+0][u],m=i[l+1][u];i[l+0][u]=(d+m)*ip.SQRT2*.5,i[l+1][u]=(d-m)*ip.SQRT2*.5}r[0]=i[l+0][0],r[0]*=r[0];for(u=ep.BLKSIZE/2-1;u>=0;--u){var f=i[l+0][ep.BLKSIZE/2-u],p=i[l+0][ep.BLKSIZE/2+u];r[ep.BLKSIZE/2-u]=.5*(f*f+p*p)}var h=0;for(u=11;u<ep.HBLKSIZE;u++)h+=r[u];if(c.tot_ener[s]=h,t.analysis){for(u=0;u<ep.HBLKSIZE;u++)c.pinfo.energy[a][s][u]=c.pinfo.energy_save[s][u],c.pinfo.energy_save[s][u]=r[u];c.pinfo.pe[a][s]=c.pe[s]}}function B(t,n,o,s,a,r,i,l){var c=t.internal_flags;if(0==a&&s<2&&e.fft_short(c,i[l],s,n,o),2==s)for(var u=ep.BLKSIZE_s-1;u>=0;--u){var d=i[l+0][a][u],m=i[l+1][a][u];i[l+0][a][u]=(d+m)*ip.SQRT2*.5,i[l+1][a][u]=(d-m)*ip.SQRT2*.5}r[a][0]=i[l+0][a][0],r[a][0]*=r[a][0];for(u=ep.BLKSIZE_s/2-1;u>=0;--u){var f=i[l+0][a][ep.BLKSIZE_s/2-u],p=i[l+0][a][ep.BLKSIZE_s/2+u];r[a][ep.BLKSIZE_s/2-u]=.5*(f*f+p*p)}}function I(e,t,n,o){var s=e.internal_flags;2==e.athaa_loudapprox&&n<2&&(s.loudness_sq[t][n]=s.loudness_sq_save[n],s.loudness_sq_save[n]=r(o,s))}this.L3psycho_anal_ns=function(e,t,n,a,r,l,c,u,m,f){var p,g,_,w,S,T,B,I,C,j,O=e.internal_flags,F=up([2,ep.BLKSIZE]),L=up([2,3,ep.BLKSIZE_s]),P=cp(ep.CBANDS+1),D=cp(ep.CBANDS+1),H=cp(ep.CBANDS+2),N=dp(2),$=dp(2),z=up([2,576]),V=dp(ep.CBANDS+2),q=dp(ep.CBANDS+2);for(lp.fill(q,0),p=O.channels_out,e.mode==Xf.JOINT_STEREO&&(p=4),C=e.VBR==sp.vbr_off?0==O.ResvMax?0:O.ResvSize/O.ResvMax*.5:e.VBR==sp.vbr_rh||e.VBR==sp.vbr_mtrh||e.VBR==sp.vbr_mt?.6:1,g=0;g<O.channels_out;g++){var U=t[g],X=n+576-350-s+192;for(w=0;w<576;w++){var Y,G;for(Y=U[X+w+10],G=0,S=0;S<9;S+=2)Y+=E[S]*(U[X+w+S]+U[X+w+s-S]),G+=E[S+1]*(U[X+w+S+1]+U[X+w+s-S-1]);z[g][w]=Y+G}r[a][g].en.assign(O.en[g]),r[a][g].thm.assign(O.thm[g]),p>2&&(l[a][g].en.assign(O.en[g+2]),l[a][g].thm.assign(O.thm[g+2]))}for(g=0;g<p;g++){var K,Z=cp(12),W=[0,0,0,0],Q=cp(12),J=1,ee=cp(ep.CBANDS),te=cp(ep.CBANDS),ne=[0,0,0,0],oe=cp(ep.HBLKSIZE),se=up([3,ep.HBLKSIZE_s]);for(mp(O.npart_s<=ep.CBANDS),mp(O.npart_l<=ep.CBANDS),w=0;w<3;w++)Z[w]=O.nsPsy.last_en_subshort[g][w+6],mp(O.nsPsy.last_en_subshort[g][w+4]>0),Q[w]=Z[w]/O.nsPsy.last_en_subshort[g][w+4],W[0]+=Z[w];if(2==g)for(w=0;w<576;w++){var ae,re;ae=z[0][w],re=z[1][w],z[0][w]=ae+re,z[1][w]=ae-re}var ie=z[1&g],le=0;for(w=0;w<9;w++){for(var ce=le+64,ue=1;le<ce;le++)ue<Math.abs(ie[le])&&(ue=Math.abs(ie[le]));O.nsPsy.last_en_subshort[g][w]=Z[w+3]=ue,W[1+w/3]+=ue,ue>Z[w+3-2]?(mp(Z[w+3-2]>0),ue/=Z[w+3-2]):ue=Z[w+3-2]>10*ue?Z[w+3-2]/(10*ue):0,Q[w+3]=ue}if(e.analysis){var de=Q[0];for(w=1;w<12;w++)de<Q[w]&&(de=Q[w]);O.pinfo.ers[a][g]=O.pinfo.ers_save[g],O.pinfo.ers_save[g]=de}for(K=3==g?O.nsPsy.attackthre_s:O.nsPsy.attackthre,w=0;w<12;w++)0==ne[w/3]&&Q[w]>K&&(ne[w/3]=w%3+1);for(w=1;w<4;w++){var me;W[w-1]>W[w]?(mp(W[w]>0),me=W[w-1]/W[w]):(mp(W[w-1]>0),me=W[w]/W[w-1]),me<1.7&&(ne[w]=0,1==w&&(ne[0]=0))}for(0!=ne[0]&&0!=O.nsPsy.lastAttacks[g]&&(ne[0]=0),(3==O.nsPsy.lastAttacks[g]||ne[0]+ne[1]+ne[2]+ne[3]!=0)&&(J=0,0!=ne[1]&&0!=ne[0]&&(ne[1]=0),0!=ne[2]&&0!=ne[1]&&(ne[2]=0),0!=ne[3]&&0!=ne[2]&&(ne[3]=0)),g<2?$[g]=J:0==J&&($[0]=$[1]=0),m[g]=O.tot_ener[g],i(e,oe,se,F,1&g,L,1&g,a,g,t,n),A(O,oe,P,ee,te),R(O,ee,te,V),I=0;I<3;I++){var fe,pe;for(x(e,se,D,H,g,I),v(O,D,H,g,I),B=0;B<ep.SBMAX_s;B++){if(pe=O.thm[g].s[B][I],pe*=.8,ne[I]>=2||1==ne[I+1]){var he=0!=I?I-1:2;ue=y(O.thm[g].s[B][he],pe,.6*C);pe=Math.min(pe,ue)}if(1==ne[I]){he=0!=I?I-1:2,ue=y(O.thm[g].s[B][he],pe,o*C);pe=Math.min(pe,ue)}else if(0!=I&&3==ne[I-1]||0==I&&3==O.nsPsy.lastAttacks[g]){he=2!=I?I+1:0,ue=y(O.thm[g].s[B][he],pe,o*C);pe=Math.min(pe,ue)}fe=Z[3*I+3]+Z[3*I+4]+Z[3*I+5],6*Z[3*I+5]<fe&&(pe*=.5,6*Z[3*I+4]<fe&&(pe*=.5)),O.thm[g].s[B][I]=pe}}for(O.nsPsy.lastAttacks[g]=ne[2],T=0,_=0;_<O.npart_l;_++){for(var ge=O.s3ind[_][0],_e=P[ge]*d[V[ge]],ve=O.s3_ll[T++]*_e;++ge<=O.s3ind[_][1];)_e=P[ge]*d[V[ge]],ve=h(ve,O.s3_ll[T++]*_e,ge,ge-_,O,0);ve*=.158489319246111,O.blocktype_old[1&g]==ep.SHORT_TYPE?H[_]=ve:H[_]=y(Math.min(ve,Math.min(2*O.nb_1[g][_],16*O.nb_2[g][_])),ve,C),O.nb_2[g][_]=O.nb_1[g][_],O.nb_1[g][_]=ve}for(;_<=ep.CBANDS;++_)P[_]=0,H[_]=0;b(O,P,H,g)}((e.mode==Xf.STEREO||e.mode==Xf.JOINT_STEREO)&&e.interChRatio>0&&function(e,t){var n=e.internal_flags;if(n.channels_out>1){for(var o=0;o<ep.SBMAX_l;o++){var s=n.thm[0].l[o],a=n.thm[1].l[o];n.thm[0].l[o]+=a*t,n.thm[1].l[o]+=s*t}for(o=0;o<ep.SBMAX_s;o++)for(var r=0;r<3;r++)s=n.thm[0].s[o][r],a=n.thm[1].s[o][r],n.thm[0].s[o][r]+=a*t,n.thm[1].s[o][r]+=s*t}}(e,e.interChRatio),e.mode==Xf.JOINT_STEREO)&&(function(e){for(var t=0;t<ep.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var n=e.mld_l[t]*e.en[3].l[t],o=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],n));n=e.mld_l[t]*e.en[2].l[t];var s=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],n));e.thm[2].l[t]=o,e.thm[3].l[t]=s}for(t=0;t<ep.SBMAX_s;t++)for(var a=0;a<3;a++)e.thm[0].s[t][a]>1.58*e.thm[1].s[t][a]||e.thm[1].s[t][a]>1.58*e.thm[0].s[t][a]||(n=e.mld_s[t]*e.en[3].s[t][a],o=Math.max(e.thm[2].s[t][a],Math.min(e.thm[3].s[t][a],n)),n=e.mld_s[t]*e.en[2].s[t][a],s=Math.max(e.thm[3].s[t][a],Math.min(e.thm[2].s[t][a],n)),e.thm[2].s[t][a]=o,e.thm[3].s[t][a]=s)}(O),j=e.msfix,Math.abs(j)>0&&function(e,t,n){var o=t,s=Math.pow(10,n);t*=2,o*=2;for(var a=0;a<ep.SBMAX_l;a++)u=e.ATH.cb_l[e.bm_l[a]]*s,(i=Math.min(Math.max(e.thm[0].l[a],u),Math.max(e.thm[1].l[a],u)))*t<(l=Math.max(e.thm[2].l[a],u))+(c=Math.max(e.thm[3].l[a],u))&&(l*=d=i*o/(l+c),c*=d),e.thm[2].l[a]=Math.min(l,e.thm[2].l[a]),e.thm[3].l[a]=Math.min(c,e.thm[3].l[a]);for(s*=ep.BLKSIZE_s/ep.BLKSIZE,a=0;a<ep.SBMAX_s;a++)for(var r=0;r<3;r++){var i,l,c,u,d;u=e.ATH.cb_s[e.bm_s[a]]*s,(i=Math.min(Math.max(e.thm[0].s[a][r],u),Math.max(e.thm[1].s[a][r],u)))*t<(l=Math.max(e.thm[2].s[a][r],u))+(c=Math.max(e.thm[3].s[a][r],u))&&(l*=d=i*t/(l+c),c*=d),e.thm[2].s[a][r]=Math.min(e.thm[2].s[a][r],l),e.thm[3].s[a][r]=Math.min(e.thm[3].s[a][r],c)}}(O,j,e.ATHlower*O.ATH.adjust));for(function(e,t,n,o){var s=e.internal_flags;e.short_blocks==rp.short_block_coupled&&(0==t[0]||0==t[1])&&(t[0]=t[1]=0);for(var a=0;a<s.channels_out;a++)o[a]=ep.NORM_TYPE,e.short_blocks==rp.short_block_dispensed&&(t[a]=1),e.short_blocks==rp.short_block_forced&&(t[a]=0),0!=t[a]?(mp(s.blocktype_old[a]!=ep.START_TYPE),s.blocktype_old[a]==ep.SHORT_TYPE&&(o[a]=ep.STOP_TYPE)):(o[a]=ep.SHORT_TYPE,s.blocktype_old[a]==ep.NORM_TYPE&&(s.blocktype_old[a]=ep.START_TYPE),s.blocktype_old[a]==ep.STOP_TYPE&&(s.blocktype_old[a]=ep.SHORT_TYPE)),n[a]=s.blocktype_old[a],s.blocktype_old[a]=o[a]}(e,$,f,N),g=0;g<p;g++){var be,xe,ye,we=0;g>1?(be=u,we=-2,xe=ep.NORM_TYPE,(f[0]==ep.SHORT_TYPE||f[1]==ep.SHORT_TYPE)&&(xe=ep.SHORT_TYPE),ye=l[a][g-2]):(be=c,we=0,xe=f[g],ye=r[a][g]),xe==ep.SHORT_TYPE?be[we+g]=k(ye,O.masking_lower):be[we+g]=M(ye,O.masking_lower),e.analysis&&(O.pinfo.pe[a][g]=be[we+g])}return 0};var C=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function j(e,t,n){if(0==n)for(var o=0;o<e.npart_s;o++)e.nb_s2[t][o]=e.nb_s1[t][o],e.nb_s1[t][o]=0}function O(e,t){for(var n=0;n<e.npart_l;n++)e.nb_2[t][n]=e.nb_1[t][n],e.nb_1[t][n]=0}function F(e,t,n,o,s,a){var r,i,l,c=e.internal_flags,u=new float[ep.CBANDS],m=cp(ep.CBANDS),f=new int[ep.CBANDS];for(l=i=0;l<c.npart_s;++l){var p=0,h=0,g=c.numlines_s[l];for(r=0;r<g;++r,++i){var v=t[a][i];p+=v,h<v&&(h=v)}n[l]=p,u[l]=h,m[l]=p/g,mp(m[l]>=0)}for(mp(l==c.npart_s);l<ep.CBANDS;++l)u[l]=0,m[l]=0;for(function(e,t,n,o){var s=d.length-1,a=0,r=n[a]+n[a+1];for(r>0?((i=t[a])<t[a+1]&&(i=t[a+1]),mp(e.numlines_s[a]+e.numlines_s[a+1]-1>0),(l=0|(r=20*(2*i-r)/(r*(e.numlines_s[a]+e.numlines_s[a+1]-1))))>s&&(l=s),o[a]=l):o[a]=0,a=1;a<e.npart_s-1;a++)if(r=n[a-1]+n[a]+n[a+1],mp(a+1<e.npart_s),r>0){var i,l;(i=t[a-1])<t[a]&&(i=t[a]),i<t[a+1]&&(i=t[a+1]),mp(e.numlines_s[a-1]+e.numlines_s[a]+e.numlines_s[a+1]-1>0),(l=0|(r=20*(3*i-r)/(r*(e.numlines_s[a-1]+e.numlines_s[a]+e.numlines_s[a+1]-1))))>s&&(l=s),o[a]=l}else o[a]=0;mp(a==e.npart_s-1),(r=n[a-1]+n[a])>0?((i=t[a-1])<t[a]&&(i=t[a]),mp(e.numlines_s[a-1]+e.numlines_s[a]-1>0),(l=0|(r=20*(2*i-r)/(r*(e.numlines_s[a-1]+e.numlines_s[a]-1))))>s&&(l=s),o[a]=l):o[a]=0,mp(a==e.npart_s-1)}(c,u,m,f),i=l=0;l<c.npart_s;l++){var b,x,y,w,k,S=c.s3ind_s[l][0],M=c.s3ind_s[l][1];for(b=f[S],x=1,w=c.s3_ss[i]*n[S]*d[f[S]],++i,++S;S<=M;)b+=f[S],x+=1,w=_(w,y=c.s3_ss[i]*n[S]*d[f[S]],S-l),++i,++S;w*=k=.5*d[b=(1+2*b)/(2*x)],o[l]=w,c.nb_s2[s][l]=c.nb_s1[s][l],c.nb_s1[s][l]=w,y=u[l],y*=c.minval_s[l],y*=k,o[l]>y&&(o[l]=y),c.masking_lower>1&&(o[l]*=c.masking_lower),o[l]>n[l]&&(o[l]=n[l]),c.masking_lower<1&&(o[l]*=c.masking_lower),mp(o[l]>=0)}for(;l<ep.CBANDS;++l)n[l]=0,o[l]=0}function L(e,t,n,s,a){var r,i=cp(ep.CBANDS),l=cp(ep.CBANDS),c=dp(ep.CBANDS+2);A(e,t,n,i,l),R(e,i,l,c);var u=0;for(r=0;r<e.npart_l;r++){var m,f,p,h=e.s3ind[r][0],g=e.s3ind[r][1],v=0,b=0;for(v=c[h],b+=1,f=e.s3_ll[u]*n[h]*d[c[h]],++u,++h;h<=g;)v+=c[h],b+=1,f=_(f,m=e.s3_ll[u]*n[h]*d[c[h]],h-r),++u,++h;if(f*=p=.5*d[v=(1+2*v)/(2*b)],e.blocktype_old[1&a]==ep.SHORT_TYPE){var x=2*e.nb_1[a][r];s[r]=x>0?Math.min(f,x):Math.min(f,n[r]*o)}else{var y=16*e.nb_2[a][r],w=2*e.nb_1[a][r];y<=0&&(y=f),w<=0&&(w=f),x=e.blocktype_old[1&a]==ep.NORM_TYPE?Math.min(w,y):w,s[r]=Math.min(f,x)}e.nb_2[a][r]=e.nb_1[a][r],e.nb_1[a][r]=f,m=i[r],m*=e.minval_l[r],m*=p,s[r]>m&&(s[r]=m),e.masking_lower>1&&(s[r]*=e.masking_lower),s[r]>n[r]&&(s[r]=n[r]),e.masking_lower<1&&(s[r]*=e.masking_lower),mp(s[r]>=0)}for(;r<ep.CBANDS;++r)n[r]=0,s[r]=0}function P(e,t,n,o,s,a,r){for(var i,l,c=2*a,u=a>0?Math.pow(10,s):1,d=0;d<r;++d){var m=e[2][d],f=e[3][d],p=t[0][d],h=t[1][d],g=t[2][d],_=t[3][d];if(p<=1.58*h&&h<=1.58*p){var v=n[d]*f,b=n[d]*m;l=Math.max(g,Math.min(_,v)),i=Math.max(_,Math.min(g,b))}else l=g,i=_;if(a>0){var x,y,w=o[d]*u;if(x=Math.min(Math.max(p,w),Math.max(h,w)),(y=(g=Math.max(l,w))+(_=Math.max(i,w)))>0&&x*c<y){var k=x*c/y;g*=k,_*=k}l=Math.min(g,l),i=Math.min(_,i)}l>m&&(l=m),i>f&&(i=f),t[2][d]=l,t[3][d]=i}}function D(e,t){var n;return(n=e>=0?27*-e:e*t)<=-72?0:Math.exp(n*a)}function H(e){var t,n,o=0;for(o=0;D(o,e)>1e-20;o-=1);for(s=o,a=0;Math.abs(a-s)>1e-12;)D(o=(a+s)/2,e)>0?a=o:s=o;t=s;var s,a;o=0;for(o=0;D(o,e)>1e-20;o+=1);for(s=0,a=o;Math.abs(a-s)>1e-12;)D(o=(a+s)/2,e)>0?s=o:a=o;n=a;var r,i=0,l=1e3;for(r=0;r<=l;++r){i+=D(o=t+r*(n-t)/l,e)}return(l+1)/(i*(n-t))}function N(e){var t,n,o,s;return t=e,(t*=t>=0?3:1.5)>=.5&&t<=2.5?n=8*((s=t-.5)*s-2*s):n=0,(o=15.811389+7.5*(t+=.474)-17.5*Math.sqrt(1+t*t))<=-60?0:(t=Math.exp((n+o)*a),t/=.6609193)}function $(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function z(e,t,n,o,s,a,r,i,l,c,u,d){var m,f=cp(ep.CBANDS+1),p=i/(d>15?1152:384),h=dp(ep.HBLKSIZE);i/=l;var g=0,_=0;for(m=0;m<ep.CBANDS;m++){var v;for(R=$(i*g),f[m]=i*g,v=g;$(i*v)-R<.34&&v<=l/2;v++);for(e[m]=v-g,_=m+1;g<v;)h[g++]=m;if(g>l/2){g=l/2,++m;break}}f[m]=i*g;for(var b=0;b<d;b++){var x,y,w,k,S;w=c[b],k=c[b+1],(x=0|Math.floor(.5+u*(w-.5)))<0&&(x=0),(y=0|Math.floor(.5+u*(k-.5)))>l/2&&(y=l/2),n[b]=(h[x]+h[y])/2,t[b]=h[y];var M=p*k;r[b]=(M-f[t[b]])/(f[t[b]+1]-f[t[b]]),r[b]<0?r[b]=0:r[b]>1&&(r[b]=1),S=$(i*c[b]*u),S=Math.min(S,15.5)/15.5,a[b]=Math.pow(10,1.25*(1-Math.cos(Math.PI*S))-2.5)}g=0;for(var A=0;A<_;A++){var R,E,T=e[A];R=$(i*g),E=$(i*(g+T-1)),o[A]=.5*(R+E),R=$(i*(g-.5)),E=$(i*(g+T-.5)),s[A]=E-R,g+=T}return _}function V(e,t,n,o,s,a){var r,i=up([ep.CBANDS,ep.CBANDS]),l=0;if(a)for(var c=0;c<t;c++)for(r=0;r<t;r++){var u=N(n[c]-n[r])*o[r];i[c][r]=u*s[c]}else for(r=0;r<t;r++){var d=15+Math.min(21/n[r],12),m=H(d);for(c=0;c<t;c++){u=m*D(n[c]-n[r],d)*o[r];i[c][r]=u*s[c]}}for(c=0;c<t;c++){for(r=0;r<t&&!(i[c][r]>0);r++);for(e[c][0]=r,r=t-1;r>0&&!(i[c][r]>0);r--);e[c][1]=r,l+=e[c][1]-e[c][0]+1}var f=cp(l),p=0;for(c=0;c<t;c++)for(r=e[c][0];r<=e[c][1];r++)f[p++]=i[c][r];return f}function q(e){var t=$(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function U(e,t){return e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e),3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4)}this.L3psycho_anal_vbr=function(e,t,n,o,a,r,i,l,c,u){var d=e.internal_flags,m=cp(ep.HBLKSIZE),f=up([3,ep.HBLKSIZE_s]),p=up([2,ep.BLKSIZE]),h=up([2,3,ep.BLKSIZE_s]),g=up([4,ep.CBANDS]),_=up([4,ep.CBANDS]),x=up([4,3]),w=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],S=dp(2),A=e.mode==Xf.JOINT_STEREO?4:d.channels_out;(function(e,t,n,o,a,r,i,l,c,u){for(var d=up([2,576]),m=e.internal_flags,f=m.channels_out,p=e.mode==Xf.JOINT_STEREO?4:f,h=0;h<f;h++){firbuf=t[h];for(var g=n+576-350-s+192,_=0;_<576;_++){var v,b;v=firbuf[g+_+10],b=0;for(var x=0;x<9;x+=2)v+=C[x]*(firbuf[g+_+x]+firbuf[g+_+s-x]),b+=C[x+1]*(firbuf[g+_+x+1]+firbuf[g+_+s-x-1]);d[h][_]=v+b}a[o][h].en.assign(m.en[h]),a[o][h].thm.assign(m.thm[h]),p>2&&(r[o][h].en.assign(m.en[h+2]),r[o][h].thm.assign(m.thm[h+2]))}for(h=0;h<p;h++){var y=cp(12),w=cp(12),k=[0,0,0,0],S=d[1&h],M=0,A=3==h?m.nsPsy.attackthre_s:m.nsPsy.attackthre,R=1;if(2==h)for(_=0,x=576;x>0;++_,--x){var E=d[0][_],T=d[1][_];d[0][_]=E+T,d[1][_]=E-T}for(_=0;_<3;_++)w[_]=m.nsPsy.last_en_subshort[h][_+6],mp(m.nsPsy.last_en_subshort[h][_+4]>0),y[_]=w[_]/m.nsPsy.last_en_subshort[h][_+4],k[0]+=w[_];for(_=0;_<9;_++){for(var B=M+64,I=1;M<B;M++)I<Math.abs(S[M])&&(I=Math.abs(S[M]));m.nsPsy.last_en_subshort[h][_]=w[_+3]=I,k[1+_/3]+=I,I>w[_+3-2]?(mp(w[_+3-2]>0),I/=w[_+3-2]):I=w[_+3-2]>10*I?w[_+3-2]/(10*I):0,y[_+3]=I}for(_=0;_<3;++_){var j=w[3*_+3]+w[3*_+4]+w[3*_+5],O=1;6*w[3*_+5]<j&&(O*=.5,6*w[3*_+4]<j&&(O*=.5)),l[h][_]=O}if(e.analysis){var F=y[0];for(_=1;_<12;_++)F<y[_]&&(F=y[_]);m.pinfo.ers[o][h]=m.pinfo.ers_save[h],m.pinfo.ers_save[h]=F}for(_=0;_<12;_++)0==c[h][_/3]&&y[_]>A&&(c[h][_/3]=_%3+1);for(_=1;_<4;_++){var L=k[_-1],P=k[_];Math.max(L,P)<4e4&&L<1.7*P&&P<1.7*L&&(1==_&&c[h][0]<=c[h][_]&&(c[h][0]=0),c[h][_]=0)}c[h][0]<=m.nsPsy.lastAttacks[h]&&(c[h][0]=0),(3==m.nsPsy.lastAttacks[h]||c[h][0]+c[h][1]+c[h][2]+c[h][3]!=0)&&(R=0,0!=c[h][1]&&0!=c[h][0]&&(c[h][1]=0),0!=c[h][2]&&0!=c[h][1]&&(c[h][2]=0),0!=c[h][3]&&0!=c[h][2]&&(c[h][3]=0)),h<2?u[h]=R:0==R&&(u[0]=u[1]=0),i[h]=m.tot_ener[h]}})(e,t,n,o,a,r,c,x,w,S),function(e,t){var n=e.internal_flags;e.short_blocks==rp.short_block_coupled&&(0==t[0]||0==t[1])&&(t[0]=t[1]=0);for(var o=0;o<n.channels_out;o++)e.short_blocks==rp.short_block_dispensed&&(t[o]=1),e.short_blocks==rp.short_block_forced&&(t[o]=0)}(e,S);for(var R=0;R<A;R++){T(e,t,n,R,o,m,p,D=1&R),I(e,o,R,m),0!=S[D]?L(d,m,g[R],_[R],R):O(d,R)}S[0]+S[1]==2&&e.mode==Xf.JOINT_STEREO&&P(g,_,d.mld_cb_l,d.ATH.cb_l,e.ATHlower*d.ATH.adjust,e.msfix,d.npart_l);for(R=0;R<A;R++){0!=S[D=1&R]&&b(d,g[R],_[R],R)}for(var E=0;E<3;E++){for(R=0;R<A;++R){0!=S[D=1&R]?j(d,R,E):(B(e,t,n,R,E,f,h,D),F(e,f,g[R],_[R],R,E))}S[0]+S[1]==0&&e.mode==Xf.JOINT_STEREO&&P(g,_,d.mld_cb_s,d.ATH.cb_s,e.ATHlower*d.ATH.adjust,e.msfix,d.npart_s);for(R=0;R<A;++R){0==S[D=1&R]&&v(d,g[R],_[R],R,E)}}for(R=0;R<A;R++){var D;if(0==S[D=1&R])for(var H=0;H<ep.SBMAX_s;H++){var N=cp(3);for(E=0;E<3;E++){var $=d.thm[R].s[H][E];if($*=.8,w[R][E]>=2||1==w[R][E+1]){var z=0!=E?E-1:2,V=y(d.thm[R].s[H][z],$,.36);$=Math.min($,V)}else if(1==w[R][E]){z=0!=E?E-1:2,V=y(d.thm[R].s[H][z],$,.18);$=Math.min($,V)}else if(0!=E&&3==w[R][E-1]||0==E&&3==d.nsPsy.lastAttacks[R]){z=2!=E?E+1:0,V=y(d.thm[R].s[H][z],$,.18);$=Math.min($,V)}$*=x[R][E],N[E]=$}for(E=0;E<3;E++)d.thm[R].s[H][E]=N[E]}}for(R=0;R<A;R++)d.nsPsy.lastAttacks[R]=w[R][2];!function(e,t,n){for(var o=e.internal_flags,s=0;s<o.channels_out;s++){var a=ep.NORM_TYPE;0!=t[s]?(mp(o.blocktype_old[s]!=ep.START_TYPE),o.blocktype_old[s]==ep.SHORT_TYPE&&(a=ep.STOP_TYPE)):(a=ep.SHORT_TYPE,o.blocktype_old[s]==ep.NORM_TYPE&&(o.blocktype_old[s]=ep.START_TYPE),o.blocktype_old[s]==ep.STOP_TYPE&&(o.blocktype_old[s]=ep.SHORT_TYPE)),n[s]=o.blocktype_old[s],o.blocktype_old[s]=a}}(e,S,u);for(R=0;R<A;R++){var q,U,X,Y;R>1?(q=l,U=-2,X=ep.NORM_TYPE,(u[0]==ep.SHORT_TYPE||u[1]==ep.SHORT_TYPE)&&(X=ep.SHORT_TYPE),Y=r[o][R-2]):(q=i,U=0,X=u[R],Y=a[o][R]),X==ep.SHORT_TYPE?q[U+R]=k(Y,d.masking_lower):q[U+R]=M(Y,d.masking_lower),e.analysis&&(d.pinfo.pe[o][R]=q[U+R])}return 0},this.psymodel_init=function(n){var o,s=n.internal_flags,a=!0,r=13,i=24,d=0,m=0,f=-8.25,p=-4.5,h=cp(ep.CBANDS),g=cp(ep.CBANDS),_=cp(ep.CBANDS),v=n.out_samplerate;switch(n.experimentalZ){default:case 0:a=!0;break;case 1:a=!(n.VBR==sp.vbr_mtrh||n.VBR==sp.vbr_mt);break;case 2:a=!1;break;case 3:r=8,d=-1.75,m=-.0125,f=-8.25,p=-2.25}for(s.ms_ener_ratio_old=.25,s.blocktype_old[0]=s.blocktype_old[1]=ep.NORM_TYPE,o=0;o<4;++o){for(var b=0;b<ep.CBANDS;++b)s.nb_1[o][b]=1e20,s.nb_2[o][b]=1e20,s.nb_s1[o][b]=s.nb_s2[o][b]=1;for(var x=0;x<ep.SBMAX_l;x++)s.en[o].l[x]=1e20,s.thm[o].l[x]=1e20;for(b=0;b<3;++b){for(x=0;x<ep.SBMAX_s;x++)s.en[o].s[x][b]=1e20,s.thm[o].s[x][b]=1e20;s.nsPsy.lastAttacks[o]=0}for(b=0;b<9;b++)s.nsPsy.last_en_subshort[o][b]=10}for(s.loudness_sq_save[0]=s.loudness_sq_save[1]=0,s.npart_l=z(s.numlines_l,s.bo_l,s.bm_l,h,g,s.mld_l,s.PSY.bo_l_weight,v,ep.BLKSIZE,s.scalefac_band.l,ep.BLKSIZE/1152,ep.SBMAX_l),mp(s.npart_l<ep.CBANDS),o=0;o<s.npart_l;o++){var y=d;h[o]>=r&&(y=m*(h[o]-r)/(i-r)+d*(i-h[o])/(i-r)),_[o]=Math.pow(10,y/10),s.numlines_l[o]>0?s.rnumlines_l[o]=1/s.numlines_l[o]:s.rnumlines_l[o]=0}s.s3_ll=V(s.s3ind,s.npart_l,h,g,_,a);var w;b=0;for(o=0;o<s.npart_l;o++){M=ap.MAX_VALUE;for(var k=0;k<s.numlines_l[o];k++,b++){var S=v*b/(1e3*ep.BLKSIZE);A=this.ATHformula(1e3*S,n)-20,A=Math.pow(10,.1*A),M>(A*=s.numlines_l[o])&&(M=A)}s.ATH.cb_l[o]=M,(M=20*h[o]/10-20)>6&&(M=100),M<-15&&(M=-15),M-=8,s.minval_l[o]=Math.pow(10,M/10)*s.numlines_l[o]}for(s.npart_s=z(s.numlines_s,s.bo_s,s.bm_s,h,g,s.mld_s,s.PSY.bo_s_weight,v,ep.BLKSIZE_s,s.scalefac_band.s,ep.BLKSIZE_s/384,ep.SBMAX_s),mp(s.npart_s<ep.CBANDS),b=0,o=0;o<s.npart_s;o++){var M;y=f;h[o]>=r&&(y=p*(h[o]-r)/(i-r)+f*(i-h[o])/(i-r)),_[o]=Math.pow(10,y/10),M=ap.MAX_VALUE;for(k=0;k<s.numlines_s[o];k++,b++){var A;S=v*b/(1e3*ep.BLKSIZE_s);A=this.ATHformula(1e3*S,n)-20,A=Math.pow(10,.1*A),M>(A*=s.numlines_s[o])&&(M=A)}s.ATH.cb_s[o]=M,M=7*h[o]/12-7,h[o]>12&&(M*=1+3.1*Math.log(1+M)),h[o]<12&&(M*=1+2.3*Math.log(1-M)),M<-15&&(M=-15),M-=8,s.minval_s[o]=Math.pow(10,M/10)*s.numlines_s[o]}s.s3_ss=V(s.s3ind_s,s.npart_s,h,g,_,a),l=Math.pow(10,9/16),c=Math.pow(10,1.5),u=Math.pow(10,1.5),e.init_fft(s),s.decay=Math.exp(-1*t/(.01*v/192)),w=3.5,0!=(2&n.exp_nspsytune)&&(w=1),Math.abs(n.msfix)>0&&(w=n.msfix),n.msfix=w;for(var R=0;R<s.npart_l;R++)s.s3ind[R][1]>s.npart_l-1&&(s.s3ind[R][1]=s.npart_l-1);var E=576*s.mode_gr/v;if(s.ATH.decay=Math.pow(10,-1.2*E),s.ATH.adjust=.01,s.ATH.adjustLimit=1,mp(s.bo_l[ep.SBMAX_l-1]<=s.npart_l),mp(s.bo_s[ep.SBMAX_s-1]<=s.npart_s),-1!=n.ATHtype){var T=n.out_samplerate/ep.BLKSIZE,B=0;for(S=0,o=0;o<ep.BLKSIZE/2;++o)S+=T,s.ATH.eql_w[o]=1/Math.pow(10,this.ATHformula(S,n)/10),B+=s.ATH.eql_w[o];for(B=1/B,o=ep.BLKSIZE/2;--o>=0;)s.ATH.eql_w[o]*=B}for(R=b=0;R<s.npart_s;++R)for(o=0;o<s.numlines_s[R];++o)++b;for(R=b=0;R<s.npart_l;++R)for(o=0;o<s.numlines_l[R];++o)++b;for(b=0,o=0;o<s.npart_l;o++){S=v*(b+s.numlines_l[o]/2)/(1*ep.BLKSIZE);s.mld_cb_l[o]=q(S),b+=s.numlines_l[o]}for(;o<ep.CBANDS;++o)s.mld_cb_l[o]=1;for(b=0,o=0;o<s.npart_s;o++){S=v*(b+s.numlines_s[o]/2)/(1*ep.BLKSIZE_s);s.mld_cb_s[o]=q(S),b+=s.numlines_s[o]}for(;o<ep.CBANDS;++o)s.mld_cb_s[o]=1;return 0},this.ATHformula=function(e,t){var n;switch(t.ATHtype){case 0:n=U(e,9);break;case 1:n=U(e,-1);break;case 2:default:n=U(e,0);break;case 3:n=U(e,1)+6;break;case 4:n=U(e,t.ATHcurve)}return n}}function pp(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=Xf.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var hp={};hp.SFBMAX=3*ep.SBMAX_s;var gp=Ff.new_float,_p=Ff.new_int;function vp(){this.xr=gp(576),this.l3_enc=_p(576),this.scalefac=_p(hp.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=_p(3),this.subblock_gain=_p(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=_p(hp.SFBMAX),this.window=_p(hp.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=_p(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}this.assign=function(n){e.xr=function(e){return new Float32Array(e)}(n.xr),e.l3_enc=t(n.l3_enc),e.scalefac=t(n.scalefac),e.xrpow_max=n.xrpow_max,e.part2_3_length=n.part2_3_length,e.big_values=n.big_values,e.count1=n.count1,e.global_gain=n.global_gain,e.scalefac_compress=n.scalefac_compress,e.block_type=n.block_type,e.mixed_block_flag=n.mixed_block_flag,e.table_select=t(n.table_select),e.subblock_gain=t(n.subblock_gain),e.region0_count=n.region0_count,e.region1_count=n.region1_count,e.preflag=n.preflag,e.scalefac_scale=n.scalefac_scale,e.count1table_select=n.count1table_select,e.part2_length=n.part2_length,e.sfb_lmax=n.sfb_lmax,e.sfb_smin=n.sfb_smin,e.psy_lmax=n.psy_lmax,e.sfbmax=n.sfbmax,e.psymax=n.psymax,e.sfbdivide=n.sfbdivide,e.width=t(n.width),e.window=t(n.window),e.count1bits=n.count1bits,e.sfb_partition_table=n.sfb_partition_table.slice(0),e.slen=t(n.slen),e.max_nonzero_coeff=n.max_nonzero_coeff}}var bp=Ff.new_int;function xp(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[bp(4),bp(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new vp}var yp=Ff.System,wp=Ff.new_int;function kp(e,t,n,o){this.l=wp(1+ep.SBMAX_l),this.s=wp(1+ep.SBMAX_s),this.psfb21=wp(1+ep.PSFB21),this.psfb12=wp(1+ep.PSFB12);var s=this.l,a=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],yp.arraycopy(this.arrL,0,s,0,Math.min(this.arrL.length,this.l.length)),yp.arraycopy(this.arrS,0,a,0,Math.min(this.arrS.length,this.s.length)),yp.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),yp.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var Sp=Ff.new_float,Mp=Ff.new_float_n,Ap=Ff.new_int;function Rp(){this.last_en_subshort=Mp([4,9]),this.lastAttacks=Ap(4),this.pefirbuf=Sp(19),this.longfact=Sp(ep.SBMAX_l),this.shortfact=Sp(ep.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function Ep(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var Tp=Ff.new_byte,Bp=Ff.new_double,Ip=Ff.new_float,Cp=Ff.new_float_n,jp=Ff.new_int,Op=Ff.new_int_n;function Fp(){function e(){this.write_timing=0,this.ptr=0,this.buf=Tp(40)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Cp([2,Fp.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new xp,this.ms_ratio=Ip(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=jp(2),this.CurrentStep=jp(2),this.masking_lower=0,this.bv_scf=jp(576),this.pseudohalf=jp(hp.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Fp.BPC+1),this.itime=Bp(2),this.sideinfo_len=0,this.sb_sample=Cp([2,2,18,ep.SBLIMIT]),this.amp_filter=Ip(32),this.header=new Array(Fp.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new kp,this.minval_l=Ip(ep.CBANDS),this.minval_s=Ip(ep.CBANDS),this.nb_1=Cp([4,ep.CBANDS]),this.nb_2=Cp([4,ep.CBANDS]),this.nb_s1=Cp([4,ep.CBANDS]),this.nb_s2=Cp([4,ep.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=Ip(4),this.loudness_sq=Cp([2,2]),this.loudness_sq_save=Ip(2),this.mld_l=Ip(ep.SBMAX_l),this.mld_s=Ip(ep.SBMAX_s),this.bm_l=jp(ep.SBMAX_l),this.bo_l=jp(ep.SBMAX_l),this.bm_s=jp(ep.SBMAX_s),this.bo_s=jp(ep.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Op([ep.CBANDS,2]),this.s3ind_s=Op([ep.CBANDS,2]),this.numlines_s=jp(ep.CBANDS),this.numlines_l=jp(ep.CBANDS),this.rnumlines_l=Ip(ep.CBANDS),this.mld_cb_l=Ip(ep.CBANDS),this.mld_cb_s=Ip(ep.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=Ip(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=jp(2),this.nsPsy=new Rp,this.VBR_seek_table=new Ep,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Op([16,5]),this.bitrate_blockType_Hist=Op([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var t=0;t<this.en.length;t++)this.en[t]=new qf;for(t=0;t<this.thm.length;t++)this.thm[t]=new qf;for(t=0;t<this.header.length;t++)this.header[t]=new e}Fp.MFSIZE=3456+ep.ENCDELAY-ep.MDCTDELAY,Fp.MAX_HEADER_BUF=256,Fp.MAX_BITS_PER_CHANNEL=4095,Fp.MAX_BITS_PER_GRANULE=7680,Fp.BPC=320;var Lp=Ff.new_float;function Pp(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Lp(ep.SBMAX_l),this.s=Lp(ep.SBMAX_s),this.psfb21=Lp(ep.PSFB21),this.psfb12=Lp(ep.PSFB12),this.cb_l=Lp(ep.CBANDS),this.cb_s=Lp(ep.CBANDS),this.eql_w=Lp(ep.BLKSIZE/2)}var Dp=Ff.System,Hp=Ff.Arrays;function Np(){var e=Np.RMS_WINDOW_TIME_NUMERATOR,t=Np.RMS_WINDOW_TIME_DENOMINATOR,n=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],o=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function s(e,t,n,o,s,a){for(;0!=s--;)n[o]=1e-10+e[t+0]*a[0]-n[o-1]*a[1]+e[t-1]*a[2]-n[o-2]*a[3]+e[t-2]*a[4]-n[o-3]*a[5]+e[t-3]*a[6]-n[o-4]*a[7]+e[t-4]*a[8]-n[o-5]*a[9]+e[t-5]*a[10]-n[o-6]*a[11]+e[t-6]*a[12]-n[o-7]*a[13]+e[t-7]*a[14]-n[o-8]*a[15]+e[t-8]*a[16]-n[o-9]*a[17]+e[t-9]*a[18]-n[o-10]*a[19]+e[t-10]*a[20],++o,++t}function a(e,t,n,o,s,a){for(;0!=s--;)n[o]=e[t+0]*a[0]-n[o-1]*a[1]+e[t-1]*a[2]-n[o-2]*a[3]+e[t-2]*a[4],++o,++t}function r(e){return e*e}this.InitGainAnalysis=function(n,o){return function(n,o){for(var s=0;s<MAX_ORDER;s++)n.linprebuf[s]=n.lstepbuf[s]=n.loutbuf[s]=n.rinprebuf[s]=n.rstepbuf[s]=n.routbuf[s]=0;switch(0|o){case 48e3:n.reqindex=0;break;case 44100:n.reqindex=1;break;case 32e3:n.reqindex=2;break;case 24e3:n.reqindex=3;break;case 22050:n.reqindex=4;break;case 16e3:n.reqindex=5;break;case 12e3:n.reqindex=6;break;case 11025:n.reqindex=7;break;case 8e3:n.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return n.sampleWindow=0|(o*e+t-1)/t,n.lsum=0,n.rsum=0,n.totsamp=0,Hp.ill(n.A,0),INIT_GAIN_ANALYSIS_OK}(n,o)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(n.linpre=MAX_ORDER,n.rinpre=MAX_ORDER,n.lstep=MAX_ORDER,n.rstep=MAX_ORDER,n.lout=MAX_ORDER,n.rout=MAX_ORDER,Hp.fill(n.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,i,l,c,u,d){var m,f,p,h,g,_,v;if(0==u)return GAIN_ANALYSIS_OK;switch(v=0,g=u,d){case 1:l=t,c=i;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(u<MAX_ORDER?(Dp.arraycopy(t,i,e.linprebuf,MAX_ORDER,u),Dp.arraycopy(l,c,e.rinprebuf,MAX_ORDER,u)):(Dp.arraycopy(t,i,e.linprebuf,MAX_ORDER,MAX_ORDER),Dp.arraycopy(l,c,e.rinprebuf,MAX_ORDER,MAX_ORDER));g>0;){_=g>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:g,v<MAX_ORDER?(m=e.linpre+v,f=e.linprebuf,p=e.rinpre+v,h=e.rinprebuf,_>MAX_ORDER-v&&(_=MAX_ORDER-v)):(m=i+v,f=t,p=c+v,h=l),s(f,m,e.lstepbuf,e.lstep+e.totsamp,_,n[e.reqindex]),s(h,p,e.rstepbuf,e.rstep+e.totsamp,_,n[e.reqindex]),a(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,_,o[e.reqindex]),a(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,_,o[e.reqindex]),m=e.lout+e.totsamp,f=e.loutbuf,p=e.rout+e.totsamp,h=e.routbuf;for(var b=_%8;0!=b--;)e.lsum+=r(f[m++]),e.rsum+=r(h[p++]);for(b=_/8;0!=b--;)e.lsum+=r(f[m+0])+r(f[m+1])+r(f[m+2])+r(f[m+3])+r(f[m+4])+r(f[m+5])+r(f[m+6])+r(f[m+7]),m+=8,e.rsum+=r(h[p+0])+r(h[p+1])+r(h[p+2])+r(h[p+3])+r(h[p+4])+r(h[p+5])+r(h[p+6])+r(h[p+7]),p+=8;if(g-=_,v+=_,e.totsamp+=_,e.totsamp==e.sampleWindow){var x=10*Np.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),y=x<=0?0:0|x;y>=e.A.length&&(y=e.A.length-1),e.A[y]++,e.lsum=e.rsum=0,Dp.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),Dp.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),Dp.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),Dp.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return u<MAX_ORDER?(Dp.arraycopy(e.linprebuf,u,e.linprebuf,0,MAX_ORDER-u),Dp.arraycopy(e.rinprebuf,u,e.rinprebuf,0,MAX_ORDER-u),Dp.arraycopy(t,i,e.linprebuf,MAX_ORDER-u,u),Dp.arraycopy(l,c,e.rinprebuf,MAX_ORDER-u,u)):(Dp.arraycopy(t,i+u-MAX_ORDER,e.linprebuf,0,MAX_ORDER),Dp.arraycopy(l,c+u-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=function(e,t){var n,o=0;for(n=0;n<t;n++)o+=e[n];if(0==o)return GAIN_NOT_ENOUGH_SAMPLES;var s=0|Math.ceil(o*(1-.95));for(n=t;n-- >0&&!((s-=e[n])<=0););return 64.82-n/Np.STEPS_per_dB}(e.A,e.A.length),n=0;n<e.A.length;n++)e.B[n]+=e.A[n],e.A[n]=0;for(n=0;n<MAX_ORDER;n++)e.linprebuf[n]=e.lstepbuf[n]=e.loutbuf[n]=e.rinprebuf[n]=e.rstepbuf[n]=e.routbuf[n]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}Np.STEPS_per_dB=100,Np.MAX_dB=120,Np.GAIN_NOT_ENOUGH_SAMPLES=-24601,Np.GAIN_ANALYSIS_ERROR=0,Np.GAIN_ANALYSIS_OK=1,Np.INIT_GAIN_ANALYSIS_ERROR=0,Np.INIT_GAIN_ANALYSIS_OK=1,Np.YULE_ORDER=10,Np.MAX_ORDER=Np.YULE_ORDER,Np.MAX_SAMP_FREQ=48e3,Np.RMS_WINDOW_TIME_NUMERATOR=1,Np.RMS_WINDOW_TIME_DENOMINATOR=20,Np.MAX_SAMPLES_PER_WINDOW=Np.MAX_SAMP_FREQ*Np.RMS_WINDOW_TIME_NUMERATOR/Np.RMS_WINDOW_TIME_DENOMINATOR+1;var $p=Ff.new_float,zp=Ff.new_int;function Vp(){this.linprebuf=$p(NaN),this.linpre=0,this.lstepbuf=$p(NaN),this.lstep=0,this.loutbuf=$p(NaN),this.lout=0,this.rinprebuf=$p(NaN),this.rinpre=0,this.rstepbuf=$p(NaN),this.rstep=0,this.routbuf=$p(NaN),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=zp(0),this.B=zp(0)}function qp(e){this.bits=e}var Up=Ff.new_float,Xp=Ff.new_int,Yp=Ff.assert;function Gp(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,n,o){var s,a=e.internal_flags,r=Up(hp.SFBMAX),i=Up(576),l=Xp(2),c=0,u=a.l3_side,d=new qp(c);this.quantize.rv.ResvFrameBegin(e,d),c=d.bits;for(var m=0;m<a.mode_gr;m++){s=this.quantize.qupvt.on_pe(e,t,l,c,m,m),a.mode_ext==ep.MPG_MD_MS_LR&&(this.quantize.ms_convert(a.l3_side,m),this.quantize.qupvt.reduce_side(l,n[m],c,s));for(var f=0;f<a.channels_out;f++){var p,h,g=u.tt[m][f];g.block_type!=ep.SHORT_TYPE?(p=0,h=a.PSY.mask_adjust-p):(p=0,h=a.PSY.mask_adjust_short-p),a.masking_lower=Math.pow(10,.1*h),this.quantize.init_outer_loop(a,g),this.quantize.init_xrpow(a,g,i)&&(this.quantize.qupvt.calc_xmin(e,o[m][f],g,r),this.quantize.outer_loop(e,g,r,i,f,l[f])),this.quantize.iteration_finish_one(a,m,f),Yp(g.part2_3_length<=Fp.MAX_BITS_PER_CHANNEL),Yp(g.part2_3_length<=l[f])}}this.quantize.rv.ResvFrameEnd(a,c)}}function Kp(e,t,n,o){this.xlen=e,this.linmax=t,this.table=n,this.hlen=o}var Zp={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};Zp.ht=[new Kp(0,0,null,null),new Kp(2,0,Zp.t1HB,Zp.t1l),new Kp(3,0,Zp.t2HB,Zp.t2l),new Kp(3,0,Zp.t3HB,Zp.t3l),new Kp(0,0,null,null),new Kp(4,0,Zp.t5HB,Zp.t5l),new Kp(4,0,Zp.t6HB,Zp.t6l),new Kp(6,0,Zp.t7HB,Zp.t7l),new Kp(6,0,Zp.t8HB,Zp.t8l),new Kp(6,0,Zp.t9HB,Zp.t9l),new Kp(8,0,Zp.t10HB,Zp.t10l),new Kp(8,0,Zp.t11HB,Zp.t11l),new Kp(8,0,Zp.t12HB,Zp.t12l),new Kp(16,0,Zp.t13HB,Zp.t13l),new Kp(0,0,null,Zp.t16_5l),new Kp(16,0,Zp.t15HB,Zp.t15l),new Kp(1,1,Zp.t16HB,Zp.t16l),new Kp(2,3,Zp.t16HB,Zp.t16l),new Kp(3,7,Zp.t16HB,Zp.t16l),new Kp(4,15,Zp.t16HB,Zp.t16l),new Kp(6,63,Zp.t16HB,Zp.t16l),new Kp(8,255,Zp.t16HB,Zp.t16l),new Kp(10,1023,Zp.t16HB,Zp.t16l),new Kp(13,8191,Zp.t16HB,Zp.t16l),new Kp(4,15,Zp.t24HB,Zp.t24l),new Kp(5,31,Zp.t24HB,Zp.t24l),new Kp(6,63,Zp.t24HB,Zp.t24l),new Kp(7,127,Zp.t24HB,Zp.t24l),new Kp(8,255,Zp.t24HB,Zp.t24l),new Kp(9,511,Zp.t24HB,Zp.t24l),new Kp(11,2047,Zp.t24HB,Zp.t24l),new Kp(13,8191,Zp.t24HB,Zp.t24l),new Kp(0,0,Zp.t32HB,Zp.t32l),new Kp(0,0,Zp.t33HB,Zp.t33l)],Zp.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],Zp.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],Zp.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],Zp.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],Zp.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],Zp.scfsi_band=[0,6,11,16,21];var Wp=Ff.VbrMode,Qp=Ff.Float,Jp=Ff.Util,eh=Ff.new_float,th=Ff.new_int,nh=Ff.assert;function oh(){var e=null,t=null,n=null;function o(e){return u[e+oh.Q_MAX2]}this.setModules=function(o,s,a){e=o,t=s,n=a},this.IPOW20=function(e){return d[e]};var s=2220446049250313e-31,a=oh.IXMAX_VAL+2,r=oh.Q_MAX,i=oh.Q_MAX2,l=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var c=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=c,this.sfBandIndex=[new kp([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new kp([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new kp([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new kp([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new kp([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new kp([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new kp([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new kp([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new kp([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var u=eh(r+i+1),d=eh(r),m=eh(a),f=eh(a);function p(e,t){var o=n.ATHformula(t,e);return o-=l,o=Math.pow(10,o/10+e.ATHlower)}function h(e){this.s=e}this.adj43=f,this.iteration_init=function(t){var n,o=t.internal_flags,s=o.l3_side;if(0==o.iteration_init_init){for(o.iteration_init_init=1,s.main_data_begin=0,function(e){for(var t=e.internal_flags.ATH.l,n=e.internal_flags.ATH.psfb21,o=e.internal_flags.ATH.s,s=e.internal_flags.ATH.psfb12,a=e.internal_flags,r=e.out_samplerate,i=0;i<ep.SBMAX_l;i++){var l=a.scalefac_band.l[i],c=a.scalefac_band.l[i+1];t[i]=Qp.MAX_VALUE;for(var u=l;u<c;u++){var d=p(e,u*r/1152);t[i]=Math.min(t[i],d)}}for(i=0;i<ep.PSFB21;i++)for(l=a.scalefac_band.psfb21[i],c=a.scalefac_band.psfb21[i+1],n[i]=Qp.MAX_VALUE,u=l;u<c;u++)d=p(e,u*r/1152),n[i]=Math.min(n[i],d);for(i=0;i<ep.SBMAX_s;i++){for(l=a.scalefac_band.s[i],c=a.scalefac_band.s[i+1],o[i]=Qp.MAX_VALUE,u=l;u<c;u++)d=p(e,u*r/384),o[i]=Math.min(o[i],d);o[i]*=a.scalefac_band.s[i+1]-a.scalefac_band.s[i]}for(i=0;i<ep.PSFB12;i++){for(l=a.scalefac_band.psfb12[i],c=a.scalefac_band.psfb12[i+1],s[i]=Qp.MAX_VALUE,u=l;u<c;u++)d=p(e,u*r/384),s[i]=Math.min(s[i],d);s[i]*=a.scalefac_band.s[13]-a.scalefac_band.s[12]}if(e.noATH){for(i=0;i<ep.SBMAX_l;i++)t[i]=1e-20;for(i=0;i<ep.PSFB21;i++)n[i]=1e-20;for(i=0;i<ep.SBMAX_s;i++)o[i]=1e-20;for(i=0;i<ep.PSFB12;i++)s[i]=1e-20}a.ATH.floor=10*Math.log10(p(e,-1))}(t),m[0]=0,n=1;n<a;n++)m[n]=Math.pow(n,4/3);for(n=0;n<a-1;n++)f[n]=n+1-Math.pow(.5*(m[n]+m[n+1]),.75);for(f[n]=.5,n=0;n<r;n++)d[n]=Math.pow(2,-.1875*(n-210));for(n=0;n<=r+i;n++)u[n]=Math.pow(2,.25*(n-210-i));var l,c,h,g;for(e.huffman_init(o),(n=t.exp_nspsytune>>2&63)>=32&&(n-=64),l=Math.pow(10,n/4/10),(n=t.exp_nspsytune>>8&63)>=32&&(n-=64),c=Math.pow(10,n/4/10),(n=t.exp_nspsytune>>14&63)>=32&&(n-=64),h=Math.pow(10,n/4/10),(n=t.exp_nspsytune>>20&63)>=32&&(n-=64),g=h*Math.pow(10,n/4/10),n=0;n<ep.SBMAX_l;n++){_=n<=6?l:n<=13?c:n<=20?h:g,o.nsPsy.longfact[n]=_}for(n=0;n<ep.SBMAX_s;n++){var _;_=n<=5?l:n<=10?c:n<=11?h:g,o.nsPsy.shortfact[n]=_}}},this.on_pe=function(e,n,o,s,a,r){var i,l,c=e.internal_flags,u=0,d=th(2),m=new qp(u),f=t.ResvMaxBits(e,s,m,r),p=(u=m.bits)+f;for(p>Fp.MAX_BITS_PER_GRANULE&&(p=Fp.MAX_BITS_PER_GRANULE),i=0,l=0;l<c.channels_out;++l)o[l]=Math.min(Fp.MAX_BITS_PER_CHANNEL,u/c.channels_out),d[l]=0|o[l]*n[a][l]/700-o[l],d[l]>3*s/4&&(d[l]=3*s/4),d[l]<0&&(d[l]=0),d[l]+o[l]>Fp.MAX_BITS_PER_CHANNEL&&(d[l]=Math.max(0,Fp.MAX_BITS_PER_CHANNEL-o[l])),i+=d[l];if(i>f)for(l=0;l<c.channels_out;++l)d[l]=f*d[l]/i;for(l=0;l<c.channels_out;++l)o[l]+=d[l],f-=d[l];for(i=0,l=0;l<c.channels_out;++l)i+=o[l];if(i>Fp.MAX_BITS_PER_GRANULE){for(l=0;l<c.channels_out;++l)o[l]*=Fp.MAX_BITS_PER_GRANULE,o[l]/=i,o[l]}return p},this.reduce_side=function(e,t,n,o){nh(e[0]+e[1]<=Fp.MAX_BITS_PER_GRANULE);var s=.33*(.5-t)/.5;s<0&&(s=0),s>.5&&(s=.5);var a=0|.5*s*(e[0]+e[1]);a>Fp.MAX_BITS_PER_CHANNEL-e[0]&&(a=Fp.MAX_BITS_PER_CHANNEL-e[0]),a<0&&(a=0),e[1]>=125&&(e[1]-a>125?(e[0]<n&&(e[0]+=a),e[1]-=a):(e[0]+=e[1]-125,e[1]=125)),(a=e[0]+e[1])>o&&(e[0]=o*e[0]/a,e[1]=o*e[1]/a),nh(e[0]<=Fp.MAX_BITS_PER_CHANNEL),nh(e[1]<=Fp.MAX_BITS_PER_CHANNEL),nh(e[0]+e[1]<=Fp.MAX_BITS_PER_GRANULE)},this.athAdjust=function(e,t,n){var o=90.30873362,s=Jp.FAST_LOG10_X(t,10),a=e*e,r=0;return s-=n,a>1e-20&&(r=1+Jp.FAST_LOG10_X(a,10/o)),r<0&&(r=0),s*=r,s+=n+o-94.82444863,Math.pow(10,.1*s)},this.calc_xmin=function(e,t,n,o){var a,r=0,i=e.internal_flags,l=0,c=0,u=i.ATH,d=n.xr,m=e.VBR==Wp.vbr_mtrh?1:0,f=i.masking_lower;for((e.VBR==Wp.vbr_mtrh||e.VBR==Wp.vbr_mt)&&(f=1),a=0;a<n.psy_lmax;a++){y=(x=e.VBR==Wp.vbr_rh||e.VBR==Wp.vbr_mtrh?athAdjust(u.adjust,u.l[a],u.floor):u.adjust*u.l[a])/(_=n.width[a]),w=s,A=_>>1,M=0;do{M+=R=d[l]*d[l],w+=R<y?R:y,M+=E=d[++l]*d[l],w+=E<y?E:y,l++}while(--A>0);if(M>x&&c++,a==ep.SBPSY_l)w<(S=x*i.nsPsy.longfact[a])&&(w=S);if(0!=m&&(x=w),!e.ATHonly)if((k=t.en.l[a])>0)S=M*t.thm.l[a]*f/k,0!=m&&(S*=i.nsPsy.longfact[a]),x<S&&(x=S);o[r++]=0!=m?x:x*i.nsPsy.longfact[a]}var p=575;if(n.block_type!=ep.SHORT_TYPE)for(var h=576;0!=h--&&hh.EQ(d[h],0);)p=h;n.max_nonzero_coeff=p;for(var g=n.sfb_smin;a<n.psymax;g++,a+=3){var _,v,b;for(b=e.VBR==Wp.vbr_rh||e.VBR==Wp.vbr_mtrh?athAdjust(u.adjust,u.s[g],u.floor):u.adjust*u.s[g],_=n.width[a],v=0;v<3;v++){var x,y,w,k,S,M=0,A=_>>1;y=b/_,w=s;do{var R,E;M+=R=d[l]*d[l],w+=R<y?R:y,M+=E=d[++l]*d[l],w+=E<y?E:y,l++}while(--A>0);if(M>b&&c++,g==ep.SBPSY_s)w<(S=b*i.nsPsy.shortfact[g])&&(w=S);if(x=0!=m?w:b,!e.ATHonly&&!e.ATHshort)if((k=t.en.s[g][v])>0)S=M*t.thm.s[g][v]*f/k,0!=m&&(S*=i.nsPsy.shortfact[g]),x<S&&(x=S);o[r++]=0!=m?x:x*i.nsPsy.shortfact[g]}e.useTemporal&&(o[r-3]>o[r-3+1]&&(o[r-3+1]+=(o[r-3]-o[r-3+1])*i.decay),o[r-3+1]>o[r-3+2]&&(o[r-3+2]+=(o[r-3+1]-o[r-3+2])*i.decay))}return c},this.calc_noise_core=function(e,t,n,o){var s=0,a=t.s,r=e.l3_enc;if(a>e.count1)for(;0!=n--;){l=e.xr[a],a++,s+=l*l,l=e.xr[a],a++,s+=l*l}else if(a>e.big_values){var i=eh(2);for(i[0]=0,i[1]=o;0!=n--;){l=Math.abs(e.xr[a])-i[r[a]],a++,s+=l*l,l=Math.abs(e.xr[a])-i[r[a]],a++,s+=l*l}}else for(;0!=n--;){var l;l=Math.abs(e.xr[a])-m[r[a]]*o,a++,s+=l*l,l=Math.abs(e.xr[a])-m[r[a]]*o,a++,s+=l*l}return t.s=a,s},this.calc_noise=function(e,t,n,s,a){var r,i,l=0,u=0,d=0,m=0,f=0,p=-20,g=0,_=e.scalefac,v=0;for(s.over_SSD=0,r=0;r<e.psymax;r++){var b,x=e.global_gain-(_[v++]+(0!=e.preflag?c[r]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[r]],y=0;if(null!=a&&a.step[r]==x)y=a.noise[r],g+=e.width[r],n[l++]=y/t[u++],y=a.noise_log[r];else{var w,k=o(x);if(i=e.width[r]>>1,g+e.width[r]>e.max_nonzero_coeff)i=(w=e.max_nonzero_coeff-g+1)>0?w>>1:0;var S=new h(g);y=this.calc_noise_core(e,S,i,k),g=S.s,null!=a&&(a.step[r]=x,a.noise[r]=y),y=n[l++]=y/t[u++],y=Jp.FAST_LOG10(Math.max(y,1e-20)),null!=a&&(a.noise_log[r]=y)}if(null!=a&&(a.global_gain=e.global_gain),f+=y,y>0)b=Math.max(0|10*y+.5,1),s.over_SSD+=b*b,d++,m+=y;p=Math.max(p,y)}return s.over_count=d,s.tot_noise=f,s.over_noise=m,s.max_noise=p,d},this.set_pinfo=function(e,t,n,o,s){var a,r,i,l,u,d=e.internal_flags,m=0==t.scalefac_scale?.5:1,f=t.scalefac,p=eh(L3Side.SFBMAX),h=eh(L3Side.SFBMAX),g=new CalcNoiseResult;calc_xmin(e,n,t,p),calc_noise(t,p,h,g,null);var _=0;for(r=t.sfb_lmax,t.block_type!=ep.SHORT_TYPE&&0==t.mixed_block_flag&&(r=22),a=0;a<r;a++){var v=d.scalefac_band.l[a],b=(x=d.scalefac_band.l[a+1])-v;for(l=0;_<x;_++)l+=t.xr[_]*t.xr[_];l/=b,u=1e15,d.pinfo.en[o][s][a]=u*l,d.pinfo.xfsf[o][s][a]=u*p[a]*h[a]/b,n.en.l[a]>0&&!e.ATHonly?l/=n.en.l[a]:l=0,d.pinfo.thr[o][s][a]=u*Math.max(l*n.thm.l[a],d.ATH.l[a]),d.pinfo.LAMEsfb[o][s][a]=0,0!=t.preflag&&a>=11&&(d.pinfo.LAMEsfb[o][s][a]=-m*c[a]),a<ep.SBPSY_l&&(nh(f[a]>=0),d.pinfo.LAMEsfb[o][s][a]-=m*f[a])}if(t.block_type==ep.SHORT_TYPE)for(r=a,a=t.sfb_smin;a<ep.SBMAX_s;a++){v=d.scalefac_band.s[a],b=(x=d.scalefac_band.s[a+1])-v;for(var x,y=0;y<3;y++){for(l=0,i=v;i<x;i++)l+=t.xr[_]*t.xr[_],_++;l=Math.max(l/b,1e-20),u=1e15,d.pinfo.en_s[o][s][3*a+y]=u*l,d.pinfo.xfsf_s[o][s][3*a+y]=u*p[r]*h[r]/b,n.en.s[a][y]>0?l/=n.en.s[a][y]:l=0,(e.ATHonly||e.ATHshort)&&(l=0),d.pinfo.thr_s[o][s][3*a+y]=u*Math.max(l*n.thm.s[a][y],d.ATH.s[a]),d.pinfo.LAMEsfb_s[o][s][3*a+y]=-2*t.subblock_gain[y],a<ep.SBPSY_s&&(d.pinfo.LAMEsfb_s[o][s][3*a+y]-=m*f[r]),r++}}d.pinfo.LAMEqss[o][s]=t.global_gain,d.pinfo.LAMEmainbits[o][s]=t.part2_3_length+t.part2_length,d.pinfo.LAMEsfbits[o][s]=t.part2_length,d.pinfo.over[o][s]=g.over_count,d.pinfo.max_noise[o][s]=10*g.max_noise,d.pinfo.over_noise[o][s]=10*g.over_noise,d.pinfo.tot_noise[o][s]=10*g.tot_noise,d.pinfo.over_SSD[o][s]=g.over_SSD}}oh.Q_MAX=257,oh.Q_MAX2=116,oh.LARGE_BITS=1e5,oh.IXMAX_VAL=8206;var sh=Ff.System,ah=Ff.Arrays,rh=Ff.new_int,ih=Ff.assert;function lh(){var e=null;function t(e){this.bits=0|e}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function o(e,t,n,o,s,a){var r=.5946/t;for(e>>=1;0!=e--;)s[a++]=r>n[o++]?0:1,s[a++]=r>n[o++]?0:1}function s(t,n,o,s,a,r){var i=(t>>=1)%2;for(t>>=1;0!=t--;){var l,c,u,d,m,f,p,h;l=o[s++]*n,c=o[s++]*n,m=0|l,u=o[s++]*n,f=0|c,d=o[s++]*n,p=0|u,l+=e.adj43[m],h=0|d,c+=e.adj43[f],a[r++]=0|l,u+=e.adj43[p],a[r++]=0|c,d+=e.adj43[h],a[r++]=0|u,a[r++]=0|d}0!=i&&(m=0|(l=o[s++]*n),f=0|(c=o[s++]*n),l+=e.adj43[m],c+=e.adj43[f],a[r++]=0|l,a[r++]=0|c)}var a=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function r(e,t,n,o){var s=function(e,t,n){var o=0,s=0;do{var a=e[t++],r=e[t++];o<a&&(o=a),s<r&&(s=r)}while(t<n);return o<s&&(o=s),o}(e,t,n);switch(s){case 0:return s;case 1:return function(e,t,n,o){var s=0,a=Zp.ht[1].hlen;do{var r=2*e[t+0]+e[t+1];t+=2,s+=a[r]}while(t<n);return o.bits+=s,1}(e,t,n,o);case 2:case 3:return function(e,t,n,o,s){var a,r,i=0,l=Zp.ht[o].xlen;r=2==o?Zp.table23:Zp.table56;do{var c=e[t+0]*l+e[t+1];t+=2,i+=r[c]}while(t<n);return a=65535&i,(i>>=16)>a&&(i=a,o++),s.bits+=i,o}(e,t,n,a[s-1],o);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(e,t,n,o,s){var a=0,r=0,i=0,l=Zp.ht[o].xlen,c=Zp.ht[o].hlen,u=Zp.ht[o+1].hlen,d=Zp.ht[o+2].hlen;do{var m=e[t+0]*l+e[t+1];t+=2,a+=c[m],r+=u[m],i+=d[m]}while(t<n);var f=o;return a>r&&(a=r,f++),a>i&&(a=i,f=o+2),s.bits+=a,f}(e,t,n,a[s-1],o);default:if(s>oh.IXMAX_VAL)return o.bits=oh.LARGE_BITS,-1;var r,i;for(s-=15,r=24;r<32&&!(Zp.ht[r].linmax>=s);r++);for(i=r-8;i<24&&!(Zp.ht[i].linmax>=s);i++);return function(e,t,n,o,s,a){var r,i=65536*Zp.ht[o].xlen+Zp.ht[s].xlen,l=0;do{var c=e[t++],u=e[t++];0!=c&&(c>14&&(c=15,l+=i),c*=16),0!=u&&(u>14&&(u=15,l+=i),c+=u),l+=Zp.largetbl[c]}while(t<n);return r=65535&l,(l>>=16)>r&&(l=r,o=s),a.bits+=l,o}(e,t,n,i,r,o)}}function i(e,n,o,s,a,i,l,c){for(var u=n.big_values,d=2;d<ep.SBMAX_l+1;d++){var m=e.scalefac_band.l[d];if(m>=u)break;var f=a[d-2]+n.count1bits;if(o.part2_3_length<=f)break;var p=new t(f),h=r(s,m,u,p);f=p.bits,!(o.part2_3_length<=f)&&(o.assign(n),o.part2_3_length=f,o.region0_count=i[d-2],o.region1_count=d-2-i[d-2],o.table_select[0]=l[d-2],o.table_select[1]=c[d-2],o.table_select[2]=h)}}this.noquant_count_bits=function(e,n,o){var s=n.l3_enc,a=Math.min(576,n.max_nonzero_coeff+2>>1<<1);for(null!=o&&(o.sfb_count1=0);a>1&&0==(s[a-1]|s[a-2]);a-=2);n.count1=a;for(var i=0,l=0;a>3;a-=4){var c;if((2147483647&(s[a-1]|s[a-2]|s[a-3]|s[a-4]))>1)break;c=2*(2*(2*s[a-4]+s[a-3])+s[a-2])+s[a-1],i+=Zp.t32l[c],l+=Zp.t33l[c]}var u=i;if(n.count1table_select=0,i>l&&(u=l,n.count1table_select=1),n.count1bits=u,n.big_values=a,0==a)return u;if(n.block_type==ep.SHORT_TYPE)(i=3*e.scalefac_band.s[3])>n.big_values&&(i=n.big_values),l=n.big_values;else if(n.block_type==ep.NORM_TYPE){if(i=n.region0_count=e.bv_scf[a-2],l=n.region1_count=e.bv_scf[a-1],l=e.scalefac_band.l[i+l+2],i=e.scalefac_band.l[i+1],l<a){var d=new t(u);n.table_select[2]=r(s,l,a,d),u=d.bits}}else n.region0_count=7,n.region1_count=ep.SBMAX_l-1-7-1,(i=e.scalefac_band.l[8])>(l=a)&&(i=l);if(i=Math.min(i,a),l=Math.min(l,a),i>0){d=new t(u);n.table_select[0]=r(s,0,i,d),u=d.bits}if(i<l){d=new t(u);n.table_select[1]=r(s,i,l,d),u=d.bits}if(2==e.use_best_huffman&&(n.part2_3_length=u,best_huffman_divide(e,n),u=n.part2_3_length),null!=o&&n.block_type==ep.NORM_TYPE){for(var m=0;e.scalefac_band.l[m]<n.big_values;)m++;o.sfb_count1=m}return u},this.count_bits=function(t,n,a,r){var i=a.l3_enc,l=oh.IXMAX_VAL/e.IPOW20(a.global_gain);if(a.xrpow_max>l)return oh.LARGE_BITS;if(function(t,n,a,r,i){var l,c,u,d=0,m=0,f=0,p=0,h=n,g=0,_=h,v=0,b=t,x=0;for(u=null!=i&&r.global_gain==i.global_gain,c=r.block_type==ep.SHORT_TYPE?38:21,l=0;l<=c;l++){var y=-1;if((u||r.block_type==ep.NORM_TYPE)&&(y=r.global_gain-(r.scalefac[l]+(0!=r.preflag?e.pretab[l]:0)<<r.scalefac_scale+1)-8*r.subblock_gain[r.window[l]]),ih(r.width[l]>=0),u&&i.step[l]==y)0!=m&&(s(m,a,b,x,_,v),m=0),0!=f&&(o(f,a,b,x,_,v),f=0);else{var w,k=r.width[l];if(d+r.width[l]>r.max_nonzero_coeff&&(w=r.max_nonzero_coeff-d+1,ah.fill(n,r.max_nonzero_coeff,576,0),(k=w)<0&&(k=0),l=c+1),0==m&&0==f&&(_=h,v=g,b=t,x=p),null!=i&&i.sfb_count1>0&&l>=i.sfb_count1&&i.step[l]>0&&y>=i.step[l]?(0!=m&&(s(m,a,b,x,_,v),m=0,_=h,v=g,b=t,x=p),f+=k):(0!=f&&(o(f,a,b,x,_,v),f=0,_=h,v=g,b=t,x=p),m+=k),k<=0){0!=f&&(o(f,a,b,x,_,v),f=0),0!=m&&(s(m,a,b,x,_,v),m=0);break}}l<=c&&(g+=r.width[l],p+=r.width[l],d+=r.width[l])}0!=m&&(s(m,a,b,x,_,v),m=0),0!=f&&(o(f,a,b,x,_,v),f=0)}(n,i,e.IPOW20(a.global_gain),a,r),0!=(2&t.substep_shaping))for(var c=0,u=a.global_gain+a.scalefac_scale,d=.634521682242439/e.IPOW20(u),m=0;m<a.sfbmax;m++){var f,p=a.width[m];if(0==t.pseudohalf[m])c+=p;else for(f=c,c+=p;f<c;++f)i[f]=n[f]>=d?i[f]:0}return this.noquant_count_bits(t,a,r)},this.best_huffman_divide=function(e,n){var o=new vp,s=n.l3_enc,a=rh(23),l=rh(23),c=rh(23),u=rh(23);if(n.block_type!=ep.SHORT_TYPE||1!=e.mode_gr){o.assign(n),n.block_type==ep.NORM_TYPE&&(function(e,n,o,s,a,i,l){for(var c=n.big_values,u=0;u<=22;u++)s[u]=oh.LARGE_BITS;for(u=0;u<16;u++){var d=e.scalefac_band.l[u+1];if(d>=c)break;var m=0,f=new t(m),p=r(o,0,d,f);m=f.bits;for(var h=0;h<8;h++){var g=e.scalefac_band.l[u+h+2];if(g>=c)break;var _=m,v=r(o,d,g,f=new t(_));_=f.bits,s[u+h]>_&&(s[u+h]=_,a[u+h]=u,i[u+h]=p,l[u+h]=v)}}}(e,n,s,a,l,c,u),i(e,o,n,s,a,l,c,u));var d=o.big_values;if(!(0==d||(s[d-2]|s[d-1])>1||(d=n.count1+2,d>576))){o.assign(n),o.count1=d;for(var m=0,f=0;d>o.big_values;d-=4){var p=2*(2*(2*s[d-4]+s[d-3])+s[d-2])+s[d-1];m+=Zp.t32l[p],f+=Zp.t33l[p]}if(o.big_values=d,o.count1table_select=0,m>f&&(m=f,o.count1table_select=1),o.count1bits=m,o.block_type==ep.NORM_TYPE)i(e,o,n,s,a,l,c,u);else{if(o.part2_3_length=m,(m=e.scalefac_band.l[8])>d&&(m=d),m>0){var h=new t(o.part2_3_length);o.table_select[0]=r(s,0,m,h),o.part2_3_length=h.bits}if(d>m){h=new t(o.part2_3_length);o.table_select[1]=r(s,m,d,h),o.part2_3_length=h.bits}n.part2_3_length>o.part2_3_length&&n.assign(o)}}}};var l=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],c=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],u=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],d=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];lh.slen1_tab=u,lh.slen2_tab=d,this.best_scalefac_store=function(t,n,o,s){var a,r,i,m,f=s.tt[n][o],p=0;for(i=0,a=0;a<f.sfbmax;a++){var h=f.width[a];for(i+=h,m=-h;m<0&&0==f.l3_enc[m+i];m++);0==m&&(f.scalefac[a]=p=-2)}if(0==f.scalefac_scale&&0==f.preflag){var g=0;for(a=0;a<f.sfbmax;a++)f.scalefac[a]>0&&(g|=f.scalefac[a]);if(0==(1&g)&&0!=g){for(a=0;a<f.sfbmax;a++)f.scalefac[a]>0&&(f.scalefac[a]>>=1);f.scalefac_scale=p=1}}if(0==f.preflag&&f.block_type!=ep.SHORT_TYPE&&2==t.mode_gr){for(a=11;a<ep.SBPSY_l&&!(f.scalefac[a]<e.pretab[a]&&-2!=f.scalefac[a]);a++);if(a==ep.SBPSY_l){for(a=11;a<ep.SBPSY_l;a++)f.scalefac[a]>0&&(f.scalefac[a]-=e.pretab[a]);f.preflag=p=1}}for(r=0;r<4;r++)s.scfsi[o][r]=0;for(2==t.mode_gr&&1==n&&s.tt[0][o].block_type!=ep.SHORT_TYPE&&s.tt[1][o].block_type!=ep.SHORT_TYPE&&(function(e,t){for(var n,o=t.tt[1][e],s=t.tt[0][e],a=0;a<Zp.scfsi_band.length-1;a++){for(n=Zp.scfsi_band[a];n<Zp.scfsi_band[a+1]&&!(s.scalefac[n]!=o.scalefac[n]&&o.scalefac[n]>=0);n++);if(n==Zp.scfsi_band[a+1]){for(n=Zp.scfsi_band[a];n<Zp.scfsi_band[a+1];n++)o.scalefac[n]=-1;t.scfsi[e][a]=1}}var r=0,i=0;for(n=0;n<11;n++)-1!=o.scalefac[n]&&(i++,r<o.scalefac[n]&&(r=o.scalefac[n]));for(var m=0,f=0;n<ep.SBPSY_l;n++)-1!=o.scalefac[n]&&(f++,m<o.scalefac[n]&&(m=o.scalefac[n]));for(a=0;a<16;a++)if(r<l[a]&&m<c[a]){var p=u[a]*i+d[a]*f;o.part2_length>p&&(o.part2_length=p,o.scalefac_compress=a)}}(o,s),p=0),a=0;a<f.sfbmax;a++)-2==f.scalefac[a]&&(f.scalefac[a]=0);0!=p&&(2==t.mode_gr?this.scale_bitcount(f):this.scale_bitcount_lsf(t,f))};var m=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],f=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],p=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var n,o,s,a=0,r=0,i=t.scalefac;if(ih(function(e,t){for(var n=0;n<t;++n)if(e[n]<0)return!1;return!0}(i,t.sfbmax)),t.block_type==ep.SHORT_TYPE)s=m,0!=t.mixed_block_flag&&(s=f);else if(s=p,0==t.preflag){for(o=11;o<ep.SBPSY_l&&!(i[o]<e.pretab[o]);o++);if(o==ep.SBPSY_l)for(t.preflag=1,o=11;o<ep.SBPSY_l;o++)i[o]-=e.pretab[o]}for(o=0;o<t.sfbdivide;o++)a<i[o]&&(a=i[o]);for(;o<t.sfbmax;o++)r<i[o]&&(r=i[o]);for(t.part2_length=oh.LARGE_BITS,n=0;n<16;n++)a<l[n]&&r<c[n]&&t.part2_length>s[n]&&(t.part2_length=s[n],t.scalefac_compress=n);return t.part2_length==oh.LARGE_BITS};var h=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,n){var o,s,a,r,i,l,c,u,d=rh(4),m=n.scalefac;for(o=0!=n.preflag?2:0,c=0;c<4;c++)d[c]=0;if(n.block_type==ep.SHORT_TYPE){s=1;var f=e.nr_of_sfb_block[o][s];for(u=0,a=0;a<4;a++)for(r=f[a]/3,c=0;c<r;c++,u++)for(i=0;i<3;i++)m[3*u+i]>d[a]&&(d[a]=m[3*u+i])}else{s=0;f=e.nr_of_sfb_block[o][s];for(u=0,a=0;a<4;a++)for(r=f[a],c=0;c<r;c++,u++)m[u]>d[a]&&(d[a]=m[u])}for(l=!1,a=0;a<4;a++)d[a]>h[o][a]&&(l=!0);if(!l){var p,_,v,b;for(n.sfb_partition_table=e.nr_of_sfb_block[o][s],a=0;a<4;a++)n.slen[a]=g[d[a]];switch(p=n.slen[0],_=n.slen[1],v=n.slen[2],b=n.slen[3],o){case 0:n.scalefac_compress=(5*p+_<<4)+(v<<2)+b;break;case 1:n.scalefac_compress=400+(5*p+_<<2)+v;break;case 2:n.scalefac_compress=500+3*p+_;break;default:sh.err.printf("intensity stereo not implemented yet\n")}}if(!l)for(ih(null!=n.sfb_partition_table),n.part2_length=0,a=0;a<4;a++)n.part2_length+=n.slen[a]*n.sfb_partition_table[a];return l};var g=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){for(var o,s=0;e.scalefac_band.l[++s]<t;);for(o=n[s][0];e.scalefac_band.l[o+1]>t;)o--;for(o<0&&(o=n[s][0]),e.bv_scf[t-2]=o,o=n[s][1];e.scalefac_band.l[o+e.bv_scf[t-2]+2]>t;)o--;o<0&&(o=n[s][1]),e.bv_scf[t-1]=o}}}var ch=Ff.System,uh=Ff.Arrays,dh=Ff.new_byte,mh=Ff.new_float_n,fh=Ff.new_int,ph=Ff.assert;function hh(){var e=this,t=null,n=null,o=null,s=null;this.setModules=function(e,a,r,i){t=e,n=a,o=r,s=i};var a=null,r=0,i=0,l=0;function c(e){ch.arraycopy(e.header[e.w_ptr].buf,0,a,i,e.sideinfo_len),i+=e.sideinfo_len,r+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&Fp.MAX_HEADER_BUF-1}function u(e,t,n){for(;n>0;){var o;0==l&&(l=8,i++,ph(e.header[e.w_ptr].write_timing>=r),e.header[e.w_ptr].write_timing==r&&c(e),a[i]=0),n-=o=Math.min(n,l),l-=o,a[i]|=t>>n<<l,r+=o}}function d(e,t,n){for(;n>0;){var o;0==l&&(l=8,i++,a[i]=0),n-=o=Math.min(n,l),l-=o,a[i]|=t>>n<<l,r+=o}}function m(e,t){var n,s=e.internal_flags;if(t>=8&&(u(s,76,8),t-=8),t>=8&&(u(s,65,8),t-=8),t>=8&&(u(s,77,8),t-=8),t>=8&&(u(s,69,8),t-=8),t>=32){var a=o.getLameShortVersion();if(t>=32)for(n=0;n<a.length&&t>=8;++n)t-=8,u(s,a.charAt(n),8)}for(;t>=1;t-=1)u(s,s.ancillary_flag,1),s.ancillary_flag^=e.disable_reservoir?0:1}function f(e,t,n){for(var o=e.header[e.h_ptr].ptr;n>0;){var s=Math.min(n,8-(7&o));n-=s,e.header[e.h_ptr].buf[o>>3]|=t>>n<<8-(7&o)-s,o+=s}e.header[e.h_ptr].ptr=o}function p(e,t){e<<=8;for(var n=0;n<8;n++)0!=(65536&((t<<=1)^(e<<=1)))&&(t^=32773);return t}function h(e,t){var n,o=Zp.ht[t.count1table_select+32],s=0,a=t.big_values,r=t.big_values;for(ph(t.count1table_select<2),n=(t.count1-t.big_values)/4;n>0;--n){var i=0,l=0;0!=t.l3_enc[a+0]&&(l+=8,t.xr[r+0]<0&&i++),0!=t.l3_enc[a+1]&&(l+=4,i*=2,t.xr[r+1]<0&&i++),0!=t.l3_enc[a+2]&&(l+=2,i*=2,t.xr[r+2]<0&&i++),0!=t.l3_enc[a+3]&&(l++,i*=2,t.xr[r+3]<0&&i++),a+=4,r+=4,u(e,i+o.table[l],o.hlen[l]),s+=o.hlen[l]}return s}function g(e,t,n,o,s){var a=Zp.ht[t],r=0;if(0==t)return r;for(var i=n;i<o;i+=2){var l=0,c=0,d=a.xlen,m=a.xlen,f=0,p=s.l3_enc[i],h=s.l3_enc[i+1];if(0!=p&&(s.xr[i]<0&&f++,l--),t>15){if(p>14){var g=p-15;ph(g<=a.linmax),f|=g<<1,c=d,p=15}if(h>14){var _=h-15;ph(_<=a.linmax),f<<=d,f|=_,c+=d,h=15}m=16}0!=h&&(f<<=1,s.xr[i+1]<0&&f++,l--),p=p*m+h,c-=l,l+=a.hlen[p],u(e,a.table[p],l),u(e,f,c),r+=l+c}return r}function _(e,t){var n=3*e.scalefac_band.s[3];n>t.big_values&&(n=t.big_values);var o=g(e,t.table_select[0],0,n,t);return o+=g(e,t.table_select[1],n,t.big_values,t)}function v(e,t){var n,o,s,a;n=t.big_values;var r=t.region0_count+1;return ph(r<e.scalefac_band.l.length),s=e.scalefac_band.l[r],r+=t.region1_count+1,ph(r<e.scalefac_band.l.length),s>n&&(s=n),(a=e.scalefac_band.l[r])>n&&(a=n),o=g(e,t.table_select[0],0,s,t),o+=g(e,t.table_select[1],s,a,t),o+=g(e,t.table_select[2],a,n,t)}function b(){this.total=0}function x(t,n){var o,s,a,l,c,u=t.internal_flags;return c=u.w_ptr,-1==(l=u.h_ptr-1)&&(l=Fp.MAX_HEADER_BUF-1),o=u.header[l].write_timing-r,n.total=o,o>=0&&(s=1+l-c,l<c&&(s=1+l-c+Fp.MAX_HEADER_BUF),o-=8*s*u.sideinfo_len),o+=a=e.getframebits(t),n.total+=a,n.total%8!=0?n.total=1+n.total/8:n.total=n.total/8,n.total+=i+1,o<0&&ch.err.println("strange error flushing buffer ... \n"),o}this.getframebits=function(e){var t,n=e.internal_flags;return t=0!=n.bitrate_index?Zp.bitrate_table[e.version][n.bitrate_index]:e.brate,8*(0|72e3*(e.version+1)*t/e.out_samplerate+n.padding)},this.CRC_writeheader=function(e,t){var n=65535;n=p(255&t[2],n),n=p(255&t[3],n);for(var o=6;o<e.sideinfo_len;o++)n=p(255&t[o],n);t[4]=byte(n>>8),t[5]=byte(255&n)},this.flush_bitstream=function(e){var n,o,s=e.internal_flags,a=s.h_ptr-1;if(-1==a&&(a=Fp.MAX_HEADER_BUF-1),n=s.l3_side,!((o=x(e,new b))<0)){if(m(e,o),ph(s.header[a].write_timing+this.getframebits(e)==r),s.ResvSize=0,n.main_data_begin=0,s.findReplayGain){var i=t.GetTitleGain(s.rgdata);ph(NEQ(i,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),s.RadioGain=0|Math.floor(10*i+.5)}s.findPeakSample&&(s.noclipGainChange=0|Math.ceil(20*Math.log10(s.PeakSample/32767)*10),s.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?s.noclipScale=Math.floor(32767/s.PeakSample*100)/100:s.noclipScale=-1)}},this.add_dummy_byte=function(e,t,n){for(var o,s=e.internal_flags;n-- >0;)for(d(0,t,8),o=0;o<Fp.MAX_HEADER_BUF;++o)s.header[o].write_timing+=8},this.format_bitstream=function(e){var t,n=e.internal_flags;t=n.l3_side;var o=this.getframebits(e);m(e,t.resvDrain_pre),function(e,t){var n,o,s,a=e.internal_flags;if(n=a.l3_side,a.header[a.h_ptr].ptr=0,uh.fill(a.header[a.h_ptr].buf,0,a.sideinfo_len,0),e.out_samplerate<16e3?f(a,4094,12):f(a,4095,12),f(a,e.version,1),f(a,1,2),f(a,e.error_protection?0:1,1),f(a,a.bitrate_index,4),f(a,a.samplerate_index,2),f(a,a.padding,1),f(a,e.extension,1),f(a,e.mode.ordinal(),2),f(a,a.mode_ext,2),f(a,e.copyright,1),f(a,e.original,1),f(a,e.emphasis,2),e.error_protection&&f(a,0,16),1==e.version){for(ph(n.main_data_begin>=0),f(a,n.main_data_begin,9),2==a.channels_out?f(a,n.private_bits,3):f(a,n.private_bits,5),s=0;s<a.channels_out;s++){var r;for(r=0;r<4;r++)f(a,n.scfsi[s][r],1)}for(o=0;o<2;o++)for(s=0;s<a.channels_out;s++)f(a,(i=n.tt[o][s]).part2_3_length+i.part2_length,12),f(a,i.big_values/2,9),f(a,i.global_gain,8),f(a,i.scalefac_compress,4),i.block_type!=ep.NORM_TYPE?(f(a,1,1),f(a,i.block_type,2),f(a,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),f(a,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),f(a,i.table_select[1],5),f(a,i.subblock_gain[0],3),f(a,i.subblock_gain[1],3),f(a,i.subblock_gain[2],3)):(f(a,0,1),14==i.table_select[0]&&(i.table_select[0]=16),f(a,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),f(a,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),f(a,i.table_select[2],5),ph(i.region0_count>=0&&i.region0_count<16),ph(i.region1_count>=0&&i.region1_count<8),f(a,i.region0_count,4),f(a,i.region1_count,3)),f(a,i.preflag,1),f(a,i.scalefac_scale,1),f(a,i.count1table_select,1)}else for(ph(n.main_data_begin>=0),f(a,n.main_data_begin,8),f(a,n.private_bits,a.channels_out),o=0,s=0;s<a.channels_out;s++){var i;f(a,(i=n.tt[o][s]).part2_3_length+i.part2_length,12),f(a,i.big_values/2,9),f(a,i.global_gain,8),f(a,i.scalefac_compress,9),i.block_type!=ep.NORM_TYPE?(f(a,1,1),f(a,i.block_type,2),f(a,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),f(a,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),f(a,i.table_select[1],5),f(a,i.subblock_gain[0],3),f(a,i.subblock_gain[1],3),f(a,i.subblock_gain[2],3)):(f(a,0,1),14==i.table_select[0]&&(i.table_select[0]=16),f(a,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),f(a,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),f(a,i.table_select[2],5),ph(i.region0_count>=0&&i.region0_count<16),ph(i.region1_count>=0&&i.region1_count<8),f(a,i.region0_count,4),f(a,i.region1_count,3)),f(a,i.scalefac_scale,1),f(a,i.count1table_select,1)}e.error_protection&&CRC_writeheader(a,a.header[a.h_ptr].buf);var l=a.h_ptr;ph(a.header[l].ptr==8*a.sideinfo_len),a.h_ptr=l+1&Fp.MAX_HEADER_BUF-1,a.header[a.h_ptr].write_timing=a.header[l].write_timing+t,a.h_ptr==a.w_ptr&&ch.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}(e,o);var s=8*n.sideinfo_len;if(s+=function(e){var t,n,o,s,a=0,r=e.internal_flags,i=r.l3_side;if(1==e.version)for(t=0;t<2;t++)for(n=0;n<r.channels_out;n++){var l=i.tt[t][n],c=lh.slen1_tab[l.scalefac_compress],d=lh.slen2_tab[l.scalefac_compress];for(s=0,o=0;o<l.sfbdivide;o++)-1!=l.scalefac[o]&&(u(r,l.scalefac[o],c),s+=c);for(;o<l.sfbmax;o++)-1!=l.scalefac[o]&&(u(r,l.scalefac[o],d),s+=d);ph(s==l.part2_length),l.block_type==ep.SHORT_TYPE?s+=_(r,l):s+=v(r,l),s+=h(r,l),ph(s==l.part2_3_length+l.part2_length),a+=s}else for(t=0,n=0;n<r.channels_out;n++){l=i.tt[t][n];var m,f,p=0;if(ph(null!=l.sfb_partition_table),s=0,o=0,f=0,l.block_type==ep.SHORT_TYPE){for(;f<4;f++){var g=l.sfb_partition_table[f]/3,b=l.slen[f];for(m=0;m<g;m++,o++)u(r,Math.max(l.scalefac[3*o+0],0),b),u(r,Math.max(l.scalefac[3*o+1],0),b),u(r,Math.max(l.scalefac[3*o+2],0),b),p+=3*b}s+=_(r,l)}else{for(;f<4;f++)for(g=l.sfb_partition_table[f],b=l.slen[f],m=0;m<g;m++,o++)u(r,Math.max(l.scalefac[o],0),b),p+=b;s+=v(r,l)}s+=h(r,l),ph(s==l.part2_3_length),ph(p==l.part2_length),a+=p+s}return a}(e),m(e,t.resvDrain_post),s+=t.resvDrain_post,t.main_data_begin+=(o-s)/8,x(e,new b)!=n.ResvSize&&ch.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=n.ResvSize&&(ch.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,n.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*n.sideinfo_len,s-t.resvDrain_post-8*n.sideinfo_len,s,s%8,o),ch.err.println("This is a fatal error.  It has several possible causes:"),ch.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),ch.err.println(" 9%%  Your system is overclocked"),ch.err.println(" 1%%  bug in LAME encoding library"),n.ResvSize=8*t.main_data_begin),r>1e9){var a;for(a=0;a<Fp.MAX_HEADER_BUF;++a)n.header[a].write_timing-=r;r=0}return 0},this.copy_buffer=function(e,o,r,c,u){var d=i+1;if(d<=0)return 0;if(0!=c&&d>c)return-1;if(ch.arraycopy(a,0,o,r,d),i=-1,l=0,0!=u){var m=fh(1);if(m[0]=e.nMusicCRC,s.updateMusicCRC(m,o,r,d),e.nMusicCRC=m[0],d>0&&(e.VBR_seek_table.nBytesWritten+=d),e.decode_on_the_fly)for(var f,p=mh([2,1152]),h=d,g=-1;0!=g;)if(g=n.hip_decode1_unclipped(e.hip,o,r,h,p[0],p[1]),h=0,-1==g&&(g=0),g>0){if(e.findPeakSample){for(f=0;f<g;f++)p[0][f]>e.PeakSample?e.PeakSample=p[0][f]:-p[0][f]>e.PeakSample&&(e.PeakSample=-p[0][f]);if(e.channels_out>1)for(f=0;f<g;f++)p[1][f]>e.PeakSample?e.PeakSample=p[1][f]:-p[1][f]>e.PeakSample&&(e.PeakSample=-p[1][f])}if(e.findReplayGain&&t.AnalyzeSamples(e.rgdata,p[0],0,p[1],0,g,e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}return d},this.init_bit_stream_w=function(e){a=dh(kh.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,i=-1,l=0,r=0}}hh.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},hh.NEQ=function(e,t){return!hh.EQ(e,t)};var gh=Ff.System,_h=Ff.VbrMode,vh=Ff.ShortBlock,bh=Ff.new_float,xh=Ff.new_int_n,yh=Ff.new_short_n,wh=Ff.assert;function kh(){var e=this;kh.V9=410,kh.V8=420,kh.V7=430,kh.V6=440,kh.V5=450,kh.V4=460,kh.V3=470,kh.V2=480,kh.V1=490,kh.V0=500,kh.R3MIX=1e3,kh.STANDARD=1001,kh.EXTREME=1002,kh.INSANE=1003,kh.STANDARD_FAST=1004,kh.EXTREME_FAST=1005,kh.MEDIUM=1006,kh.MEDIUM_FAST=1007;kh.LAME_MAXMP3BUFFER=147456;var t,n,o,s,a,r,i,l,c=new fp;function u(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=bh(ep.SBMAX_l),this.bo_s_weight=bh(ep.SBMAX_s)}function d(){this.lowerlimit=0}function m(e,t){this.lowpass=t}this.enc=new ep,this.setModules=function(e,u,d,m,f,p,h,g,_){t=e,n=u,o=d,s=m,a=f,r=p,i=g,l=_,this.enc.setModules(n,c,s,r)};var f=4294479419;function p(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function h(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:case 11025:return t.version=0,0;case 24e3:case 12e3:return t.version=0,1;case 16e3:case 8e3:return t.version=0,2;default:return t.version=0,-1}}function g(e,t,n){n<16e3&&(t=2);for(var o=Zp.bitrate_table[t][1],s=2;s<=14;s++)Zp.bitrate_table[t][s]>0&&Math.abs(Zp.bitrate_table[t][s]-e)<Math.abs(o-e)&&(o=Zp.bitrate_table[t][s]);return o}function _(e,t,n){n<16e3&&(t=2);for(var o=0;o<=14;o++)if(Zp.bitrate_table[t][o]>0&&Zp.bitrate_table[t][o]==e)return o;return-1}function v(t,n){var o=[new m(8,2e3),new m(16,3700),new m(24,3900),new m(32,5500),new m(40,7e3),new m(48,7500),new m(56,1e4),new m(64,11e3),new m(80,13500),new m(96,15100),new m(112,15600),new m(128,17e3),new m(160,17500),new m(192,18600),new m(224,19400),new m(256,19700),new m(320,20500)],s=e.nearestBitrateFullIndex(n);t.lowerlimit=o[s].lowpass}function b(e){var t=ep.BLKSIZE+e.framesize-ep.FFTOFFSET;return t=Math.max(t,512+e.framesize-32)}function x(t,n,o,s,a,r){var i=e.enc.lame_encode_mp3_frame(t,n,o,s,a,r);return t.frameNum++,i}function y(){this.n_in=0,this.n_out=0}function w(){this.num_used=0}function k(e,t){return 0!=t?k(t,e%t):e}function S(e,t,n){var o=Math.PI*t;(e/=n)<0&&(e=0),e>1&&(e=1);var s=e-.5,a=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(s)<1e-9?o/Math.PI:a*Math.sin(n*o*s)/(Math.PI*n*s)}function M(e,t,n,o,s,a,r,i,l){var c,u,d=e.internal_flags,m=0,f=e.out_samplerate/k(e.out_samplerate,e.in_samplerate);f>Fp.BPC&&(f=Fp.BPC);var p=Math.abs(d.resample_ratio-Math.floor(.5+d.resample_ratio))<1e-4?1:0,h=1/d.resample_ratio;h>1&&(h=1);var g=31;g%2==0&&--g;var _=(g+=p)+1;if(0==d.fill_buffer_resample_init){for(d.inbuf_old[0]=bh(_),d.inbuf_old[1]=bh(_),c=0;c<=2*f;++c)d.blackfilt[c]=bh(_);for(d.itime[0]=0,d.itime[1]=0,m=0;m<=2*f;m++){var v=0,b=(m-f)/(2*f);for(c=0;c<=g;c++)v+=d.blackfilt[m][c]=S(c-b,h,g);for(c=0;c<=g;c++)d.blackfilt[m][c]/=v}d.fill_buffer_resample_init=1}var x=d.inbuf_old[l];for(u=0;u<o;u++){var y,w;if(y=u*d.resample_ratio,g+(m=0|Math.floor(y-d.itime[l]))-g/2>=r)break;b=y-d.itime[l]-(m+g%2*.5);w=0|Math.floor(2*b*f+f+.5);var M=0;for(c=0;c<=g;++c){var A=0|c+m-g/2;M+=(A<0?x[_+A]:s[a+A])*d.blackfilt[w][c]}t[n+u]=M}if(i.num_used=Math.min(r,g+m-g/2),d.itime[l]+=i.num_used-u*d.resample_ratio,i.num_used>=_)for(c=0;c<_;c++)x[c]=s[a+i.num_used+c-_];else{var R=_-i.num_used;for(c=0;c<R;++c)x[c]=x[c+i.num_used];for(m=0;c<_;++c,++m)x[c]=s[a+m];wh(m==i.num_used)}return u}function A(e,t,n,o,s,a){var r=e.internal_flags;if(r.resample_ratio<.9999||r.resample_ratio>1.0001)for(var i=0;i<r.channels_out;i++){var l=new w;a.n_out=M(e,t[i],r.mf_size,e.framesize,n[i],o,s,l,i),a.n_in=l.num_used}else{a.n_out=Math.min(e.framesize,s),a.n_in=a.n_out;for(var c=0;c<a.n_out;++c)t[0][r.mf_size+c]=n[0][o+c],2==r.channels_out&&(t[1][r.mf_size+c]=n[1][o+c])}}this.lame_init=function(){var e=new pp;return function(e){var t;e.class_id=f,t=e.internal_flags=new Fp,e.mode=Xf.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=_h.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=ep.ENCDELAY+ep.POSTDELAY,e.encoder_padding=0,t.mf_size=ep.ENCDELAY-ep.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0}(e),e.lame_allocated_gfp=1,e},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],n=0,o=0,s=0,a=0;a=t[16],s=16,o=t[16],n=16;for(var r=0;r<16;r++)if(Math.max(e,t[r+1])!=e){a=t[r+1],s=r+1,o=t[r],n=r;break}return a-e>e-o?n:s},this.lame_init_params=function(e){var m,b=e.internal_flags;if(b.Class_ID=0,null==b.ATH&&(b.ATH=new Pp),null==b.PSY&&(b.PSY=new u),null==b.rgdata&&(b.rgdata=new Vp),b.channels_in=e.num_channels,1==b.channels_in&&(e.mode=Xf.MONO),b.channels_out=e.mode==Xf.MONO?1:2,b.mode_ext=ep.MPG_MD_MS_LR,e.mode==Xf.MONO&&(e.force_ms=!1),e.VBR==_h.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==_h.vbr_off||e.VBR==_h.vbr_mtrh||e.VBR==_h.vbr_mt||(e.free_format=!1),e.VBR==_h.vbr_off&&0==e.brate&&hh.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==_h.vbr_off&&e.compression_ratio>0&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*b.channels_out/(1e3*e.compression_ratio),b.samplerate_index=h(e.out_samplerate,e),e.free_format||(e.brate=g(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var x=16e3;switch(e.VBR){case _h.vbr_off:v(y=new d,e.brate),x=y.lowerlimit;break;case _h.vbr_abr:var y;v(y=new d,e.VBR_mean_bitrate_kbps),x=y.lowerlimit;break;case _h.vbr_rh:var w=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(e.VBR_q>=0&&e.VBR_q<=9){var k=w[e.VBR_q],S=w[e.VBR_q+1],M=e.VBR_q_frac;x=linear_int(k,S,M)}else x=19500;break;default:w=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(e.VBR_q>=0&&e.VBR_q<=9){k=w[e.VBR_q],S=w[e.VBR_q+1],M=e.VBR_q_frac;x=linear_int(k,S,M)}else x=19500}e.mode==Xf.MONO&&(e.VBR==_h.vbr_off||e.VBR==_h.vbr_abr)&&(x*=1.5),e.lowpassfreq=0|x}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),e.out_samplerate=function(e,t){var n=44100;return t>=48e3?n=48e3:t>=44100?n=44100:t>=32e3?n=32e3:t>=24e3?n=24e3:t>=22050?n=22050:t>=16e3?n=16e3:t>=12e3?n=12e3:t>=11025?n=11025:t>=8e3&&(n=8e3),-1==e?n:(e<=15960&&(n=44100),e<=15250&&(n=32e3),e<=11220&&(n=24e3),e<=9970&&(n=22050),e<=7230&&(n=16e3),e<=5420&&(n=12e3),e<=4510&&(n=11025),e<=3970&&(n=8e3),t<n?t>44100?48e3:t>32e3?44100:t>24e3?32e3:t>22050?24e3:t>16e3?22050:t>12e3?16e3:t>11025?12e3:t>8e3?11025:8e3:n)}(0|e.lowpassfreq,e.in_samplerate)),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==_h.vbr_off&&(e.compression_ratio=16*e.out_samplerate*b.channels_out/(1e3*e.brate)),e.VBR==_h.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*b.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,b.findPeakSample=!1),b.findReplayGain=e.findReplayGain,b.decode_on_the_fly=e.decode_on_the_fly,b.decode_on_the_fly&&(b.findPeakSample=!0),b.findReplayGain&&t.InitGainAnalysis(b.rgdata,e.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(b.decode_on_the_fly&&!e.decode_only&&(null!=b.hip&&l.hip_decode_exit(b.hip),b.hip=l.hip_decode_init()),b.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*b.mode_gr,e.encoder_delay=ep.ENCDELAY,b.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case _h.vbr_mt:case _h.vbr_rh:case _h.vbr_mtrh:e.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][e.VBR_q];break;case _h.vbr_abr:e.compression_ratio=16*e.out_samplerate*b.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*b.channels_out/(1e3*e.brate)}if(e.mode==Xf.NOT_SET&&(e.mode=Xf.JOINT_STEREO),e.highpassfreq>0?(b.highpass1=2*e.highpassfreq,e.highpasswidth>=0?b.highpass2=2*(e.highpassfreq+e.highpasswidth):b.highpass2=2*e.highpassfreq,b.highpass1/=e.out_samplerate,b.highpass2/=e.out_samplerate):(b.highpass1=0,b.highpass2=0),e.lowpassfreq>0?(b.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?(b.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),b.lowpass1<0&&(b.lowpass1=0)):b.lowpass1=2*e.lowpassfreq,b.lowpass1/=e.out_samplerate,b.lowpass2/=e.out_samplerate):(b.lowpass1=0,b.lowpass2=0),function(e){var t=e.internal_flags,n=32,o=-1;if(t.lowpass1>0){for(var s=999,a=0;a<=31;a++)(c=a/31)>=t.lowpass2&&(n=Math.min(n,a)),t.lowpass1<c&&c<t.lowpass2&&(s=Math.min(s,a));t.lowpass1=999==s?(n-.75)/31:(s-.75)/31,t.lowpass2=n/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,gh.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var r=-1;for(a=0;a<=31;a++)(c=a/31)<=t.highpass1&&(o=Math.max(o,a)),t.highpass1<c&&c<t.highpass2&&(r=Math.max(r,a));t.highpass1=o/31,t.highpass2=-1==r?(o+.75)/31:(r+.75)/31}for(a=0;a<32;a++){var i,l,c=a/31;i=t.highpass2>t.highpass1?p((t.highpass2-c)/(t.highpass2-t.highpass1+1e-20)):1,l=t.lowpass2>t.lowpass1?p((c-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[a]=i*l}}(e),b.samplerate_index=h(e.out_samplerate,e),b.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==_h.vbr_off){if(e.free_format)b.bitrate_index=0;else if(e.brate=g(e.brate,e.version,e.out_samplerate),b.bitrate_index=_(e.brate,e.version,e.out_samplerate),b.bitrate_index<=0)return e.internal_flags=null,-1}else b.bitrate_index=1;e.analysis&&(e.bWriteVbrTag=!1),null!=b.pinfo&&(e.bWriteVbrTag=!1),n.init_bit_stream_w(b);for(var A=b.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),R=0;R<ep.SBMAX_l+1;R++)b.scalefac_band.l[R]=s.sfBandIndex[A].l[R];for(R=0;R<ep.PSFB21+1;R++){var E=(b.scalefac_band.l[22]-b.scalefac_band.l[21])/ep.PSFB21,T=b.scalefac_band.l[21]+R*E;b.scalefac_band.psfb21[R]=T}b.scalefac_band.psfb21[ep.PSFB21]=576;for(R=0;R<ep.SBMAX_s+1;R++)b.scalefac_band.s[R]=s.sfBandIndex[A].s[R];for(R=0;R<ep.PSFB12+1;R++){E=(b.scalefac_band.s[13]-b.scalefac_band.s[12])/ep.PSFB12,T=b.scalefac_band.s[12]+R*E;b.scalefac_band.psfb12[R]=T}for(b.scalefac_band.psfb12[ep.PSFB12]=192,1==e.version?b.sideinfo_len=1==b.channels_out?21:36:b.sideinfo_len=1==b.channels_out?13:21,e.error_protection&&(b.sideinfo_len+=2),function(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&i.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=xh([16,5]),t.bitrate_blockType_Hist=xh([16,6]),t.PeakSample=0,e.bWriteVbrTag&&r.InitVbrTag(e)}(e),b.Class_ID=f,m=0;m<19;m++)b.nsPsy.pefirbuf[m]=700*b.mode_gr*b.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),wh(e.VBR_q<=9),wh(e.VBR_q>=0),e.VBR){case _h.vbr_mt:e.VBR=_h.vbr_mtrh;case _h.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),o.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),b.PSY.mask_adjust=e.maskingadjust,b.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?b.sfb21_extra=!1:b.sfb21_extra=e.out_samplerate>44e3,b.iteration_loop=new VBRNewIterationLoop(a);break;case _h.vbr_rh:o.apply_preset(e,500-10*e.VBR_q,0),b.PSY.mask_adjust=e.maskingadjust,b.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?b.sfb21_extra=!1:b.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),b.iteration_loop=new VBROldIterationLoop(a);break;default:var B;b.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),(B=e.VBR)==_h.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),o.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=B,b.PSY.mask_adjust=e.maskingadjust,b.PSY.mask_adjust_short=e.maskingadjust_short,B==_h.vbr_off?b.iteration_loop=new Gp(a):b.iteration_loop=new ABRIterationLoop(a)}if(wh(e.scale>=0),e.VBR!=_h.vbr_off){if(b.VBR_min_bitrate=1,b.VBR_max_bitrate=14,e.out_samplerate<16e3&&(b.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=g(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),b.VBR_min_bitrate=_(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),b.VBR_min_bitrate<0)||0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=g(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),b.VBR_max_bitrate=_(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),b.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=Zp.bitrate_table[e.version][b.VBR_min_bitrate],e.VBR_max_bitrate_kbps=Zp.bitrate_table[e.version][b.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(Zp.bitrate_table[e.version][b.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(Zp.bitrate_table[e.version][b.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}return e.tune&&(b.PSY.mask_adjust+=e.tune_value_a,b.PSY.mask_adjust_short+=e.tune_value_a),function(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0}}(e),wh(e.scale>=0),e.athaa_type<0?b.ATH.useAdjust=3:b.ATH.useAdjust=e.athaa_type,b.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=vh.short_block_allowed),e.short_blocks==vh.short_block_allowed&&(e.mode==Xf.JOINT_STEREO||e.mode==Xf.STEREO)&&(e.short_blocks=vh.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=fp.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=fp.NSATTACKTHRE_S),wh(e.scale>=0),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),b.slot_lag=b.frac_SpF=0,e.VBR==_h.vbr_off&&(b.slot_lag=b.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),s.iteration_init(e),c.psymodel_init(e),wh(e.scale>=0),0},this.lame_encode_flush=function(e,t,o,s){var a,r,l,c,u=e.internal_flags,d=yh([2,1152]),m=0,f=u.mf_samples_to_encode-ep.POSTDELAY,p=b(e);if(u.mf_samples_to_encode<1)return 0;for(a=0,e.in_samplerate!=e.out_samplerate&&(f+=16*e.out_samplerate/e.in_samplerate),(l=e.framesize-f%e.framesize)<576&&(l+=e.framesize),e.encoder_padding=l,c=(f+l)/e.framesize;c>0&&m>=0;){var h=p-u.mf_size,g=e.frameNum;h*=e.in_samplerate,(h/=e.out_samplerate)>1152&&(h=1152),h<1&&(h=1),r=s-a,0==s&&(r=0),o+=m=this.lame_encode_buffer(e,d[0],d[1],h,t,o,r),a+=m,c-=g!=e.frameNum?1:0}if(u.mf_samples_to_encode=0,m<0||(r=s-a,0==s&&(r=0),n.flush_bitstream(e),(m=n.copy_buffer(u,t,o,r,1))<0))return m;if(o+=m,r=s-(a+=m),0==s&&(r=0),e.write_id3tag_automatic){if(i.id3tag_write_v1(e),(m=n.copy_buffer(u,t,o,r,0))<0)return m;a+=m}return a},this.lame_encode_buffer=function(e,o,s,a,r,i,l){var c=e.internal_flags,u=[null,null];if(c.Class_ID!=f)return-3;if(0==a)return 0;(function(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=bh(t),e.in_buffer_1=bh(t),e.in_buffer_nsamples=t)})(c,a),u[0]=c.in_buffer_0,u[1]=c.in_buffer_1;for(var d=0;d<a;d++)u[0][d]=o[d],c.channels_in>1&&(u[1][d]=s[d]);return function(e,o,s,a,r,i,l){var c,u,d,m,p,h=e.internal_flags,g=0,_=[null,null],v=[null,null];if(h.Class_ID!=f)return-3;if(0==a)return 0;if(p=n.copy_buffer(h,r,i,l,0),p<0)return p;if(i+=p,g+=p,v[0]=o,v[1]=s,hh.NEQ(e.scale,0)&&hh.NEQ(e.scale,1))for(u=0;u<a;++u)v[0][u]*=e.scale,2==h.channels_out&&(v[1][u]*=e.scale);if(hh.NEQ(e.scale_left,0)&&hh.NEQ(e.scale_left,1))for(u=0;u<a;++u)v[0][u]*=e.scale_left;if(hh.NEQ(e.scale_right,0)&&hh.NEQ(e.scale_right,1))for(u=0;u<a;++u)v[1][u]*=e.scale_right;if(2==e.num_channels&&1==h.channels_out)for(u=0;u<a;++u)v[0][u]=.5*(v[0][u]+v[1][u]),v[1][u]=0;m=b(e),_[0]=h.mfbuf[0],_[1]=h.mfbuf[1];for(var w=0;a>0;){var k=[null,null],S=0,M=0;k[0]=v[0],k[1]=v[1];var R=new y;if(A(e,_,k,w,a,R),S=R.n_in,M=R.n_out,h.findReplayGain&&!h.decode_on_the_fly&&t.AnalyzeSamples(h.rgdata,_[0],h.mf_size,_[1],h.mf_size,M,h.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(a-=S,w+=S,h.channels_out,h.mf_size+=M,wh(h.mf_size<=Fp.MFSIZE),h.mf_samples_to_encode<1&&(h.mf_samples_to_encode=ep.ENCDELAY+ep.POSTDELAY),h.mf_samples_to_encode+=M,h.mf_size>=m){var E=l-g;if(0==l&&(E=0),(c=x(e,_[0],_[1],r,i,E))<0)return c;for(i+=c,g+=c,h.mf_size-=e.framesize,h.mf_samples_to_encode-=e.framesize,d=0;d<h.channels_out;d++)for(u=0;u<h.mf_size;u++)_[d][u]=_[d][u+e.framesize]}}return g}(e,u[0],u[1],a,r,i,l)}}var Sh=Ff.VbrMode;function Mh(){function e(e,t,n,o,s,a,r,i,l,c,u,d,m,f,p){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=n,this.expY=o,this.st_lrm=s,this.st_s=a,this.masking_adj=r,this.masking_adj_short=i,this.ath_lower=l,this.ath_curve=c,this.ath_sensitivity=u,this.interch=d,this.safejoint=m,this.sfb21mod=f,this.msfix=p}function t(e,t,n,o,s,a,r,i,l,c,u,d,m,f){this.quant_comp=t,this.quant_comp_s=n,this.safejoint=o,this.nsmsfix=s,this.st_lrm=a,this.st_s=r,this.nsbass=i,this.scale=l,this.masking_adj=c,this.ath_lower=u,this.ath_curve=d,this.interch=m,this.sfscale=f}var n;this.setModules=function(e){n=e};var o=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],s=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function a(e,t,n){var a=e.VBR==Sh.vbr_rh?o:s,r=e.VBR_q_frac,i=a[t],l=a[t+1],c=i;i.st_lrm=i.st_lrm+r*(l.st_lrm-i.st_lrm),i.st_s=i.st_s+r*(l.st_s-i.st_s),i.masking_adj=i.masking_adj+r*(l.masking_adj-i.masking_adj),i.masking_adj_short=i.masking_adj_short+r*(l.masking_adj_short-i.masking_adj_short),i.ath_lower=i.ath_lower+r*(l.ath_lower-i.ath_lower),i.ath_curve=i.ath_curve+r*(l.ath_curve-i.ath_curve),i.ath_sensitivity=i.ath_sensitivity+r*(l.ath_sensitivity-i.ath_sensitivity),i.interch=i.interch+r*(l.interch-i.interch),i.msfix=i.msfix+r*(l.msfix-i.msfix),function(e,t){var n=0;t<0&&(n=-1,t=0),t>9&&(n=-1,t=9),e.VBR_q=t,e.VBR_q_frac=0}(e,c.vbr_q),0!=n?e.quant_comp=c.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=c.quant_comp),0!=n?e.quant_comp_short=c.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=c.quant_comp_s),0!=c.expY&&(e.experimentalY=0!=c.expY),0!=n?e.internal_flags.nsPsy.attackthre=c.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=c.st_lrm),0!=n?e.internal_flags.nsPsy.attackthre_s=c.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=c.st_s),0!=n?e.maskingadjust=c.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=c.masking_adj),0!=n?e.maskingadjust_short=c.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=c.masking_adj_short),0!=n?e.ATHlower=-c.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-c.ath_lower/10),0!=n?e.ATHcurve=c.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=c.ath_curve),0!=n?e.athaa_sensitivity=c.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=c.ath_sensitivity),c.interch>0&&(0!=n?e.interChRatio=c.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=c.interch)),c.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|c.safejoint),c.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|c.sfb21mod<<20),0!=n?e.msfix=c.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=c.msfix),0==n&&(e.VBR_q=t,e.VBR_q_frac=r)}var r=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function i(e,t,o){var s=t,a=n.nearestBitrateFullIndex(t);if(e.VBR=Sh.vbr_abr,e.VBR_mean_bitrate_kbps=s,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),r[a].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),r[a].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(r[a].nsbass)>0){var i=int(4*r[a].nsbass);i<0&&(i+=64),e.exp_nspsytune=e.exp_nspsytune|i<<2}return 0!=o?e.quant_comp=r[a].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=r[a].quant_comp),0!=o?e.quant_comp_short=r[a].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=r[a].quant_comp_s),0!=o?e.msfix=r[a].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=r[a].nsmsfix),0!=o?e.internal_flags.nsPsy.attackthre=r[a].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=r[a].st_lrm),0!=o?e.internal_flags.nsPsy.attackthre_s=r[a].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=r[a].st_s),0!=o?e.scale=r[a].scale:Math.abs(e.scale- -1)>0||(e.scale=r[a].scale),0!=o?e.maskingadjust=r[a].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=r[a].masking_adj),r[a].masking_adj>0?0!=o?e.maskingadjust_short=.9*r[a].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*r[a].masking_adj):0!=o?e.maskingadjust_short=1.1*r[a].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*r[a].masking_adj),0!=o?e.ATHlower=-r[a].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-r[a].ath_lower/10),0!=o?e.ATHcurve=r[a].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=r[a].ath_curve),0!=o?e.interChRatio=r[a].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=r[a].interch),t}this.apply_preset=function(e,t,n){switch(t){case kh.R3MIX:t=kh.V3,e.VBR=Sh.vbr_mtrh;break;case kh.MEDIUM:t=kh.V4,e.VBR=Sh.vbr_rh;break;case kh.MEDIUM_FAST:t=kh.V4,e.VBR=Sh.vbr_mtrh;break;case kh.STANDARD:t=kh.V2,e.VBR=Sh.vbr_rh;break;case kh.STANDARD_FAST:t=kh.V2,e.VBR=Sh.vbr_mtrh;break;case kh.EXTREME:t=kh.V0,e.VBR=Sh.vbr_rh;break;case kh.EXTREME_FAST:t=kh.V0,e.VBR=Sh.vbr_mtrh;break;case kh.INSANE:return t=320,e.preset=t,i(e,t,n),e.VBR=Sh.vbr_off,t}switch(e.preset=t,t){case kh.V9:return a(e,9,n),t;case kh.V8:return a(e,8,n),t;case kh.V7:return a(e,7,n),t;case kh.V6:return a(e,6,n),t;case kh.V5:return a(e,5,n),t;case kh.V4:return a(e,4,n),t;case kh.V3:return a(e,3,n),t;case kh.V2:return a(e,2,n),t;case kh.V1:return a(e,1,n),t;case kh.V0:return a(e,0,n),t}return t>=8&&t<=320?i(e,t,n):(e.preset=0,t)}}function Ah(){this.setModules=function(e,t){}}function Rh(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Eh=Ff.new_float,Th=Ff.new_int;function Bh(){this.global_gain=0,this.sfb_count1=0,this.step=Th(39),this.noise=Eh(39),this.noise_log=Eh(39)}var Ih=Ff.System,Ch=Ff.VbrMode,jh=Ff.Util,Oh=Ff.Arrays,Fh=Ff.new_float,Lh=Ff.assert;function Ph(){var e,t;this.rv=null,this.qupvt=null;var n,o,s=new Ah;function a(e){this.ordinal=e}function r(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function i(e){return jh.FAST_LOG10(.368+.632*e*e*e)}function l(e,t,n,o,s){var a;switch(e){default:case 9:t.over_count>0?(a=n.over_SSD<=t.over_SSD,n.over_SSD==t.over_SSD&&(a=n.bits<t.bits)):a=n.max_noise<0&&10*n.max_noise+n.bits<=10*t.max_noise+t.bits;break;case 0:a=n.over_count<t.over_count||n.over_count==t.over_count&&n.over_noise<t.over_noise||n.over_count==t.over_count&&BitStream.EQ(n.over_noise,t.over_noise)&&n.tot_noise<t.tot_noise;break;case 8:n.max_noise=function(e,t){for(var n=1e-37,o=0;o<t.psymax;o++)n+=i(e[o]);return Math.max(1e-20,n)}(s,o);case 1:a=n.max_noise<t.max_noise;break;case 2:a=n.tot_noise<t.tot_noise;break;case 3:a=n.tot_noise<t.tot_noise&&n.max_noise<t.max_noise;break;case 4:a=n.max_noise<=0&&t.max_noise>.2||n.max_noise<=0&&t.max_noise<0&&t.max_noise>n.max_noise-.2&&n.tot_noise<t.tot_noise||n.max_noise<=0&&t.max_noise>0&&t.max_noise>n.max_noise-.2&&n.tot_noise<t.tot_noise+t.over_noise||n.max_noise>0&&t.max_noise>-.05&&t.max_noise>n.max_noise-.1&&n.tot_noise+n.over_noise<t.tot_noise+t.over_noise||n.max_noise>0&&t.max_noise>-.1&&t.max_noise>n.max_noise-.15&&n.tot_noise+n.over_noise+n.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:a=n.over_noise<t.over_noise||BitStream.EQ(n.over_noise,t.over_noise)&&n.tot_noise<t.tot_noise;break;case 6:a=n.over_noise<t.over_noise||BitStream.EQ(n.over_noise,t.over_noise)&&(n.max_noise<t.max_noise||BitStream.EQ(n.max_noise,t.max_noise)&&n.tot_noise<=t.tot_noise);break;case 7:a=n.over_count<t.over_count||n.over_noise<t.over_noise}return 0==t.over_count&&(a=a&&n.bits<t.bits),a}function c(e,t,s,a,i){var l=e.internal_flags;!function(e,t,n,o,s){var a,r=e.internal_flags;a=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var i=0,l=0;l<t.sfbmax;l++)i<n[l]&&(i=n[l]);var c=r.noise_shaping_amp;switch(3==c&&(c=s?2:1),c){case 2:break;case 1:i>1?i=Math.pow(i,.5):i*=.95;break;default:i>1?i=1:i*=.95}var u=0;for(l=0;l<t.sfbmax;l++){var d,m=t.width[l];if(u+=m,!(n[l]<i)){if(0!=(2&r.substep_shaping)&&(r.pseudohalf[l]=0==r.pseudohalf[l]?1:0,0==r.pseudohalf[l]&&2==r.noise_shaping_amp))return;for(t.scalefac[l]++,d=-m;d<0;d++)o[u+d]*=a,o[u+d]>t.xrpow_max&&(t.xrpow_max=o[u+d]);if(2==r.noise_shaping_amp)return}}}(e,t,s,a,i);var c=r(t);return!c&&(!(c=2==l.mode_gr?o.scale_bitcount(t):o.scale_bitcount_lsf(l,t))||(l.noise_shaping>1&&(Oh.fill(l.pseudohalf,0),0==t.scalefac_scale?(function(e,t){for(var o=0,s=0;s<e.sfbmax;s++){var a=e.width[s],r=e.scalefac[s];if(0!=e.preflag&&(r+=n.pretab[s]),o+=a,0!=(1&r)){r++;for(var i=-a;i<0;i++)t[o+i]*=1.2968395546510096,t[o+i]>e.xrpow_max&&(e.xrpow_max=t[o+i])}e.scalefac[s]=r>>1}e.preflag=0,e.scalefac_scale=1}(t,a),c=!1):t.block_type==ep.SHORT_TYPE&&l.subblock_gain>0&&(c=function(e,t,o){var s,a=t.scalefac;for(s=0;s<t.sfb_lmax;s++)if(a[s]>=16)return!0;for(var r=0;r<3;r++){var i=0,l=0;for(s=t.sfb_lmax+r;s<t.sfbdivide;s+=3)i<a[s]&&(i=a[s]);for(;s<t.sfbmax;s+=3)l<a[s]&&(l=a[s]);if(!(i<16&&l<8)){if(t.subblock_gain[r]>=7)return!0;t.subblock_gain[r]++;var c=e.scalefac_band.l[t.sfb_lmax];for(s=t.sfb_lmax+r;s<t.sfbmax;s+=3){var u=t.width[s],d=a[s];if((d-=4>>t.scalefac_scale)>=0)a[s]=d,c+=3*u;else{a[s]=0;var m=210+(d<<t.scalefac_scale+1);p=n.IPOW20(m),c+=u*(r+1);for(var f=-u;f<0;f++)o[c+f]*=p,o[c+f]>t.xrpow_max&&(t.xrpow_max=o[c+f]);c+=u*(3-r-1)}}var p=n.IPOW20(202);for(c+=t.width[s]*(r+1),f=-t.width[s];f<0;f++)o[c+f]*=p,o[c+f]>t.xrpow_max&&(t.xrpow_max=o[c+f])}}return!1}(l,t,a)||r(t))),c||(c=2==l.mode_gr?o.scale_bitcount(t):o.scale_bitcount_lsf(l,t)),!c))}this.setModules=function(a,r,i,l){e=a,t=r,this.rv=r,n=i,this.qupvt=i,o=l,s.setModules(n,o)},this.ms_convert=function(e,t){for(var n=0;n<576;++n){var o=e.tt[t][0].xr[n],s=e.tt[t][1].xr[n];e.tt[t][0].xr[n]=(o+s)*(.5*jh.SQRT2),e.tt[t][1].xr[n]=(o-s)*(.5*jh.SQRT2)}},this.init_xrpow=function(e,t,n){var o=0,s=0|t.max_nonzero_coeff;if(t.xrpow_max=0,Oh.fill(n,s,576,0),o=function(e,t,n,o){o=0;for(var s=0;s<=n;++s){var a=Math.abs(e.xr[s]);o+=a,t[s]=Math.sqrt(a*Math.sqrt(a)),t[s]>e.xrpow_max&&(e.xrpow_max=t[s])}return o}(t,n,s,o),o>1e-20){var a=0;0!=(2&e.substep_shaping)&&(a=1);for(var r=0;r<t.psymax;r++)e.pseudohalf[r]=a;return!0}return Oh.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=ep.SBPSY_l,t.sfb_smin=ep.SBPSY_s,t.psy_lmax=e.sfb21_extra?ep.SBMAX_l:ep.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var o=0;o<ep.SBMAX_l;o++)t.width[o]=e.scalefac_band.l[o+1]-e.scalefac_band.l[o],t.window[o]=3;if(t.block_type==ep.SHORT_TYPE){var s=Fh(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?ep.SBMAX_s:ep.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(ep.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var a=e.scalefac_band.l[t.sfb_lmax];Ih.arraycopy(t.xr,0,s,0,576);for(o=t.sfb_smin;o<ep.SBMAX_s;o++)for(var r=e.scalefac_band.s[o],i=e.scalefac_band.s[o+1],l=0;l<3;l++)for(var c=r;c<i;c++)t.xr[a++]=s[3*c+l];var u=t.sfb_lmax;for(o=t.sfb_smin;o<ep.SBMAX_s;o++)t.width[u]=t.width[u+1]=t.width[u+2]=e.scalefac_band.s[o+1]-e.scalefac_band.s[o],t.window[u]=0,t.window[u+1]=1,t.window[u+2]=2,u+=3}t.count1bits=0,t.sfb_partition_table=n.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,Oh.fill(t.scalefac,0),function(e,t){var o=e.ATH,s=t.xr;if(t.block_type!=ep.SHORT_TYPE)for(var a=!1,r=ep.PSFB21-1;r>=0&&!a;r--){var i=e.scalefac_band.psfb21[r],l=e.scalefac_band.psfb21[r+1],c=n.athAdjust(o.adjust,o.psfb21[r],o.floor);e.nsPsy.longfact[21]>1e-12&&(c*=e.nsPsy.longfact[21]);for(var u=l-1;u>=i;u--){if(!(Math.abs(s[u])<c)){a=!0;break}s[u]=0}}else for(var d=0;d<3;d++)for(a=!1,r=ep.PSFB12-1;r>=0&&!a;r--){l=(i=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*d+(e.scalefac_band.psfb12[r]-e.scalefac_band.psfb12[0]))+(e.scalefac_band.psfb12[r+1]-e.scalefac_band.psfb12[r]);var m=n.athAdjust(o.adjust,o.psfb12[r],o.floor);for(e.nsPsy.shortfact[12]>1e-12&&(m*=e.nsPsy.shortfact[12]),u=l-1;u>=i;u--){if(!(Math.abs(s[u])<m)){a=!0;break}s[u]=0}}}(e,t)},a.BINSEARCH_NONE=new a(0),a.BINSEARCH_UP=new a(1),a.BINSEARCH_DOWN=new a(2),this.trancate_smallspectrums=function(e,t,s,a){var r=Fh(hp.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=ep.SHORT_TYPE)&&0==(128&e.substep_shaping)){n.calc_noise(t,s,r,new Rh,null);for(var i=0;i<576;i++){var l=0;0!=t.l3_enc[i]&&(l=Math.abs(t.xr[i])),a[i]=l}i=0;var c=8;t.block_type==ep.SHORT_TYPE&&(c=6);do{var u,d,m,f,p=t.width[c];if(i+=p,!(r[c]>=1||(Oh.sort(a,i-p,p),BitStream.EQ(a[i-1],0)))){u=(1-r[c])*s[c],d=0,f=0;do{var h;for(m=1;f+m<p&&!BitStream.NEQ(a[f+i-p],a[f+i+m-p]);m++);if(u<(h=a[f+i-p]*a[f+i-p]*m)){0!=f&&(d=a[f+i-p-1]);break}u-=h,f+=m}while(f<p);if(!BitStream.EQ(d,0))do{Math.abs(t.xr[i-p])<=d&&(t.l3_enc[i-p]=0)}while(--p>0)}}while(++c<t.psymax);t.part2_3_length=o.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,s,r,i,u){var d=e.internal_flags,m=new vp,f=Fh(576),p=Fh(hp.SFBMAX),h=new Rh,g=new Bh,_=9999999,v=!1,b=!1,x=0;if(function(e,t,n,s,r){var i,l=e.CurrentStep[s],c=!1,u=e.OldValue[s],d=a.BINSEARCH_NONE;for(t.global_gain=u,n-=t.part2_length;;){var m;if(i=o.count_bits(e,r,t,null),1==l||i==n)break;i>n?(d==a.BINSEARCH_DOWN&&(c=!0),c&&(l/=2),d=a.BINSEARCH_UP,m=l):(d==a.BINSEARCH_UP&&(c=!0),c&&(l/=2),d=a.BINSEARCH_DOWN,m=-l),t.global_gain+=m,t.global_gain<0&&(t.global_gain=0,c=!0),t.global_gain>255&&(t.global_gain=255,c=!0)}for(Lh(t.global_gain>=0),Lh(t.global_gain<256);i>n&&t.global_gain<255;)t.global_gain++,i=o.count_bits(e,r,t,null);e.CurrentStep[s]=u-t.global_gain>=4?4:2,e.OldValue[s]=t.global_gain,t.part2_3_length=i}(d,t,u,i,r),0==d.noise_shaping)return 100;n.calc_noise(t,s,p,h,g),h.bits=t.part2_3_length,m.assign(t);var y=0;for(Ih.arraycopy(r,0,f,0,576);!v;){do{var w,k=new Rh,S=255;if(w=0!=(2&d.substep_shaping)?20:3,d.sfb21_extra&&(p[m.sfbmax]>1||m.block_type==ep.SHORT_TYPE&&(p[m.sfbmax+1]>1||p[m.sfbmax+2]>1))||!c(e,m,p,r,b))break;0!=m.scalefac_scale&&(S=254);var M=u-m.part2_length;if(M<=0)break;for(;(m.part2_3_length=o.count_bits(d,r,m,g))>M&&m.global_gain<=S;)m.global_gain++;if(m.global_gain>S)break;if(0==h.over_count){for(;(m.part2_3_length=o.count_bits(d,r,m,g))>_&&m.global_gain<=S;)m.global_gain++;if(m.global_gain>S)break}if(n.calc_noise(m,s,p,k,g),k.bits=m.part2_3_length,0!=(l(t.block_type!=ep.SHORT_TYPE?e.quant_comp:e.quant_comp_short,h,k,m,p)?1:0))_=t.part2_3_length,h=k,t.assign(m),y=0,Ih.arraycopy(r,0,f,0,576);else if(0==d.full_outer_loop&&(++y>w&&0==h.over_count||3==d.noise_shaping_amp&&b&&y>30||3==d.noise_shaping_amp&&b&&m.global_gain-x>15))break}while(m.global_gain+m.scalefac_scale<255);3==d.noise_shaping_amp?b?v=!0:(m.assign(t),Ih.arraycopy(f,0,r,0,576),y=0,x=m.global_gain,b=!0):v=!0}return Lh(t.global_gain+t.scalefac_scale<=255),e.VBR==Ch.vbr_rh||e.VBR==Ch.vbr_mtrh?Ih.arraycopy(f,0,r,0,576):0!=(1&d.substep_shaping)&&trancate_smallspectrums(d,t,s,r),h.over_count},this.iteration_finish_one=function(e,n,s){var a=e.l3_side,r=a.tt[n][s];o.best_scalefac_store(e,n,s,a),1==e.use_best_huffman&&o.best_huffman_divide(e,r),t.ResvAdjust(e,r)},this.VBR_encode_granule=function(e,t,n,o,s,a,r){var i,l=e.internal_flags,c=new vp,u=Fh(576),d=r,m=r+1,f=(r+a)/2,p=0,h=l.sfb21_extra;Lh(d<=LameInternalFlags.MAX_BITS_PER_CHANNEL),Oh.fill(c.l3_enc,0);do{l.sfb21_extra=!(f>d-42)&&h,outer_loop(e,t,n,o,s,f)<=0?(p=1,m=t.part2_3_length,c.assign(t),Ih.arraycopy(o,0,u,0,576),i=(r=m-32)-a,f=(r+a)/2):(i=r-(a=f+32),f=(r+a)/2,0!=p&&(p=2,t.assign(c),Ih.arraycopy(u,0,o,0,576)))}while(i>12);l.sfb21_extra=h,2==p&&Ih.arraycopy(c.l3_enc,0,t.l3_enc,0,576),Lh(t.part2_3_length<=d)},this.get_framebits=function(n,o){var s=n.internal_flags;s.bitrate_index=s.VBR_min_bitrate;var a=e.getframebits(n);s.bitrate_index=1,a=e.getframebits(n);for(var r=1;r<=s.VBR_max_bitrate;r++){s.bitrate_index=r;var i=new MeanBits(a);o[r]=t.ResvFrameBegin(n,i),a=i.bits}},this.VBR_old_prepare=function(e,o,s,a,r,i,l,c,u){var d,m=e.internal_flags,f=0,p=1,h=0;m.bitrate_index=m.VBR_max_bitrate;var g=t.ResvFrameBegin(e,new MeanBits(0))/m.mode_gr;get_framebits(e,i);for(var _=0;_<m.mode_gr;_++){var v=n.on_pe(e,o,c[_],g,_,0);m.mode_ext==ep.MPG_MD_MS_LR&&(ms_convert(m.l3_side,_),n.reduce_side(c[_],s[_],g,v));for(var b=0;b<m.channels_out;++b){var x=m.l3_side.tt[_][b];x.block_type!=ep.SHORT_TYPE?(f=1.28/(1+Math.exp(3.5-o[_][b]/300))-.05,d=m.PSY.mask_adjust-f):(f=2.56/(1+Math.exp(3.5-o[_][b]/300))-.14,d=m.PSY.mask_adjust_short-f),m.masking_lower=Math.pow(10,.1*d),init_outer_loop(m,x),u[_][b]=n.calc_xmin(e,a[_][b],x,r[_][b]),0!=u[_][b]&&(p=0),l[_][b]=126,h+=c[_][b]}}for(_=0;_<m.mode_gr;_++)for(b=0;b<m.channels_out;b++)h>i[m.VBR_max_bitrate]&&(c[_][b]*=i[m.VBR_max_bitrate],c[_][b]/=h),l[_][b]>c[_][b]&&(l[_][b]=c[_][b]);return p},this.bitpressure_strategy=function(e,t,n,o){for(var s=0;s<e.mode_gr;s++)for(var a=0;a<e.channels_out;a++){for(var r=e.l3_side.tt[s][a],i=t[s][a],l=0,c=0;c<r.psy_lmax;c++)i[l++]*=1+.029*c*c/ep.SBMAX_l/ep.SBMAX_l;if(r.block_type==ep.SHORT_TYPE)for(c=r.sfb_smin;c<ep.SBMAX_s;c++)i[l++]*=1+.029*c*c/ep.SBMAX_s/ep.SBMAX_s,i[l++]*=1+.029*c*c/ep.SBMAX_s/ep.SBMAX_s,i[l++]*=1+.029*c*c/ep.SBMAX_s/ep.SBMAX_s;o[s][a]=0|Math.max(n[s][a],.9*o[s][a])}},this.VBR_new_prepare=function(e,o,s,a,r,i){var l,c=e.internal_flags,u=1,d=0,m=0;if(e.free_format){c.bitrate_index=0;var f=new MeanBits(d);l=t.ResvFrameBegin(e,f),d=f.bits,r[0]=l}else{c.bitrate_index=c.VBR_max_bitrate;f=new MeanBits(d);t.ResvFrameBegin(e,f),d=f.bits,get_framebits(e,r),l=r[c.VBR_max_bitrate]}for(var p=0;p<c.mode_gr;p++){n.on_pe(e,o,i[p],d,p,0),c.mode_ext==ep.MPG_MD_MS_LR&&ms_convert(c.l3_side,p);for(var h=0;h<c.channels_out;++h){var g=c.l3_side.tt[p][h];c.masking_lower=Math.pow(10,.1*c.PSY.mask_adjust),init_outer_loop(c,g),0!=n.calc_xmin(e,s[p][h],g,a[p][h])&&(u=0),m+=i[p][h]}}for(p=0;p<c.mode_gr;p++)for(h=0;h<c.channels_out;h++)m>l&&(i[p][h]*=l,i[p][h]/=m);return u},this.calc_target_bits=function(o,s,a,r,i,l){var c,u,d,m,f=o.internal_flags,p=f.l3_side,h=0;f.bitrate_index=f.VBR_max_bitrate;var g=new MeanBits(h);for(l[0]=t.ResvFrameBegin(o,g),h=g.bits,f.bitrate_index=1,h=e.getframebits(o)-8*f.sideinfo_len,i[0]=h/(f.mode_gr*f.channels_out),h=o.VBR_mean_bitrate_kbps*o.framesize*1e3,0!=(1&f.substep_shaping)&&(h*=1.09),h/=o.out_samplerate,h-=8*f.sideinfo_len,h/=f.mode_gr*f.channels_out,(c=.93+.07*(11-o.compression_ratio)/5.5)<.9&&(c=.9),c>1&&(c=1),u=0;u<f.mode_gr;u++){var _=0;for(d=0;d<f.channels_out;d++){if(r[u][d]=int(c*h),s[u][d]>700){var v=int((s[u][d]-700)/1.4),b=p.tt[u][d];r[u][d]=int(c*h),b.block_type==ep.SHORT_TYPE&&v<h/2&&(v=h/2),v>3*h/2?v=3*h/2:v<0&&(v=0),r[u][d]+=v}r[u][d]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[u][d]=LameInternalFlags.MAX_BITS_PER_CHANNEL),_+=r[u][d]}if(_>LameInternalFlags.MAX_BITS_PER_GRANULE)for(d=0;d<f.channels_out;++d)r[u][d]*=LameInternalFlags.MAX_BITS_PER_GRANULE,r[u][d]/=_}if(f.mode_ext==ep.MPG_MD_MS_LR)for(u=0;u<f.mode_gr;u++)n.reduce_side(r[u],a[u],h*f.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(m=0,u=0;u<f.mode_gr;u++)for(d=0;d<f.channels_out;d++)r[u][d]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[u][d]=LameInternalFlags.MAX_BITS_PER_CHANNEL),m+=r[u][d];if(m>l[0])for(u=0;u<f.mode_gr;u++)for(d=0;d<f.channels_out;d++)r[u][d]*=l[0],r[u][d]/=m}}var Dh=Ff.assert;function Hh(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,n){var o,s=t.internal_flags,a=s.l3_side,r=e.getframebits(t);n.bits=(r-8*s.sideinfo_len)/s.mode_gr;var i=2048*s.mode_gr-8;t.brate>320?o=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(o=11520,t.strict_ISO&&(o=8*int(32e4/(t.out_samplerate/1152)/8+.5))),s.ResvMax=o-r,s.ResvMax>i&&(s.ResvMax=i),(s.ResvMax<0||t.disable_reservoir)&&(s.ResvMax=0);var l=n.bits*s.mode_gr+Math.min(s.ResvSize,s.ResvMax);return l>o&&(l=o),Dh(s.ResvMax%8==0),Dh(s.ResvMax>=0),a.resvDrain_pre=0,null!=s.pinfo&&(s.pinfo.mean_bits=n.bits/2,s.pinfo.resvsize=s.ResvSize),l},this.ResvMaxBits=function(e,t,n,o){var s,a=e.internal_flags,r=a.ResvSize,i=a.ResvMax;0!=o&&(r+=t),0!=(1&a.substep_shaping)&&(i*=.9),n.bits=t,10*r>9*i?(s=r-9*i/10,n.bits+=s,a.substep_shaping|=128):(s=0,a.substep_shaping&=127,!e.disable_reservoir&&0==(1&a.substep_shaping)&&(n.bits-=.1*t));var l=r<6*a.ResvMax/10?r:6*a.ResvMax/10;return(l-=s)<0&&(l=0),l},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var n,o=e.l3_side;e.ResvSize+=t*e.mode_gr;var s=0;o.resvDrain_post=0,o.resvDrain_pre=0,0!=(n=e.ResvSize%8)&&(s+=n),(n=e.ResvSize-s-e.ResvMax)>0&&(s+=n);var a=Math.min(8*o.main_data_begin,s)/8;o.resvDrain_pre+=8*a,s-=8*a,e.ResvSize-=8*a,o.main_data_begin-=a,o.resvDrain_post+=s,e.ResvSize-=s}}function Nh(){this.getLameVersion=function(){return"3.98.4"},this.getLameShortVersion=function(){return"3.98.4"},this.getLameVeryShortVersion=function(){return"LAME3.98r"},this.getPsyVersion=function(){return"0.93"},this.getLameUrl=function(){return"http://www.mp3dev.org/"},this.getLameOsBitness=function(){return"32bits"}}var $h=Ff.System,zh=Ff.VbrMode,Vh=Ff.ShortBlock,qh=Ff.Arrays,Uh=Ff.new_byte,Xh=Ff.assert;function Yh(){var e,t,n;this.setModules=function(o,s,a){e=o,t=s,n=a};var o=Yh.NUMTOCENTRIES,s=Yh.MAXFRAMESIZE,a=o+4+4+4+4+4+9+1+1+8+1+1+3+1+1+2+4+2+2,r="Xing",i="Info",l=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function c(e,t){var n=255&e[t+0];return n<<=8,n|=255&e[t+1],n<<=8,n|=255&e[t+2],n<<=8,n|=255&e[t+3]}function u(e,t,n){e[t+0]=255&n>>24,e[t+1]=255&n>>16,e[t+2]=255&n>>8,e[t+3]=255&n}function d(e,t,n){e[t+0]=255&n>>8,e[t+1]=255&n}function m(e,t,n){return 255&(e<<t|n&~(-1<<t))}function f(t,n){var o=t.internal_flags;n[0]=m(n[0],8,255),n[1]=m(n[1],3,7),n[1]=m(n[1],1,t.out_samplerate<16e3?0:1),n[1]=m(n[1],1,t.version),n[1]=m(n[1],2,1),n[1]=m(n[1],1,t.error_protection?0:1),n[2]=m(n[2],4,o.bitrate_index),n[2]=m(n[2],2,o.samplerate_index),n[2]=m(n[2],1,0),n[2]=m(n[2],1,t.extension),n[3]=m(n[3],2,t.mode.ordinal()),n[3]=m(n[3],2,o.mode_ext),n[3]=m(n[3],1,t.copyright),n[3]=m(n[3],1,t.original),n[3]=m(n[3],2,t.emphasis),n[0]=255;var s,a,r=241&n[1];s=1==t.version?128:t.out_samplerate<16e3?32:64,t.VBR==zh.vbr_off&&(s=t.brate),a=t.free_format?0:255&16*e.BitrateIndex(s,t.version,t.out_samplerate),1==t.version?(n[1]=255&(10|r),r=13&n[2],n[2]=255&(a|r)):(n[1]=255&(2|r),r=13&n[2],n[2]=255&(a|r))}function p(e,t){return t=t>>8^l[255&(t^e)]}this.addVbrFrame=function(e){var t=e.internal_flags,n=Tables.bitrate_table[e.version][t.bitrate_index];Xh(null!=t.VBR_seek_table.bag),function(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var n=1;n<e.size;n+=2)e.bag[n/2]=e.bag[n];e.want*=2,e.pos/=2}}(t.VBR_seek_table,n)},this.getVbrTag=function(e){var t=new VBRTagData,n=0;t.flags=0;var s=e[n+1]>>3&1,a=e[n+2]>>2&3,l=e[n+3]>>6&3,u=e[n+2]>>4&15;if(u=Tables.bitrate_table[s][u],e[n+1]>>4==14?t.samprate=Tables.samplerate_table[2][a]:t.samprate=Tables.samplerate_table[s][a],!function(e,t){return new String(e,t,4(),null).equals(r)||new String(e,t,4(),null).equals(i)}(e,n+=0!=s?3!=l?36:21:3!=l?21:13))return null;n+=4,t.hId=s;var d=t.flags=c(e,n);if(n+=4,0!=(1&d)&&(t.frames=c(e,n),n+=4),0!=(2&d)&&(t.bytes=c(e,n),n+=4),0!=(4&d)){if(null!=t.toc)for(var m=0;m<o;m++)t.toc[m]=e[n+m];n+=o}t.vbrScale=-1,0!=(8&d)&&(t.vbrScale=c(e,n),n+=4),t.headersize=72e3*(s+1)*u/t.samprate;var f=e[(n+=21)+0]<<4;f+=e[n+1]>>4;var p=(15&e[n+1])<<8;return(f<0||f>3e3)&&(f=-1),((p+=255&e[n+2])<0||p>3e3)&&(p=-1),t.encDelay=f,t.encPadding=p,t},this.InitVbrTag=function(e){var n,o=e.internal_flags;n=1==e.version?128:e.out_samplerate<16e3?32:64,e.VBR==zh.vbr_off&&(n=e.brate);var r=72e3*(e.version+1)*n/e.out_samplerate,i=o.sideinfo_len+a;if(o.VBR_seek_table.TotalFrameSize=r,r<i||r>s)e.bWriteVbrTag=!1;else{o.VBR_seek_table.nVbrNumFrames=0,o.VBR_seek_table.nBytesWritten=0,o.VBR_seek_table.sum=0,o.VBR_seek_table.seen=0,o.VBR_seek_table.want=1,o.VBR_seek_table.pos=0,null==o.VBR_seek_table.bag&&(o.VBR_seek_table.bag=new int[400],o.VBR_seek_table.size=400);var l=Uh(s);f(e,l);for(var c=o.VBR_seek_table.TotalFrameSize,u=0;u<c;++u)t.add_dummy_byte(e,255&l[u],1)}},this.updateMusicCRC=function(e,t,n,o){for(var s=0;s<o;++s)e[0]=p(t[n+s],e[0])},this.getLameTagFrame=function(e,s){var a=e.internal_flags;if(!e.bWriteVbrTag||a.Class_ID!=Lame.LAME_ID||a.VBR_seek_table.pos<=0)return 0;if(s.length<a.VBR_seek_table.TotalFrameSize)return a.VBR_seek_table.TotalFrameSize;qh.fill(s,0,a.VBR_seek_table.TotalFrameSize,0),f(e,s);var l=Uh(o);if(e.free_format)for(var c=1;c<o;++c)l[c]=255&255*c/100;else!function(e,t){if(!(e.pos<=0))for(var n=1;n<o;++n){var s=n/o,a=0|Math.floor(s*e.pos);a>e.pos-1&&(a=e.pos-1);var r=0|256*e.bag[a]/e.sum;r>255&&(r=255),t[n]=255&r}}(a.VBR_seek_table,l);var m=a.sideinfo_len;e.error_protection&&(m-=2),e.VBR==zh.vbr_off?(s[m++]=255&i.charAt(0),s[m++]=255&i.charAt(1),s[m++]=255&i.charAt(2),s[m++]=255&i.charAt(3)):(s[m++]=255&r.charAt(0),s[m++]=255&r.charAt(1),s[m++]=255&r.charAt(2),s[m++]=255&r.charAt(3)),u(s,m,15),u(s,m+=4,a.VBR_seek_table.nVbrNumFrames),m+=4;var h=a.VBR_seek_table.nBytesWritten+a.VBR_seek_table.TotalFrameSize;u(s,m,0|h),m+=4,$h.arraycopy(l,0,s,m,l.length),m+=l.length,e.error_protection&&t.CRC_writeheader(a,s);var g=0;for(c=0;c<m;c++)g=p(s[c],g);return m+=function(e,t,o,s,a){var r,i,l,c,m,f=e.internal_flags,h=0,g=e.encoder_delay,_=e.encoder_padding,v=100-10*e.VBR_q-e.quality,b=n.getLameVeryShortVersion(),x=[1,5,3,2,4,0,3],y=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),w=0,k=0,S=e.internal_flags.noise_shaping,M=0,A=0,R=0,E=0!=(1&e.exp_nspsytune),T=0!=(2&e.exp_nspsytune),B=!1,I=!1,C=e.internal_flags.nogap_total,j=e.internal_flags.nogap_current,O=e.ATHtype;switch(e.VBR){case vbr_abr:m=e.VBR_mean_bitrate_kbps;break;case vbr_off:m=e.brate;break;default:m=e.VBR_min_bitrate_kbps}switch(r=0+(e.VBR.ordinal()<x.length?x[e.VBR.ordinal()]:0),f.findReplayGain&&(f.RadioGain>510&&(f.RadioGain=510),f.RadioGain<-510&&(f.RadioGain=-510),k=8192,k|=3072,f.RadioGain>=0?k|=f.RadioGain:(k|=512,k|=-f.RadioGain)),f.findPeakSample&&(w=Math.abs(0|f.PeakSample/32767*Math.pow(2,23)+.5)),-1!=C&&(j>0&&(I=!0),j<C-1&&(B=!0)),c=O+((E?1:0)<<4)+((T?1:0)<<5)+((B?1:0)<<6)+((I?1:0)<<7),v<0&&(v=0),e.mode){case MONO:M=0;break;case STEREO:M=1;break;case DUAL_CHANNEL:M=2;break;case JOINT_STEREO:M=e.force_ms?4:3;break;case NOT_SET:default:M=7}R=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==Vh.short_block_forced||e.short_blocks==Vh.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==O||e.in_samplerate<=32e3)&&(A=1),i=S+(M<<2)+(A<<5)+(R<<6),l=f.nMusicCRC,u(o,s+h,v),h+=4;for(var F=0;F<9;F++)o[s+h+F]=255&b.charAt(F);o[s+(h+=9)]=255&r,o[s+ ++h]=255&y,u(o,s+ ++h,w),d(o,s+(h+=4),k),d(o,s+(h+=2),0),o[s+(h+=2)]=255&c,o[s+ ++h]=m>=255?255:255&m,o[s+ ++h]=255&g>>4,o[s+h+1]=255&(g<<4)+(_>>8),o[s+h+2]=255&_,o[s+(h+=3)]=255&i,h++,o[s+h++]=0,d(o,s+h,e.preset),u(o,s+(h+=2),t),d(o,s+(h+=4),l),h+=2;for(var L=0;L<h;L++)a=p(o[s+L],a);return d(o,s+h,a),h+2}(e,h,s,m,g),a.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){if(e.internal_flags.VBR_seek_table.pos<=0||(t.seek(t.length()),0==t.length()))return-1;var n=function(e){e.seek(0);var t=Uh(10);return e.readFully(t),new String(t,"ISO-8859-1").startsWith("ID3")?0:((127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9])+t.length}(t);t.seek(n);var o=Uh(s),a=getLameTagFrame(e,o);return a>o.length?-1:(a<1||t.write(o,0,a),0)}}Yh.NUMTOCENTRIES=100,Yh.MAXFRAMESIZE=2880;var Gh=Ff.new_byte,Kh=Ff.assert;function Zh(){this.setModules=function(e,t){}}function Wh(){this.setModules=function(e,t,n){}}function Qh(){}function Jh(){this.setModules=function(e,t){}}function eg(e,t,n){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,n=128);var o=new kh,s=new Zh,a=new Np,r=new hh,i=new Mh,l=new oh,c=new Ph,u=new Yh,d=new Nh,m=new Jh,f=new Hh,p=new lh,h=new Wh,g=new Qh;o.setModules(a,r,i,l,c,u,d,m,g),r.setModules(a,g,d,u),m.setModules(r,d),i.setModules(o),c.setModules(r,f,l,p),l.setModules(p,f,o.enc.psy),f.setModules(r),p.setModules(l),u.setModules(o,r,d),s.setModules(h,g),h.setModules(d,m,i);var _=o.lame_init();_.num_channels=e,_.in_samplerate=t,_.brate=n,_.mode=Xf.STEREO,_.quality=3,_.bWriteVbrTag=!1,_.disable_reservoir=!0,_.write_id3tag_automatic=!1,o.lame_init_params(_);var v=1152,b=0|1.25*v+7200,x=Gh(b);this.encodeBuffer=function(t,n){1==e&&(n=t),Kh(t.length==n.length),t.length>v&&(v=t.length,x=Gh(b=0|1.25*v+7200));var s=o.lame_encode_buffer(_,t,n,t.length,x,0,b);return new Int8Array(x.subarray(0,s))},this.flush=function(){var e=o.lame_encode_flush(_,x,0,b);return new Int8Array(x.subarray(0,e))}}function tg(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}tg("RIFF"),tg("WAVE"),tg("fmt "),tg("data");class ng{constructor(e){this.bitRate=e.bitRate,this.sampleRate=e.sampleRate,this.dataBuffer=[],this.encoder=new eg(1,this.sampleRate,this.bitRate)}encode(e){const t=this._convertBuffer(e);let n=t.length;for(let e=0;n>=0;e+=1152){const o=t.subarray(e,e+1152),s=this.encoder.encodeBuffer(o);this.dataBuffer.push(new Int8Array(s)),n-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}_floatTo16BitPCM(e,t){for(let n=0;n<e.length;n++){const o=Math.max(-1,Math.min(1,e[n]));t[n]=o<0?32768*o:32767*o}}_convertBuffer(e){const t=new Float32Array(e),n=new Int16Array(e.length);return this._floatTo16BitPCM(t,n),n}}class og{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia({video:!1,audio:{channelCount:1,echoCancellation:!1}}).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new ng(this.encoderOptions))}stop(){this.stream.getTracks().forEach((e=>e.stop())),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;e=this.lameEncoder.finish(),e.duration=this.duration,this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach((e=>e.stop())),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let n=0;this.lameEncoder&&this.lameEncoder.encode(t);for(let e=0;e<t.length;++e)n+=t[e]*t[e];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(n/t.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}}var sg=window.chrome,ag=window.navigator,rg=ag.vendor,ig=void 0!==window.opr,lg=ag.userAgent.indexOf("Edg")>-1,cg=ag.userAgent.match("CriOS");function ug(){var e=function(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}const dg={name:"RoomFooter",components:{SvgIcon:Qa,EmojiPickerContainer:Cm,RoomFiles:$m,RoomMessageReply:lf,RoomUsersTag:pf,RoomEmojis:vf,RoomTemplatesText:Mf},directives:{clickOutside:ic},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},multipleFiles:{type:Boolean,default:!0},captureFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new Ku({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some((e=>e.loading))},recordedTime(){return new Date(1e3*this.recorder.duration).toISOString().substr(14,5)},shadowFooter(){return!!(this.filteredEmojis.length||this.filteredUsersTag.length||this.filteredTemplatesText.length||this.files.length||this.messageReply)}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout((()=>this.onChangeInput())))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=ug();let t=!0;this.getTextareaRef().addEventListener("keyup",(n=>{"Enter"===n.key&&!n.shiftKey&&!this.fileDialog&&(e?(this.message=this.message+"\n",setTimeout((()=>this.onChangeInput()))):t&&!this.filteredEmojis.length&&!this.filteredUsersTag.length&&!this.filteredTemplatesText.length&&this.sendMessage()),t=!n.isComposing,setTimeout((()=>{this.updateFooterLists()}),60)})),this.getTextareaRef().addEventListener("click",(()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()})),this.getTextareaRef().addEventListener("blur",(()=>{setTimeout((()=>{this.resetFooterList()}),100),e&&setTimeout((()=>this.keepKeyboardOpen=!1))}))},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){ug()&&e||!this.getTextareaRef()||(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout((()=>{const e=cg||null!=sg&&"Google Inc."===rg&&!1===ig&&!1===lg?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+e,this.cursorRangePosition+e),this.cursorRangePosition=null})))},onChangeInput(){var e,t,n;((null==(e=this.getTextareaRef())?void 0:e.value)||""===(null==(t=this.getTextareaRef())?void 0:t.value))&&(this.message=null==(n=this.getTextareaRef())?void 0:n.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-2*t+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var t;const n=null==(t=e.clipboardData)?void 0:t.items;n&&Array.from(n).forEach((e=>{if(e.type.includes("image")){const t=e.getAsFile();this.onFileChange([t])}}))},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition("/"),o=this.message.substr(n,n).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+o+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t+e.text.length+o.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach((async e=>{const t=URL.createObjectURL(e),n=e.name.lastIndexOf(".");this.files.push({loading:!0,name:e.name.substring(0,n),size:e.size,type:e.type,extension:e.name.substring(n+1),localUrl:t});const o=await fetch(t).then((e=>e.blob()));let s=this.files.find((e=>e.localUrl===t));s&&(s.blob=o,s.loading=!1,delete s.loading)})),setTimeout((()=>this.fileDialog=!1),500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,this.recorder.isRecording)try{this.recorder.stop();const e=this.recorder.records[0];this.files.push({blob:e.blob,name:`audio.${this.format}`,size:e.blob.size,duration:e.duration,type:e.blob.type,audio:!0,localUrl:URL.createObjectURL(e.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout((()=>this.stopRecorder()),100)}else setTimeout((()=>this.recorder.start()),200)},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout((()=>this.stopRecorder()),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var e;let t=this.message.trim();if(!this.files.length&&!t||this.isFileLoading)return;this.selectedUsersTag.forEach((e=>{t=t.replace(`@${e.username}`,`<usertag>${e._id}</usertag>`)}));const n=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==t||(null==(e=this.editedMessage.files)?void 0:e.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:t,files:n,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:t,files:n,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const n=t,o="<usertag>",s="</usertag>";[...t.matchAll(new RegExp(o,"gi"))].map((e=>e.index)).forEach((e=>{const a=n.substring(e+9,n.indexOf(s,e)),r=this.room.users.find((e=>e._id===a));t=t.replace(`${o}${a}${s}`,`@${(null==r?void 0:r.username)||"unknown"}`),this.selectUserTag(r,!0)})),this.message=t,e.files&&(this.files=[...e.files]),setTimeout((()=>this.resizeTextarea()))},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef()||":"===e&&!this.emojisSuggestionEnabled||"@"===e&&(!this.userTagsEnabled||!this.room.users)||"/"===e&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let n=t;for(;n>0&&this.message.charAt(n-1)!==e&&(" "!==this.message.charAt(n-1)||":"!==e);)n--;const o=this.message.charAt(n-2),s=!o.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(n-1)!==e||o&&" "!==o&&!s)this.resetFooterList(e);else{const o=this.message.substring(n,t);":"===e?this.updateEmojis(o):"@"===e?this.updateShowUsersTag(o):"/"===e&&this.updateShowTemplatesText(o)}},updateShowUsersTag(e){this.filteredUsersTag=Ec(this.room.users,"username",e,!0).filter((e=>e._id!==this.currentUserId))},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:n,endPosition:o}=this.getCharPosition("@"),s=this.message.substr(o,o).length?"":" ";this.message=this.message.substr(0,n)+e.username+s+this.message.substr(o,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=n+e.username.length+s.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=Ec(this.templatesText,"tag",e,!0)},getCharPosition(e){let t=this.getTextareaRef().selectionStart;for(;t>0&&this.message.charAt(t-1)!==e;)t--;return{position:t,endPosition:this.getTextareaRef().selectionEnd}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map((e=>e.unicode))},resetFooterList(e=null){":"===e?this.filteredEmojis=[]:"@"===e?this.filteredUsersTag=[]:("/"===e||(this.filteredEmojis=[],this.filteredUsersTag=[]),this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),(this.textareaAutoFocus||!t)&&setTimeout((()=>this.focusTextarea(e)))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new og({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},mg={key:0,class:"vac-icon-textarea-left"},fg=ns("div",{class:"vac-dot-audio-record"},null,-1),pg={class:"vac-dot-audio-record-time"},hg=["placeholder"],gg={class:"vac-icon-textarea"},_g={key:1},vg=["multiple","accept","capture"];var bg=Na(dg,[["render",function(e,t,n,o,s,a){const r=Un("room-emojis"),i=Un("room-users-tag"),l=Un("room-templates-text"),c=Un("room-message-reply"),u=Un("room-files"),d=Un("svg-icon"),m=Un("emoji-picker-container"),f=Gn("click-outside");return $n((Uo(),Ko("div",{id:"room-footer",class:Ne(["vac-room-footer",{"vac-app-box-shadow":a.shadowFooter}])},[os(r,{"filtered-emojis":s.filteredEmojis,"select-item":s.selectEmojiItem,"active-up-or-down":s.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=e=>a.selectEmoji(e)),onActivateItem:t[1]||(t[1]=e=>s.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),os(i,{"filtered-users-tag":s.filteredUsersTag,"select-item":s.selectUsersTagItem,"active-up-or-down":s.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=e=>a.selectUserTag(e)),onActivateItem:t[3]||(t[3]=e=>s.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),os(l,{"filtered-templates-text":s.filteredTemplatesText,"select-item":s.selectTemplatesTextItem,"active-up-or-down":s.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=e=>a.selectTemplateText(e)),onActivateItem:t[5]||(t[5]=e=>s.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),os(c,{room:n.room,"message-reply":s.messageReply,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onResetMessage:a.resetMessage},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),os(u,{files:s.files,onRemoveFile:a.removeFile,onResetMessage:a.resetMessage},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["files","onRemoveFile","onResetMessage"]),ns("div",{class:Ne(["vac-box-footer",{"vac-box-footer-border":!s.files.length}])},[n.showAudio&&!s.files.length?(Uo(),Ko("div",mg,[s.isRecording?(Uo(),Ko(Ho,{key:0},[ns("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...e)=>a.stopRecorder&&a.stopRecorder(...e))},[Jn(e.$slots,"audio-stop-icon",{},(()=>[os(d,{name:"close-outline"})]))]),fg,ns("div",pg,ze(a.recordedTime),1),ns("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=e=>a.toggleRecorder(!1))},[Jn(e.$slots,"audio-check-icon",{},(()=>[os(d,{name:"checkmark"})]))])],64)):(Uo(),Ko("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=e=>a.toggleRecorder(!0))},[Jn(e.$slots,"microphone-icon",{},(()=>[os(d,{name:"microphone",class:"vac-icon-microphone"})]))]))])):is("",!0),ns("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:n.textMessages.TYPE_MESSAGE,class:Ne(["vac-textarea",{"vac-textarea-outline":s.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...e)=>a.onChangeInput&&a.onChangeInput(...e)),onKeydown:[t[10]||(t[10]=Oa(((...e)=>a.escapeTextarea&&a.escapeTextarea(...e)),["esc"])),t[11]||(t[11]=Oa(Ca(((...e)=>a.selectItem&&a.selectItem(...e)),["exact","prevent"]),["enter"])),t[13]||(t[13]=Oa(Ca((()=>{}),["exact","prevent"]),["tab"])),t[14]||(t[14]=Oa(((...e)=>a.selectItem&&a.selectItem(...e)),["tab"])),t[15]||(t[15]=Oa((e=>a.updateActiveUpOrDown(e,-1)),["up"])),t[16]||(t[16]=Oa((e=>a.updateActiveUpOrDown(e,1)),["down"]))],onPaste:t[12]||(t[12]=(...e)=>a.onPasteImage&&a.onPasteImage(...e))},null,42,hg),ns("div",gg,[s.editedMessage._id?(Uo(),Ko("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...e)=>a.resetMessage&&a.resetMessage(...e))},[Jn(e.$slots,"edit-close-icon",{},(()=>[os(d,{name:"close-outline"})]))])):is("",!0),n.showEmojis?$n((Uo(),Ko("div",_g,[Jn(e.$slots,"emoji-picker",ds({emojiOpened:s.emojiOpened},{addEmoji:a.addEmoji}),(()=>[os(m,{"emoji-opened":s.emojiOpened,"position-top":!0,"emoji-data-source":n.emojiDataSource,onAddEmoji:a.addEmoji,onOpenEmoji:t[18]||(t[18]=e=>s.emojiOpened=e)},{"emoji-picker-icon":tn((()=>[Jn(e.$slots,"emoji-picker-icon")])),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])]))])),[[f,()=>s.emojiOpened=!1]]):is("",!0),n.showFiles?(Uo(),Ko("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...e)=>a.launchFilePicker&&a.launchFilePicker(...e))},[Jn(e.$slots,"paperclip-icon",{},(()=>[os(d,{name:"paperclip"})]))])):is("",!0),n.textareaActionEnabled?(Uo(),Ko("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...e)=>a.textareaActionHandler&&a.textareaActionHandler(...e))},[Jn(e.$slots,"custom-action-icon",{},(()=>[os(d,{name:"deleted"})]))])):is("",!0),n.showFiles?(Uo(),Ko("input",{key:4,ref:"file",type:"file",multiple:!!n.multipleFiles||null,accept:n.acceptedFiles,capture:n.captureFiles,style:{display:"none"},onChange:t[21]||(t[21]=e=>a.onFileChange(e.target.files))},null,40,vg)):is("",!0),n.showSendIcon?(Uo(),Ko("div",{key:5,class:Ne(["vac-svg-button",{"vac-send-disabled":a.isMessageEmpty}]),onClick:t[22]||(t[22]=(...e)=>a.sendMessage&&a.sendMessage(...e))},[Jn(e.$slots,"send-icon",{},(()=>[os(d,{name:"send",param:a.isMessageEmpty||a.isFileLoading?"disabled":""},null,8,["param"])]))],2)):is("",!0)])],2)],2)),[[Fa,Object.keys(n.room).length&&n.showFooter]])}]]);const xg={class:"vac-reply-message"},yg={class:"vac-reply-username"},wg={key:0,class:"vac-image-reply-container"},kg={key:1,class:"vac-video-reply-container"},Sg={controls:""},Mg=["src"],Ag={key:3,class:"vac-file-container"},Rg={class:"vac-text-ellipsis"},Eg={key:0,class:"vac-text-ellipsis vac-text-extension"},Tg={class:"vac-reply-content"};var Bg=Na({name:"MessageReply",components:{AudioPlayer:Gm,SvgIcon:Qa,FormatMessage:Jl},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find((t=>t._id===e));return t?t.username:""},firstFile(){var e,t;return null!=(t=null==(e=this.message.replyMessage)?void 0:e.files)&&t.length?this.message.replyMessage.files[0]:{}},isAudio(){return fc(this.firstFile)},isImage(){return uc(this.firstFile)},isVideo(){return dc(this.firstFile)},isOtherFile(){var e;return(null==(e=this.message.replyMessage.files)?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},[["render",function(e,t,n,o,s,a){const r=Un("audio-player"),i=Un("svg-icon"),l=Un("format-message");return Uo(),Ko("div",xg,[ns("div",yg,ze(a.replyUsername),1),a.isImage?(Uo(),Ko("div",wg,[ns("div",{class:"vac-message-image vac-message-image-reply",style:Le({"background-image":`url('${a.firstFile.url}')`})},null,4)])):a.isVideo?(Uo(),Ko("div",kg,[ns("video",Sg,[ns("source",{src:a.firstFile.url},null,8,Mg)])])):a.isAudio?(Uo(),Zo(r,{key:2,src:a.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=t=>e.progressTime=t),onHoverAudioProgress:t[1]||(t[1]=t=>e.hoverAudioProgress=t)},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["src"])):a.isOtherFile?(Uo(),Ko("div",Ag,[ns("div",null,[Jn(e.$slots,"file-icon",{},(()=>[os(i,{name:"file"})]))]),ns("div",Rg,ze(a.firstFile.name),1),a.firstFile.extension?(Uo(),Ko("div",Eg,ze(a.firstFile.extension),1)):is("",!0)])):is("",!0),ns("div",Tg,[os(l,{"message-id":n.message.replyMessage._id,content:n.message.replyMessage.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}]]);const Ig={name:"ProgressBar",props:{progress:{type:Number,default:0}},data:()=>({radius:35,stroke:4,normalizedRadius:27,circumference:54*Math.PI}),computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},Cg={ref:"progress",class:"vac-progress-wrapper"},jg=["height","width"],Og=["stroke-dasharray","stroke-width","r","cx","cy"],Fg={class:"vac-progress-text"},Lg=ns("span",{class:"vac-progress-pourcent"},"%",-1);var Pg=Na(Ig,[["render",function(e,t,n,o,s,a){return Uo(),Zo(la,{name:"vac-fade-spinner",appear:""},{default:tn((()=>[ns("div",Cg,[(Uo(),Ko("svg",{height:2*s.radius,width:2*s.radius},[ns("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":s.circumference+" "+s.circumference,style:Le({strokeDashoffset:a.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":s.stroke,fill:"transparent",r:s.normalizedRadius,cx:s.radius,cy:s.radius},null,12,Og)],8,jg)),ns("div",{class:"vac-progress-content",style:Le({height:2*s.radius-19+"px",width:2*s.radius-19+"px"})},[ns("div",Fg,[rs(ze(n.progress),1),Lg])],4)],512)])),_:1})}]]);const Dg={name:"MessageFile",components:{SvgIcon:Qa,Loader:Ga,ProgressBar:Pg},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data:()=>({imageResponsive:"",imageLoading:!1,imageHover:!1}),computed:{isImageLoading(){return-1!==this.file.url.indexOf("blob:http")||this.imageLoading},isImage(){return uc(this.file)},isVideo(){return dc(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!uc(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",(()=>this.imageLoading=!1))},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},Hg={class:"vac-message-file-container"},Ng={key:0,class:"vac-image-buttons"},$g={controls:""},zg=["src"];const Vg={name:"MessageFiles",components:{SvgIcon:Qa,FormatMessage:Jl,ProgressBar:Pg,MessageFile:Na(Dg,[["render",function(e,t,n,o,s,a){const r=Un("progress-bar"),i=Un("loader"),l=Un("svg-icon");return Uo(),Ko("div",Hg,[a.isImage?(Uo(),Ko("div",{key:0,ref:"imageRef"+n.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=e=>s.imageHover=!0),onMouseleave:t[3]||(t[3]=e=>s.imageHover=!1),onClick:t[4]||(t[4]=e=>a.openFile(e,"preview"))},[n.file.progress>=0?(Uo(),Zo(r,{key:0,progress:n.file.progress,style:Le({top:`${s.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(Uo(),Zo(i,{key:1,show:a.isImageLoading,type:"message-file","message-id":n.message._id,style:Le({top:`${s.imageResponsive.loaderTop}px`})},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["show","message-id","style"])),ns("div",{class:Ne(["vac-message-image",{"vac-blur-loading":a.isImageLoading&&n.message.senderId===n.currentUserId}]),style:Le({"background-image":`url('${a.isImageLoading&&n.file.preview||n.file.url}')`,"max-height":`${s.imageResponsive.maxHeight}px`})},[os(la,{name:"vac-fade-image"},{default:tn((()=>[n.messageSelectionEnabled||!s.imageHover||a.isImageLoading?is("",!0):(Uo(),Ko("div",Ng,[ns("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=e=>a.openFile(e,"preview"))},[Jn(e.$slots,"eye-icon_"+n.message._id,{},(()=>[os(l,{name:"eye"})]))]),ns("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=e=>a.openFile(e,"download"))},[Jn(e.$slots,"document-icon_"+n.message._id,{},(()=>[os(l,{name:"document"})]))])]))])),_:3})],6)],544)):a.isVideo?(Uo(),Ko("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Ca((e=>a.openFile(e,"preview")),["prevent"]))},[n.file.progress>=0?(Uo(),Zo(r,{key:0,progress:n.file.progress},null,8,["progress"])):is("",!0),ns("video",$g,[ns("source",{src:n.file.url},null,8,zg)])])):is("",!0)])}]])},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter((e=>mc(e)))},otherFiles(){return this.message.files.filter((e=>!mc(e)))}},methods:{openFile(e,t,n){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:n}))}}},qg={class:"vac-message-files-container"},Ug=["onClick"],Xg={class:"vac-svg-button"},Yg={class:"vac-text-ellipsis"},Gg={key:0,class:"vac-text-ellipsis vac-text-extension"};var Kg=Na(Vg,[["render",function(e,t,n,o,s,a){const r=Un("message-file"),i=Un("progress-bar"),l=Un("svg-icon"),c=Un("format-message");return Uo(),Ko("div",qg,[(Uo(!0),Ko(Ho,null,Wn(a.imageVideoFiles,((o,s)=>(Uo(),Ko("div",{key:s+"iv"},[os(r,{file:o,"current-user-id":n.currentUserId,message:n.message,index:s,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=t=>e.$emit("open-file",t))},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["file","current-user-id","message","index","message-selection-enabled"])])))),128)),(Uo(!0),Ko(Ho,null,Wn(a.otherFiles,((t,n)=>(Uo(),Ko("div",{key:n+"a",class:"vac-file-wrapper"},[t.progress>=0?(Uo(),Zo(i,{key:0,progress:t.progress,style:{top:"44px"}},null,8,["progress"])):is("",!0),ns("div",{class:Ne(["vac-file-container",{"vac-file-container-progress":t.progress>=0}]),onClick:e=>a.openFile(e,t,"download")},[ns("div",Xg,[Jn(e.$slots,"document-icon",{},(()=>[os(l,{name:"document"})]))]),ns("div",Yg,ze(t.name),1),t.extension?(Uo(),Ko("div",Gg,ze(t.extension),1)):is("",!0)],10,Ug)])))),128)),os(c,{"message-id":n.message._id,content:n.message.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:t[1]||(t[1]=t=>e.$emit("open-user-tag",t))},null,8,["message-id","content","users","text-formatting","link-options"])])}]]);const Zg={name:"MessageActions",components:{SvgIcon:Qa,EmojiPickerContainer:Cm},directives:{clickOutside:ic},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data:()=>({menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}),computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter((e=>!e.onlyMe))}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout((()=>{const e=Tm(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,n=this.$refs.actionIcon.getBoundingClientRect().top;e.getBoundingClientRect().top-n>t+50?this.menuOptionsTop=30:this.menuOptionsTop=-t})))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout((()=>this.optionsClosing=!1),100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},Wg={class:"vac-message-actions-wrapper"},Qg={key:"3"},Jg={class:"vac-menu-list"},e_=["onClick"];var t_=Na(Zg,[["render",function(e,t,n,o,s,a){const r=Un("svg-icon"),i=Un("emoji-picker-container"),l=Gn("click-outside");return Uo(),Ko("div",Wg,[ns("div",{class:"vac-options-container",style:Le({display:n.hoverAudioProgress?"none":"initial",width:a.filteredMessageActions.length&&n.showReactionEmojis?"70px":"45px"})},[os(Aa,{name:"vac-slide-left",tag:"span"},{default:tn((()=>[a.isMessageActions||a.isMessageReactions?(Uo(),Ko("div",{key:"1",class:Ne(["vac-blur-container",{"vac-options-me":n.message.senderId===n.currentUserId}])},null,2)):is("",!0),a.isMessageActions?(Uo(),Ko("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...e)=>a.openOptions&&a.openOptions(...e))},[Jn(e.$slots,"dropdown-icon_"+n.message._id,{},(()=>[os(r,{name:"dropdown",param:"message"})]))],512)):is("",!0),a.isMessageReactions?$n((Uo(),Ko("div",Qg,[Jn(e.$slots,"emoji-picker",ds({emojiOpened:s.emojiOpened},{addEmoji:a.sendMessageReaction}),(()=>[os(i,{class:"vac-message-emojis",style:Le({right:a.isMessageActions?"30px":"5px"}),"emoji-opened":s.emojiOpened,"emoji-reaction":!0,"position-right":n.message.senderId===n.currentUserId,"message-id":n.message._id,"emoji-data-source":n.emojiDataSource,onAddEmoji:a.sendMessageReaction,onOpenEmoji:a.openEmoji},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])]))])),[[l,a.closeEmoji]]):is("",!0)])),_:3})],4),a.filteredMessageActions.length?(Uo(),Zo(la,{key:0,name:n.message.senderId===n.currentUserId?"vac-slide-left":"vac-slide-right"},{default:tn((()=>[s.optionsOpened?$n((Uo(),Ko("div",{key:0,ref:"menuOptions",class:Ne(["vac-menu-options",{"vac-menu-left":n.message.senderId!==n.currentUserId}]),style:Le({top:`${s.menuOptionsTop}px`})},[ns("div",Jg,[(Uo(!0),Ko(Ho,null,Wn(a.filteredMessageActions,(e=>(Uo(),Ko("div",{key:e.name},[ns("div",{class:"vac-menu-item",onClick:t=>a.messageActionHandler(e)},ze(e.title),9,e_)])))),128))])],6)),[[l,a.closeOptions]]):is("",!0)])),_:1},8,["name"])):is("",!0)])}]]);const n_=["onClick"];function o_(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&void 0!==e[t]}const s_={name:"RoomMessage",components:{SvgIcon:Qa,FormatMessage:Jl,AudioPlayer:Gm,MessageReply:Bg,MessageFiles:Kg,MessageActions:t_,MessageReactions:Na({name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},[["render",function(e,t,n,o,s,a){return n.message.deleted?is("",!0):(Uo(),Zo(Aa,{key:0,name:"vac-slide-left",tag:"span"},{default:tn((()=>[(Uo(!0),Ko(Ho,null,Wn(n.message.reactions,((e,t)=>$n((Uo(),Ko("button",{key:t+0,class:Ne(["vac-button-reaction",{"vac-reaction-me":-1!==e.indexOf(n.currentUserId)}]),style:Le({float:n.message.senderId===n.currentUserId?"right":"left"}),onClick:n=>a.sendMessageReaction({unicode:t},e)},[rs(ze(t),1),ns("span",null,ze(e.length),1)],14,n_)),[[Fa,e.length]]))),128))])),_:1}))}]])},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data:()=>({hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}),computed:{showUsername(){return!(!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId)&&this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return null==(e=this.message.files)?void 0:e.some((e=>fc(e)))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some((e=>e.senderId===this.currentUserId&&e.avatar))},hasSenderUserAvatar(){return this.messages.some((e=>e.senderId!==this.currentUserId&&e.avatar))},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find((e=>e._id===this.message._id))}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){e.length&&this.showNewMessagesDivider?this.newMessage=e.reduce(((e,t)=>t.index<e.index?t:e)):this.newMessage={}}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){(function(e){if(t=e,![{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}].every((e=>e.type.find((n=>n===typeof t[e.key]))&&o_(t,e.key))))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]");var t})(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(!this.optionsOpened&&!this.emojiOpened&&(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout((()=>{this.$emit("message-action-handler",{action:e,message:this.message})}),300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&-1!==t.indexOf(this.currentUserId)}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},a_=["id"],r_={key:0,class:"vac-card-info vac-card-date"},i_={key:1,class:"vac-line-new"},l_={key:2,class:"vac-card-info vac-card-system"},c_={key:1,class:"vac-avatar-offset"},u_={key:0,class:"vac-progress-time"},d_={class:"vac-text-timestamp"},m_={key:0,class:"vac-icon-edited"},f_={key:1},p_=[ns("div",{class:"vac-failure-text"},"!",-1)],h_={key:3,class:"vac-avatar-current-offset"};const g_={name:"ChatRoom",components:{Loader:Ga,SvgIcon:Qa,RoomHeader:Zc,RoomFooter:bg,RoomMessage:Na(s_,[["render",function(e,t,n,o,s,a){const r=Un("format-message"),i=Un("message-reply"),l=Un("message-files"),c=Un("audio-player"),u=Un("svg-icon"),d=Un("message-actions"),m=Un("message-reactions");return Uo(),Ko("div",{id:n.message._id,ref:"message",class:"vac-message-wrapper"},[a.showDate?(Uo(),Ko("div",r_,ze(n.message.date),1)):is("",!0),s.newMessage._id===n.message._id?(Uo(),Ko("div",i_,ze(n.textMessages.NEW_MESSAGES),1)):is("",!0),n.message.system?(Uo(),Ko("div",l_,[Jn(e.$slots,"message_"+n.message._id,{},(()=>[os(r,{"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-messages":n.textMessages,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:a.openUserTag},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])]))])):(Uo(),Ko("div",{key:3,class:Ne(["vac-message-box",{"vac-offset-current":n.message.senderId===n.currentUserId}]),onClick:t[8]||(t[8]=(...e)=>a.selectMessage&&a.selectMessage(...e))},[Jn(e.$slots,"message_"+n.message._id,{},(()=>[n.message.senderId!==n.currentUserId?Jn(e.$slots,"message-avatar_"+n.message._id,{key:0},(()=>[n.message.avatar?(Uo(),Ko("div",{key:0,class:"vac-avatar",style:Le({"background-image":`url('${n.message.avatar}')`})},null,4)):is("",!0)])):is("",!0),a.hasSenderUserAvatar&&!n.message.avatar?(Uo(),Ko("div",c_)):is("",!0),ns("div",{class:Ne(["vac-message-container",{"vac-message-container-offset":a.messageOffset}])},[ns("div",{class:Ne(["vac-message-card",{"vac-message-highlight":a.isMessageHover,"vac-message-current":n.message.senderId===n.currentUserId,"vac-message-deleted":n.message.deleted,"vac-item-clickable":n.messageSelectionEnabled,"vac-message-selected":a.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...e)=>a.onHoverMessage&&a.onHoverMessage(...e)),onMouseleave:t[6]||(t[6]=(...e)=>a.onLeaveMessage&&a.onLeaveMessage(...e))},[a.showUsername?(Uo(),Ko("div",{key:0,class:Ne(["vac-text-username",{"vac-username-reply":!n.message.deleted&&n.message.replyMessage}])},[ns("span",null,ze(n.message.username),1)],2)):is("",!0),!n.message.deleted&&n.message.replyMessage?(Uo(),Zo(i,{key:1,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["message","room-users","text-formatting","link-options"])):is("",!0),!n.message.deleted&&n.message.files&&n.message.files.length?!a.isAudio||n.message.files.length>1?(Uo(),Zo(l,{key:3,"current-user-id":n.currentUserId,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:a.openFile,onOpenUserTag:a.openUserTag},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Uo(),Ko(Ho,{key:4},[os(c,{"message-id":n.message._id,src:n.message.files[0].url,"message-selection-enabled":n.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=e=>s.progressTime=e),onHoverAudioProgress:t[1]||(t[1]=e=>s.hoverAudioProgress=e)},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["message-id","src","message-selection-enabled"]),n.message.deleted?is("",!0):(Uo(),Ko("div",u_,ze(s.progressTime),1))],64)):(Uo(),Zo(r,{key:2,"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-formatting":n.textFormatting,"text-messages":n.textMessages,"link-options":n.linkOptions,onOpenUserTag:a.openUserTag},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])),ns("div",d_,[n.message.edited&&!n.message.deleted?(Uo(),Ko("div",m_,[Jn(e.$slots,"pencil-icon_"+n.message._id,{},(()=>[os(u,{name:"pencil"})]))])):is("",!0),ns("span",null,ze(n.message.timestamp),1),a.isCheckmarkVisible?(Uo(),Ko("span",f_,[Jn(e.$slots,"checkmark-icon_"+n.message._id,{},(()=>[os(u,{name:n.message.distributed?"double-checkmark":"checkmark",param:n.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])]))])):is("",!0)]),os(d,{"current-user-id":n.currentUserId,message:n.message,"message-actions":n.messageActions,"show-reaction-emojis":n.showReactionEmojis,"message-hover":s.messageHover,"hover-message-id":s.hoverMessageId,"hover-audio-progress":s.hoverAudioProgress,"emoji-data-source":n.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=e=>s.messageHover=e),onUpdateOptionsOpened:t[3]||(t[3]=e=>s.optionsOpened=e),onUpdateEmojiOpened:t[4]||(t[4]=e=>s.emojiOpened=e),onMessageActionHandler:a.messageActionHandler,onSendMessageReaction:a.sendMessageReaction},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),os(m,{"current-user-id":n.currentUserId,message:n.message,onSendMessageReaction:a.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Jn(e.$slots,"message-failure_"+n.message._id,{},(()=>[n.message.failure&&n.message.senderId===n.currentUserId?(Uo(),Ko("div",{key:0,class:Ne(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":n.message.avatar&&n.message.senderId===n.currentUserId}]),onClick:t[7]||(t[7]=t=>e.$emit("open-failed-message",{message:n.message}))},p_,2)):is("",!0)])),n.message.senderId===n.currentUserId?Jn(e.$slots,"message-avatar_"+n.message._id,{key:2},(()=>[n.message.avatar?(Uo(),Ko("div",{key:0,class:"vac-avatar vac-avatar-current",style:Le({"background-image":`url('${n.message.avatar}')`})},null,4)):is("",!0)])):is("",!0),a.hasCurrentUserAvatar&&!n.message.avatar?(Uo(),Ko("div",h_)):is("",!0)]))],2))],8,a_)}]])},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},multipleFiles:{type:Boolean,default:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data:()=>({editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}),computed:{room(){return this.rooms.find((e=>e.roomId===this.roomId))||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach(((e,t)=>{this.showNewMessagesDivider&&!e.seen&&e.senderId!==this.currentUserId&&this.newMessages.push({_id:e._id,index:t})})),(null==t?void 0:t.length)===(null==e?void 0:e.length)-1&&(this.newMessages=[]),setTimeout((()=>this.loadingMoreMessages=!1))}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout((()=>this.initIntersectionObserver()))},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver((e=>{e[0].isIntersecting&&this.loadMoreMessages()}),t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,n=new ResizeObserver((o=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),n.disconnect())}));for(var o=0;o<e.children.length;o++)n.observe(e.children[o])},touchStart(e){if(!this.singleRoom&&1===e.changedTouches.length){const t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;addEventListener("touchend",(e=>this.touchEnd(e,t,n)),{once:!0})}},touchEnd(e,t,n){if(1===e.changedTouches.length){const o=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY,a=o-t>100,r=Math.abs(s-n)>50;a&&!r&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch((()=>this.messages),(t=>{if(!t||!t.length)return;const n=this.$refs.scrollContainer;!n||(e(),setTimeout((()=>{n.scrollTo({top:n.scrollHeight}),this.updateLoadingMessages(!1)})))}))},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter((t=>t._id!==e))},onMessageAdded({message:e,index:t,ref:n}){if(t!==this.messages.length-1)return;const o=n.offsetHeight+60;setTimeout((()=>{const t=this.$refs.scrollContainer;let n=!1;t&&(n=this.getBottomScroll(t)>o),e.senderId===this.currentUserId?n?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():n?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)}))},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout((()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId)return this.loadingMoreMessages=!1,void(this.showLoader=!1);this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}}),500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":return this.initReplyMessage=t,void setTimeout((()=>{this.initReplyMessage=null}));case"editMessage":return this.initEditMessage=t,void setTimeout((()=>{this.initEditMessage=null}));case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":return this.selectedMessages=[t],void(this.messageSelectionEnabled=!0);default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:n,scrollTop:o}=e;return t-n-o},scrollToBottom(){setTimeout((()=>{const e=this.$refs.scrollContainer;e&&(e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout((()=>e.classList.remove("vac-scroll-smooth"))))}),50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},__={class:"vac-container-center vac-room-empty"},v_={class:"vac-messages-container"},b_={key:0,class:"vac-text-started"},x_={key:1,class:"vac-text-started"},y_={key:0,id:"infinite-loader-messages"},w_={key:2},k_={key:0,class:"vac-badge-counter vac-messages-count"};var S_=Na(g_,[["render",function(e,t,n,o,s,a){const r=Un("room-header"),i=Un("loader"),l=Un("room-message"),c=Un("svg-icon"),u=Un("room-footer");return $n((Uo(),Ko("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=Ca(((...e)=>a.onDropFiles&&a.onDropFiles(...e)),["prevent"])),onDragenter:t[13]||(t[13]=Ca((()=>{}),["prevent"])),onDragover:t[14]||(t[14]=Ca((()=>{}),["prevent"])),onDragleave:t[15]||(t[15]=Ca((()=>{}),["prevent"])),onTouchstart:t[16]||(t[16]=(...e)=>a.touchStart&&a.touchStart(...e))},[a.showNoRoom?Jn(e.$slots,"no-room-selected",{key:0},(()=>[ns("div",__,[ns("div",null,ze(n.textMessages.ROOM_EMPTY),1)])])):(Uo(),Zo(r,{key:1,"current-user-id":n.currentUserId,"text-messages":n.textMessages,"single-room":n.singleRoom,"show-rooms-list":n.showRoomsList,"is-mobile":n.isMobile,"room-info-enabled":n.roomInfoEnabled,"menu-actions":n.menuActions,room:a.room,"message-selection-enabled":s.messageSelectionEnabled,"message-selection-actions":n.messageSelectionActions,"selected-messages-total":s.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=t=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=t=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=t=>e.$emit("menu-action-handler",t)),onMessageSelectionActionHandler:a.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=e=>s.messageSelectionEnabled=!1)},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),ns("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...e)=>a.onContainerScroll&&a.onContainerScroll(...e))},[os(i,{show:s.loadingMessages,type:"messages"},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["show"]),ns("div",v_,[ns("div",{class:Ne({"vac-messages-hidden":s.loadingMessages})},[os(la,{name:"vac-fade-message"},{default:tn((()=>[ns("div",null,[a.showNoMessages?(Uo(),Ko("div",b_,[Jn(e.$slots,"messages-empty",{},(()=>[rs(ze(n.textMessages.MESSAGES_EMPTY),1)]))])):is("",!0),a.showMessagesStarted?(Uo(),Ko("div",x_,ze(n.textMessages.CONVERSATION_STARTED)+" "+ze(n.messages[0].date),1)):is("",!0)])])),_:3}),n.messages.length&&!n.messagesLoaded?(Uo(),Ko("div",y_,[os(i,{show:!0,infinite:!0,type:"infinite-messages"},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1024)])):is("",!0),(Uo(),Zo(Aa,{key:n.roomId,name:"vac-fade-message",tag:"span"},{default:tn((()=>[(Uo(!0),Ko(Ho,null,Wn(n.messages,((o,r)=>(Uo(),Ko("div",{key:o.indexId||o._id},[os(l,{"current-user-id":n.currentUserId,message:o,index:r,messages:n.messages,"edited-message-id":s.editedMessageId,"message-actions":n.messageActions,"room-users":a.room.users,"text-messages":n.textMessages,"new-messages":s.newMessages,"show-reaction-emojis":n.showReactionEmojis,"show-new-messages-divider":n.showNewMessagesDivider,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"username-options":n.usernameOptions,"message-selection-enabled":s.messageSelectionEnabled,"selected-messages":s.selectedMessages,"emoji-data-source":n.emojiDataSource,onMessageAdded:a.onMessageAdded,onMessageActionHandler:a.messageActionHandler,onOpenFile:a.openFile,onOpenUserTag:a.openUserTag,onOpenFailedMessage:t[4]||(t[4]=t=>e.$emit("open-failed-message",t)),onSendMessageReaction:a.sendMessageReaction,onSelectMessage:a.selectMessage,onUnselectMessage:a.unselectMessage},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])])))),128))])),_:3}))],2)])],544),s.loadingMessages?is("",!0):(Uo(),Ko("div",w_,[os(la,{name:"vac-bounce"},{default:tn((()=>[s.scrollIcon?(Uo(),Ko("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...e)=>a.scrollToBottom&&a.scrollToBottom(...e))},[os(la,{name:"vac-bounce"},{default:tn((()=>[s.scrollMessagesCount?(Uo(),Ko("div",k_,ze(s.scrollMessagesCount),1)):is("",!0)])),_:1}),Jn(e.$slots,"scroll-icon",{},(()=>[os(c,{name:"dropdown",param:"scroll"})]))])):is("",!0)])),_:3})])),os(u,{room:a.room,"room-id":n.roomId,"room-message":n.roomMessage,"text-messages":n.textMessages,"show-send-icon":n.showSendIcon,"show-files":n.showFiles,"show-audio":n.showAudio,"show-emojis":n.showEmojis,"show-footer":n.showFooter,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"multiple-files":n.multipleFiles,"textarea-action-enabled":n.textareaActionEnabled,"textarea-auto-focus":n.textareaAutoFocus,"user-tags-enabled":n.userTagsEnabled,"emojis-suggestion-enabled":n.emojisSuggestionEnabled,"templates-text":n.templatesText,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"init-reply-message":s.initReplyMessage,"init-edit-message":s.initEditMessage,"dropped-files":s.droppedFiles,"emoji-data-source":n.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=e=>s.editedMessageId=e),onEditMessage:t[8]||(t[8]=t=>e.$emit("edit-message",t)),onSendMessage:t[9]||(t[9]=t=>e.$emit("send-message",t)),onTypingMessage:t[10]||(t[10]=t=>e.$emit("typing-message",t)),onTextareaActionHandler:t[11]||(t[11]=t=>e.$emit("textarea-action-handler",t))},Qn({_:2},[Wn(e.$slots,((t,n)=>({name:n,fn:tn((t=>[Jn(e.$slots,n,$e(ss(t)))]))})))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","capture-files","multiple-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[Fa,n.isMobile&&!n.showRoomsList||!n.isMobile||n.singleRoom]])}]]);const M_={key:0,class:"vac-media-preview-container"},A_={key:1,class:"vac-media-preview-container"},R_={controls:"",autoplay:""},E_=["src"],T_={class:"vac-svg-button"};var B_=Na({name:"MediaPreview",components:{SvgIcon:Qa},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return uc(this.file)},isVideo(){return dc(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},[["render",function(e,t,n,o,s,a){const r=Un("svg-icon");return Uo(),Ko("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Ca(((...e)=>a.closeModal&&a.closeModal(...e)),["stop"])),onKeydown:t[1]||(t[1]=Oa(((...e)=>a.closeModal&&a.closeModal(...e)),["esc"]))},[os(la,{name:"vac-bounce-preview",appear:""},{default:tn((()=>[a.isImage?(Uo(),Ko("div",M_,[ns("div",{class:"vac-image-preview",style:Le({"background-image":`url('${n.file.url}')`})},null,4)])):a.isVideo?(Uo(),Ko("div",A_,[ns("video",R_,[ns("source",{src:n.file.url},null,8,E_)])])):is("",!0)])),_:1}),ns("div",T_,[Jn(e.$slots,"preview-close-icon",{},(()=>[os(r,{name:"close-outline",param:"preview"})]))])],544)}]]),I_={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const C_={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af",position:"absolute",width:"100%"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af",position:"absolute",width:"100%"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}};const j_={name:"ChatContainer",components:{RoomsList:Fc,Room:S_,MediaPreview:B_},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:(new(window.AudioContext||window.webkitAudioContext)).sampleRate},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},captureFiles:{type:String,default:""},multipleFiles:{type:[Boolean,String],default:!0},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data:()=>({slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}),computed:{t(){return{...I_,...this.textMessagesCasted}},cssVars(){const e=C_[this.theme],t={};return Object.keys(e).map((n=>{t[n]={...e[n],...this.stylesCasted[n]||{}}})),(({general:e,container:t,header:n,footer:o,sidemenu:s,content:a,dropdown:r,message:i,markdown:l,room:c,emoji:u,icons:d})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":n.background,"--chat-header-color-name":n.colorRoomName,"--chat-header-color-info":n.colorRoomInfo,"--chat-header-position":n.position,"--chat-header-width":n.width,"--chat-footer-bg-color":o.background,"--chat-border-style-input":o.borderStyleInput,"--chat-border-color-input-selected":o.borderInputSelected,"--chat-footer-bg-color-reply":o.backgroundReply,"--chat-footer-bg-color-tag-active":o.backgroundTagActive,"--chat-footer-bg-color-tag":o.backgroundTag,"--chat-content-bg-color":a.background,"--chat-sidemenu-bg-color":s.background,"--chat-sidemenu-bg-color-hover":s.backgroundHover,"--chat-sidemenu-bg-color-active":s.backgroundActive,"--chat-sidemenu-color-active":s.colorActive,"--chat-sidemenu-border-color-search":s.borderColorSearch,"--chat-dropdown-bg-color":r.background,"--chat-dropdown-bg-color-hover":r.backgroundHover,"--chat-message-bg-color":i.background,"--chat-message-bg-color-me":i.backgroundMe,"--chat-message-color-started":i.colorStarted,"--chat-message-bg-color-deleted":i.backgroundDeleted,"--chat-message-bg-color-selected":i.backgroundSelected,"--chat-message-color-deleted":i.colorDeleted,"--chat-message-color-username":i.colorUsername,"--chat-message-color-timestamp":i.colorTimestamp,"--chat-message-bg-color-date":i.backgroundDate,"--chat-message-color-date":i.colorDate,"--chat-message-bg-color-system":i.backgroundSystem,"--chat-message-color-system":i.colorSystem,"--chat-message-color":i.color,"--chat-message-bg-color-media":i.backgroundMedia,"--chat-message-bg-color-reply":i.backgroundReply,"--chat-message-color-reply-username":i.colorReplyUsername,"--chat-message-color-reply-content":i.colorReply,"--chat-message-color-tag":i.colorTag,"--chat-message-bg-color-image":i.backgroundImage,"--chat-message-color-new-messages":i.colorNewMessages,"--chat-message-bg-color-scroll-counter":i.backgroundScrollCounter,"--chat-message-color-scroll-counter":i.colorScrollCounter,"--chat-message-bg-color-reaction":i.backgroundReaction,"--chat-message-border-style-reaction":i.borderStyleReaction,"--chat-message-bg-color-reaction-hover":i.backgroundReactionHover,"--chat-message-border-style-reaction-hover":i.borderStyleReactionHover,"--chat-message-color-reaction-counter":i.colorReactionCounter,"--chat-message-bg-color-reaction-me":i.backgroundReactionMe,"--chat-message-border-style-reaction-me":i.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":i.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":i.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":i.colorReactionCounterMe,"--chat-message-bg-color-audio-record":i.backgroundAudioRecord,"--chat-message-bg-color-audio-line":i.backgroundAudioLine,"--chat-message-bg-color-audio-progress":i.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":i.backgroundAudioProgressSelector,"--chat-message-color-file-extension":i.colorFileExtension,"--chat-markdown-bg":l.background,"--chat-markdown-border":l.border,"--chat-markdown-color":l.color,"--chat-markdown-color-multi":l.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":u.background,"--chat-icon-color-search":d.search,"--chat-icon-color-add":d.add,"--chat-icon-color-toggle":d.toggle,"--chat-icon-color-menu":d.menu,"--chat-icon-color-close":d.close,"--chat-icon-color-close-image":d.closeImage,"--chat-icon-color-file":d.file,"--chat-icon-color-paperclip":d.paperclip,"--chat-icon-color-close-outline":d.closeOutline,"--chat-icon-color-close-preview":d.closePreview,"--chat-icon-color-send":d.send,"--chat-icon-color-send-disabled":d.sendDisabled,"--chat-icon-color-emoji":d.emoji,"--chat-icon-color-emoji-reaction":d.emojiReaction,"--chat-icon-color-document":d.document,"--chat-icon-color-pencil":d.pencil,"--chat-icon-color-checkmark":d.checkmark,"--chat-icon-color-checkmark-seen":d.checkmarkSeen,"--chat-icon-color-eye":d.eye,"--chat-icon-color-dropdown-message":d.dropdownMessage,"--chat-icon-bg-dropdown-message":d.dropdownMessageBackground,"--chat-icon-color-dropdown-room":d.dropdownRoom,"--chat-icon-color-dropdown-scroll":d.dropdownScroll,"--chat-icon-color-microphone":d.microphone,"--chat-icon-color-audio-play":d.audioPlay,"--chat-icon-color-audio-pause":d.audioPause,"--chat-icon-color-audio-cancel":d.audioCancel,"--chat-icon-color-audio-confirm":d.audioConfirm}))(t)},orderedRooms(){return this.roomsCasted.slice().sort(((e,t)=>{const n=e.index||0,o=t.index||0;return"asc"===this.roomsOrder?n<o?-1:o<n?1:0:n>o?-1:o>n?1:0}))},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},multipleFilesCasted(){return this.castBoolean(this.multipleFiles)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if((!e[0]||!e.find((e=>e.roomId===this.room.roomId)))&&(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const t=e.find((e=>e.roomId===this.roomId))||{};this.fetchRoom({room:t})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const t=this.roomsCasted.find((t=>t.roomId===e));this.fetchRoom({room:t})}else t&&!e&&(this.room={})}},room(e){!e||0===Object.entries(e).length||(function(e){if(t=e,![{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}].every((e=>{let n=!1;return("array"===e.type[0]&&Array.isArray(t[e.key])||e.type.find((n=>n===typeof t[e.key])))&&(n=!0),n&&o_(t,e.key)})))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]");var t}(e),e.users.forEach((e=>{!function(e){if(t=e,![{key:"_id",type:["string","number"]},{key:"username",type:["string"]}].every((e=>e.type.find((n=>n===typeof t[e.key]))&&o_(t,e.key))))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]");var t}(e)})))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",(e=>{e.isTrusted&&this.updateResponsive()}))},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean:e=>"true"===e||!0===e,castArray:e=>e?Array.isArray(e)?e:JSON.parse(e):[],castObject:e=>e?"object"==typeof e?e:JSON.parse(e):{},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&"preview"===t.action?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},O_={class:"vac-chat-container"};const F_=function(e,t){const n=function(e){return st(e)?{setup:e,name:e.name}:e}(e);class o extends aa{constructor(e){super(n,e,t)}}return o.def=n,o}(Na(j_,[["render",function(e,t,n,o,s,a){const r=Un("rooms-list"),i=Un("room"),l=Un("media-preview");return Uo(),Ko("div",{class:"vac-card-window",style:Le([{height:n.height},a.cssVars])},[ns("div",O_,[a.singleRoomCasted?is("",!0):(Uo(),Zo(r,{key:0,"current-user-id":n.currentUserId,rooms:a.orderedRooms,"loading-rooms":a.loadingRoomsCasted,"rooms-loaded":a.roomsLoadedCasted,room:s.room,"room-actions":a.roomActionsCasted,"custom-search-room-enabled":n.customSearchRoomEnabled,"text-messages":a.t,"show-search":a.showSearchCasted,"show-add-room":a.showAddRoomCasted,"show-rooms-list":s.showRoomsList&&a.roomsListOpenedCasted,"text-formatting":a.textFormattingCasted,"link-options":a.linkOptionsCasted,"is-mobile":s.isMobile,"scroll-distance":n.scrollDistance,onFetchRoom:a.fetchRoom,onFetchMoreRooms:a.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=e=>s.loadingMoreRooms=e),onAddRoom:a.addRoom,onSearchRoom:a.searchRoom,onRoomActionHandler:a.roomActionHandler},Qn({_:2},[Wn(s.slots,(t=>({name:t.slot,fn:tn((n=>[Jn(e.$slots,t.slot,$e(ss(n)))]))})))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),os(i,{"current-user-id":n.currentUserId,rooms:a.roomsCasted,"room-id":s.room.roomId||"","load-first-room":a.loadFirstRoomCasted,messages:a.messagesCasted,"room-message":n.roomMessage,"messages-loaded":a.messagesLoadedCasted,"menu-actions":a.menuActionsCasted,"message-actions":a.messageActionsCasted,"message-selection-actions":a.messageSelectionActionsCasted,"auto-scroll":a.autoScrollCasted,"show-send-icon":a.showSendIconCasted,"show-files":a.showFilesCasted,"show-audio":a.showAudioCasted,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"show-emojis":a.showEmojisCasted,"show-reaction-emojis":a.showReactionEmojisCasted,"show-new-messages-divider":a.showNewMessagesDividerCasted,"show-footer":a.showFooterCasted,"text-messages":a.t,"single-room":a.singleRoomCasted,"show-rooms-list":s.showRoomsList&&a.roomsListOpenedCasted,"text-formatting":a.textFormattingCasted,"link-options":a.linkOptionsCasted,"is-mobile":s.isMobile,"loading-rooms":a.loadingRoomsCasted,"room-info-enabled":a.roomInfoEnabledCasted,"textarea-action-enabled":a.textareaActionEnabledCasted,"textarea-auto-focus":a.textareaAutoFocusCasted,"user-tags-enabled":a.userTagsEnabledCasted,"emojis-suggestion-enabled":a.emojisSuggestionEnabledCasted,"scroll-distance":n.scrollDistance,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"multiple-files":a.multipleFilesCasted,"templates-text":a.templatesTextCasted,"username-options":a.usernameOptionsCasted,"emoji-data-source":n.emojiDataSource,onToggleRoomsList:a.toggleRoomsList,onRoomInfo:a.roomInfo,onFetchMessages:a.fetchMessages,onSendMessage:a.sendMessage,onEditMessage:a.editMessage,onDeleteMessage:a.deleteMessage,onOpenFile:a.openFile,onOpenUserTag:a.openUserTag,onOpenFailedMessage:a.openFailedMessage,onMenuActionHandler:a.menuActionHandler,onMessageActionHandler:a.messageActionHandler,onMessageSelectionActionHandler:a.messageSelectionActionHandler,onSendMessageReaction:a.sendMessageReaction,onTypingMessage:a.typingMessage,onTextareaActionHandler:a.textareaActionHandler},Qn({_:2},[Wn(s.slots,(t=>({name:t.slot,fn:tn((n=>[Jn(e.$slots,t.slot,$e(ss(n)))]))})))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","capture-files","multiple-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),os(la,{name:"vac-fade-preview",appear:""},{default:tn((()=>[s.showMediaPreview?(Uo(),Zo(l,{key:0,file:s.previewFile,onCloseMediaPreview:t[1]||(t[1]=e=>s.showMediaPreview=!1)},Qn({_:2},[Wn(s.slots,(t=>({name:t.slot,fn:tn((n=>[Jn(e.$slots,t.slot,$e(ss(n)))]))})))]),1032,["file"])):is("",!0)])),_:3})],4)}],["styles",['.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.markdown p{margin:0}.markdown ol{display:flex;flex-direction:column;list-style-position:inside}.markdown ul{display:flex;flex-direction:column}.markdown code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.markdown p code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:var(--chat-header-position);display:flex;align-items:center;height:64px;width:var(--chat-header-width);z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-item:not(.vac-room-selected){cursor:pointer}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}\n']]])),L_="vue-advanced-chat";e.VueAdvancedChat=F_,e.register=function(){customElements.get(L_)||customElements.define(L_,F_)},Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
//# sourceMappingURL=/sm/f34d7e0ea06f7e11e64b21e57255a6b5675111966ad56bccbf1b25666d6dd56f.map